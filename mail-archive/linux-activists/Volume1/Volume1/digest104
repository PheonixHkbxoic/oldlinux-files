From:     Digestifier <Linux-Activists-Request@news-digests.mit.edu>
To:       Linux-Activists@news-digests.mit.edu
Reply-To: Linux-Activists@news-digests.mit.edu
Date:     Fri, 13 Mar 92 18:30:25 EST
Subject:  Linux-Activists Digest #104

Linux-Activists Digest #104, Volume #1           Fri, 13 Mar 92 18:30:25 EST

Contents:
  Re: linux 0.95 kernel building (D.Bolla)
  Linux.95 + various other things (Damiano Bolla)
  Make problems (Adam Justin Thornton)
  Re: a minimal shell (Michael O'Dell)
  hd and 0.95 problems continued... (David M. Perry)
  Re: Minimal sh? (Chet Ramey)
  Re: Linux source code reductions necessary or not? (Drew Eckhardt)
  Re: Does compress/uncompress still have bugs? (Johan Myreen)
  overstuffed floppies (Greg Lee)
  Re: Linux File System Document Revision 1.0 (Drew Eckhardt)
  generic mtools, prev. post (Erik Green)

----------------------------------------------------------------------------

From: db1@ukc.ac.uk (D.Bolla)
Subject: Re: linux 0.95 kernel building
Date: 13 Mar 92 09:01:00 GMT
Reply-To: db1@ukc.ac.uk (Damiano Bolla)

In article <3103@inca.comlab.ox.ac.uk> jon@robots.ox.ac.uk (Jon Tombs) writes:
>I have now seen enough posts to know it wasn't my install at fault (I hope).
>It seems the new 0.95 kernel will not compile fork.c or console.c with the
>-O option (compiler died on signal xx), I've seen this beforee on SUNs 
>using gcc so I take its a generic compiler bug? 

Are you shure you used the -fcombine-regs flag ?

>Worse if I build a kernel with gcc1.40, I get the:
>Kernel panic: Trying to free up swapper memory space     

I have .95 compiled with the OLD gcc 1.40 old lib files ( not really old,
just not the new libc ) ( not the 2.0 )

>Before the root file system is mounted. gcc2.0 compiles and runs ok, but
>I'd rather have a working gcc1.4 as g++ is important to many, whilst ram
>size is.  Any pointers were the problems could be?

The combine-regs... I think 

>As an added twist for gcc2.0 debuger try compiling console.c in the kernel
>without the -O option. 

I would like that gcc2 will be included in the release 1.0 of linux.

Damiano

------------------------------

From: db1@ukc.ac.uk (Damiano Bolla)
Subject: Linux.95 + various other things
Date: 13 Mar 92 09:34:57 GMT

First:
I have .95 up and running. Compiled with the old cc 1.40.
My system is: 386+OPTIchipset+VGA+5Mb ram+80Mb linux space 
printer+BWmonitor
It wasn't without problems....
1) Partitions name
   The "logic" suggest that the old hd7 should be hdb3....
   It is not so. Fdisk correctly report a different setup
   My old hd7 is now hdb2 and my old hd6 is now hdb1.
Result: USE fdisk to get your partition's names !!!!

2) Problems with the kernel.
   I had ONCE this problem. A message sayng "harddisk I/O error" block ....
   Anyway, it appear to be generated by the function
   void end_request (.... )
       {
       ......
       if ( !uptodate )
          { 
          error message 
          ......
          }
      .......
      }

   in the file blk.h   
   in the directory kernel/blk_drv
   I had this ONCE and after having tried to mount a WRONG disk ( my old
   devices )
   BTW: I added the suggested recalibrate and I don't have floppy problems
   so far....
Result: Be carefull with what you try to mount... ( may not be but be
carefull anyway )

.95 is MUCH faster than .12 ( thanks to increased file buffer space ) 
and at least allows me to untar something without hanging in kernel flush
inode....
BTW: I still would like to know how to increase the file buffer space :-)

Suggestions:

1) To ALL ftp-archives
   PLEASE let's have a subtree for linux.12 one subtree for linux .95
   one subtree for linux1.0. This is the best way to do things and will
   stop all the story of new, old, subdirectory tree.

2) PLEASE let's use cc 1.40 ( with the new libraries ) for .95. There is no
   point to trust a beta code ( and gcc 2.0 is a beta ). Linux 1.0 will
   have gcc 2.0 if it is proven to be a CORRECT compiler.
   BTW: Using a different tree for different versions will allow you to put
   the actual gcc2.0 under the linux1.0 subtree EVEN if the new linux is
   not out yet.

3) Distribution disk
   There is no point to have login and passwd and agetty in the root disk.
   Much better to include tar and compress and a small shell.
   BTW: If there is no /bin/init the kernel execute a shell in console by
   deafult.

4) I see the problem to do an ioctl to select the various VGA modes
   with the different chipset types. Somebody must know the format and
   address of the registers. Then please, let's start to collect this kind
   of informations NOW !.
   If you have it then PLEASE share your information. The best way is to post
   it in the news since a lot of people then can start playng with the vga
   registers.... ( See a lot of fireworks.... :-) )

Damiano

------------------------------

From: adam@owlnet.rice.edu (Adam Justin Thornton)
Subject: Make problems
Date: 13 Mar 92 18:41:24 GMT

How do I get make up and running?  I've been trying to use pmake from
tsx-11, putting it in /usr/bin and putting its included stuff in /usr/share/mk
where it wants it all.  However, with this installed, the kernel compilation
still dies most heinously; little things like not understanding '386 assembly
and wondering loudly what as86 is.  Can somebody please, please help?  I'd
really like to have a rebuilt kernel that once again likes floppy disks.

Adam
-- 
"This howling in the distance, it's a captivating sound/ Can't tell if it's
ecstasy or pain." | These aren't Rice's opinions, just mine, thank God.
"Cat on a tin roof, dogs in a pile.  Nothing left to do but :-) :-) :-)"
>Radio Free Preterition from Pig Bodine and the Whole Sick Crew | 64,928<

------------------------------

From: mo@gizmo.bellcore.com (Michael O'Dell)
Subject: Re: a minimal shell
Date: 13 Mar 92 19:10:29 GMT
Reply-To: mo@bellcore.com (Michael O'Dell)

you might seriously consider using "rc", the clone of Tom Duff's
Plan 9 shell which has been posted to the source groups.

        -Mike

------------------------------

From: dmp5578@tamsun.tamu.edu (David M. Perry)
Subject: hd and 0.95 problems continued...
Date: 11 Mar 92 22:07:17 GMT

Hello again,

It seems I have yet another problem with 0.95, and my computer
to solve. I can boot up with the boot image, mkfs -c /dev/hda4 
63000 works, but when I try to access it, or to boot off of it
with the modified boot disk (change ofset 509 to 04) it panics
and just hangs.  Also, I have a 6.5M partition that I am using
as the swap drive, if I start to exercise the system ( ie, load
a bunch of shells, typical memory hogging procedure) linux will
flash me errors from the HD, I can't remember exactly what it 
said, but, basically it locked up and I had to reset the computer
to get it back.  Any information on incompatibilities with 
certain hardware, or certain bios settings would be greatly 
appreciated.  

Thanks,
-Dave


------------------------------

From: chet@odin.INS.CWRU.Edu (Chet Ramey)
Subject: Re: Minimal sh?
Date: Fri, 13 Mar 92 20:30:15 GMT

In article <1992Mar12.191123.17289@muddcs.claremont.edu> jwinstea@jarthur.claremont.edu (Jim Winstead Jr.) writes:

>I agree with this completely.  It is a small matter to set up ash as
>/bin/sh, and have /bin/bash available as well.  If ash is stable enough,
>it would be far better as /bin/sh than bash, because of the greatly
>reduced size.  It lacks job control, but I can't see how job control
>is that useful for a non-interactive shell, anyways.

Ash has job control.  Define JOBS in shell.h before building.  BSD-style,
though, not Posix.

It also has a number of bugs, some of which I've reported to CSRG.  Bash
does not have those bugs, but it has different ones ;-).  It's 8-bit
clean, which bash will not be until 1.13 (I wrote the bash code, it's in
the version to be released, and it works).  It's faster than bash,
certainly. 

Chet
-- 
``The use of history as therapy means the corruption of history as history.''
        -- Arthur Schlesinger

Chet Ramey, Case Western Reserve University     Internet: chet@po.CWRU.Edu

------------------------------

From: drew@cs.colorado.edu (Drew Eckhardt)
Subject: Re: Linux source code reductions necessary or not?
Date: Fri, 13 Mar 1992 20:44:01 GMT

In article <1992Mar13.104046.27085@donau.et.tudelft.nl> wolff@neuron.et.tudelft.nl (Rogier Wolff) writes:
>
>I propose to merge these very similar routines, and reduce the code
>size, being careful not to increase complexity too much.
>
>
>                                               Roger

I agree. As you say, this would decrease the overall size of the source 
code, the resulting binary, and mean when one code chunk is fixed , 
it fixes all related routines.

I have done this with the scsi drivers, isolating everything that can be
shared among st.c and sd.c to scsi.c, have a single read / write 
interrupt routine in sd.c, READ / WRITE are in the same place, and 
only change the opcode byte of the SCSI command, and the lowlevel drivers
are responsible for as little possible, simplifying there code.


------------------------------

From: jem@niksula.hut.fi (Johan Myreen)
Subject: Re: Does compress/uncompress still have bugs?
Date: 13 Mar 92 18:58:48 GMT

In article <6170@shodha.enet.dec.com> tucker@yuppie.enet.dec.com (David Tucker / KC4ZGO / tucker@yuppie.ENET.dec.com) writes:
>In article <pn9gdINN2pk@hilbert.math.ksu.edu>, kxb@math.ksu.edu (Karl R. Buck) writes...
>>uncompress a large file (around 1mb) I keep getting "Out of swap
>>space" and "out of memory" errors. I noticed a similar bug was
>Same problem. I have 386sx/16mHz, 4mb w/ 3mb swap.

If you feed uncompress a corrupt file it goes mad, eating up all
memory. This is true for uncompress in general, not only the Linux
version.

Johan Myreen
jem@cs.hut.fi

------------------------------

From: lee@uhunix.uhcc.Hawaii.Edu (Greg Lee)
Subject: overstuffed floppies
Date: Fri, 13 Mar 1992 21:23:07 GMT

As someone mentioned a while back, it would be convenient to
be able to use floppies with non-standard formats, to get more
stuff on them.  I've just done some experimenting, with only
very partial success.  To access 3 1/2" hd floppies formatted
by the msdos program Fdformat v.18 with 82 tracks, 21 sectors
per track, I changed an entry in the table of types in
floppy.c, the later table with block sizes, and the "18" to "21"
in the declaration of the track buffer in floppy.c and head.s.
I put 0x0C for the gap length.

I can make a file system, store and retrieve files ok, but
the drive mutters a lot, files consume over twice the space
they do on the hard disk, and I can't unmount the device
after having used it.

What am I missing?  I haven't done anything about the sector
interleaving of 2 which, according to the Fdformat document
is necessary because "sectors are used as gaps".


--
Greg Lee <lee@uhunix.uhcc.hawaii.edu>

------------------------------

From: drew@cs.colorado.edu (Drew Eckhardt)
Subject: Re: Linux File System Document Revision 1.0
Date: Fri, 13 Mar 1992 21:11:23 GMT

In article <920312534@gandalf.informatik.rwth-aachen.de> u31b3hs@messua.informatik.rwth-aachen.de (Michael Haardt) writes:
>From article <4591@mccuts.uts.mcc.ac.uk>, by zlsiial@uts.mcc.ac.uk (A. V. Le Blanc):

>I really don't know.  I once thought about a major structure change,
>because I never liked /etc and /usr/etc, or things like /usr/lib/tmac.
>There are a few ways how bigger software packets like news or other
>things could be installed, and the usual way is putting the manual pages
>to /usr/man or /usr/local/man, the user commands to /usr/bin or
>/usr/local/bin and the rest, if any, to a special directory, often
>/usr/whoknows.  Putting the user directories in /home is a change I
>really appreciate.
>
>> Before the flames begin to sear, let me say that I think this is
>> a relatively small point, and that the rest of the document provides
>> for a clean, intelligible system which should not be too alien to
>> any experienced Unix user, and yet which should be easily grasped
>> by Unix novices.
>Yes, it is the familar structure.
>

You said it.  It is a familiar structure.  It is the structure which 
most standard distributions are set up to live within - you get 
a program off of the net, make config, then make install,
by default man pages end up in /usr/man, and depending on
the program binaries / libraries in /usr/bin /usr/lib or /usr/local/*.  

As Linux becomes more standard, Joe User is going to go, see something 
on his "real" Unix machines, say "Gee, this is cool," go out on the 
net, get the source, and build under Linux.  If everything, including
the install, works as is out of the box, this is simpler.

Do you work under both Berkeley, SYSV, AIX?  Berkely has /etc/rc,
SYSV has /etc/inittab.  The printer configurations can be different,
command names, syntaxes, config file formats, etc.  It is a real nuisance
to have to remember all of these, plus the different Berkely dirivatives 
(Xinu BSD, Ultrix, SunOS), AT&T dirivatices (SunOS, IRIX), 
etc.  And these directory layouts are basically the same. If they weren't,
things would be even more heinous.  

I'd like linux to be as close to what I know as possible.  If not, that's
a strike against an otherwise excellent operating system.   

>Some people see Linux as a free POSIX/SYS V kernel, and that's all.  I
>think it is similar to MINIX in the way that you are free to experiment
>with new ideas.  So, what would you think of a new structure?  One thing
>I would like to find in it would be a relation between the filesystem
>and the runlevel, another would be a better way to install bigger
>software.

Yes, Linux is neat for playing with new ideas.  The dependance of 
the kernel on the 386 architecture allows a lot of coding shortcuts.
Shared libraries that are not dynamically linked give you reduced
memory usage, but without added overhead in exec()
for linker code.  But these are implementation issues, and have 
nothing to do with how the user sees the system.

>Any ideas?  Would you appreciate a change or are you glad with the
>existing structure?  What do you like in it, what don't you like?
>
>Michael

mount, fsck, umount, init, belong in /etc like all other sysadmin
things, as they are on "normal" Unix machines.  Hard drives should be 
labeled as /dev/hdXY where X is the drive number, 0 based, 
and Y is the partition.  Normally, partition c would be the whole
drive, partition g /usr, partition a root, etc.  As far as the 
interface, we should move to something POSIX, or Berkely, or SYSV,
but something standard.

Other than that, I'm happy with my setup because it looks like Unix,
runs programs like Unix, acts like Unix,  goes easy on resources 
(This is relative, of course), and is easy to hack. 

 




------------------------------

From: longshot@att2.msus.edu (Erik Green)
Subject: generic mtools, prev. post
Date: 13 Mar 92 21:15:12 GMT


In a previous article, jwinstea@jarthur.claremont.edu (Jim Winstead Jr.)
says:

>In article <LONGSHOT.92Mar12214011@att2.mankato.msus.edu> longshot@att2.mankato.msus.edu (Erik Green) writes:
>> If we can get these things and also some sort of simple installation
>>document together, we should be able to get quite a lot of people
>>using Linux :-)

>Some of these issues will be addressed with the release of 0.95a, expected
>in a week or so.  Pfdisk is already available for Linux, and fdisk should
>be corrected to handle the new partition naming scheme, from all the
>indications I've gotten.  More room will be freed up on the root disk
>for programs like pfdisk, tar and compress with the substitution of ash
>for bash.  More on all this later...

[stuff deleted]...
>>I'll be able to start writing some of these in about a month, when I get 

[more stuff deleted].....
>In about a month, the things you're asking for should already be on the
>distributed root disk.  There will always be other things to do, though.


 A thousand pardons.  To tell the truth, I was so happy about finding 
a host that accepted posts that I forgot to think about most of what 
I was saying :^>

 I have, however, gotten mail about one other point - my comment about
needing a small, generic mtools on the root image.  The difficulty seems
to be (and, I assume, the reason no one has posted a mtools binary 
anywhere) is that the device database in devices.c needs to be set up 
specifically for each machine.  My thought was to create a small version
of mread, mwrite and mcopy with a generic database of reduced size.  
To limit the size we could, say, use only drive floppy drive A and limit
ourselves to high-density disks, the type most likely to be found in the
386's that Linux runs on.  That way we'd only need to have entries for
at most four disk types in the database.

Am I completely off-base with this?  Am I forgetting/overlooking 
something?


Thanks for tolerating me, everyone. :-)

-Longshot 

--

Erik "Longshot" Green    LONGSHOT@VAX1.MANKATO.MSUS.EDU
This is a .signature virus scanner.  Stop the .sig virus!
Disclaimer: I'm not me.

------------------------------


** FOR YOUR REFERENCE **

The service address, to which questions about the list itself and requests
to be added to or deleted from it should be directed, is:

    Internet: Linux-Activists-Request@NEWS-DIGESTS.MIT.EDU

You can send mail to the entire list (and alt.os.linux) via:

    Internet: Linux-Activists@NEWS-DIGESTS.MIT.EDU

Linux may be obtained via one of these FTP sites:
    nic.funet.fi				pub/OS/Linux
    tsx-11.mit.edu				pub/linux
    tupac-amaru.informatik.rwth-aachen.de	pub/msdos/replace

The current version of Linux is 0.12, released on Jan 14, 1992

End of Linux-Activists Digest
******************************
