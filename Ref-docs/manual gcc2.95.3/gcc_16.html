<HTML>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- Created on March, 17  2001 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<TITLE>Using and Porting the GNU Compiler Collection (GCC): Machine Desc</TITLE>

<META NAME="description" CONTENT="Using and Porting the GNU Compiler Collection (GCC): Machine Desc">
<META NAME="keywords" CONTENT="Using and Porting the GNU Compiler Collection (GCC): Machine Desc">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

</HEAD>

<BODY LANG="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC169"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_15.html#SEC168" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_15.html#SEC168"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC170" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC170"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_2.html#SEC2" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_2.html#SEC2"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> 16. Machine Descriptions </H1>
<!--docid::SEC169::-->
<P>

A machine description has two parts: a file of instruction patterns
(<TT>`.md'</TT> file) and a C header file of macro definitions.
</P><P>

The <TT>`.md'</TT> file for a target machine contains a pattern for each
instruction that the target machine supports (or at least each instruction
that is worth telling the compiler about).  It may also contain comments.
A semicolon causes the rest of the line to be a comment, unless the semicolon
is inside a quoted string.
</P><P>

See the next chapter for information on the C header file.
</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC170" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC170">16.1 Everything about Instruction Patterns</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">How to write instruction patterns.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC171" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC171">16.2 Example of <CODE>define_insn</CODE></A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">An explained example of a <CODE>define_insn</CODE> pattern.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC172" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC172">16.3 RTL Template</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">The RTL template defines what insns match a pattern.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC173" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC173">16.4 Output Templates and Operand Substitution</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">The output template says how to make assembler code
                          from such an insn.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC174" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC174">16.5 C Statements for Assembler Output</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">For more generality, write C code to output
                          the assembler code.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC175" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC175">16.6 Operand Constraints</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">When not all operands are general operands.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182">16.7 Standard Pattern Names For Generation</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Names mark patterns to use for code generation.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC183" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC183">16.8 When the Order of Patterns Matters</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">When the order of patterns makes a difference.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC184" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC184">16.9 Interdependence of Patterns</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Having one pattern may make you need another.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC185" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC185">16.10 Defining Jump Instruction Patterns</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Special considerations for patterns for jump insns.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC186" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC186">16.11 Canonicalization of Instructions</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC187" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC187">16.12 Machine-Specific Peephole Optimizers</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Defining machine-specific peephole optimizations.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC188" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC188">16.13 Defining RTL Sequences for Code Generation</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Generating a sequence of several RTL insns
                         for a standard operation.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC189" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC189">16.14 Defining How to Split Instructions</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Splitting Instructions into Multiple Instructions</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC190" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC190">16.15 Instruction Attributes</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Specifying the value of attributes for generated insns.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Patterns"></A>
<HR SIZE="6">
<A NAME="SEC170"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC171" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC171"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.1 Everything about Instruction Patterns </H2>
<!--docid::SEC170::-->
<P>

<A NAME="IDX886"></A>
Each instruction pattern contains an incomplete RTL expression, with pieces
to be filled in later, operand constraints that restrict how the pieces can
be filled in, and an output pattern or C code to generate the assembler
output, all wrapped up in a <CODE>define_insn</CODE> expression.
</P><P>

A <CODE>define_insn</CODE> is an RTL expression containing four or five operands:
</P><P>

<OL>
<LI>
An optional name.  The presence of a name indicate that this instruction
pattern can perform a certain standard job for the RTL-generation
pass of the compiler.  This pass knows certain names and will use
the instruction patterns with those names, if the names are defined
in the machine description.
<P>

The absence of a name is indicated by writing an empty string
where the name should go.  Nameless instruction patterns are never
used for generating RTL code, but they may permit several simpler insns
to be combined later on.
</P><P>

Names that are not thus known and used in RTL-generation have no
effect; they are equivalent to no name at all.
</P><P>

<LI>
The <EM>RTL template</EM> (see section <A HREF="gcc_16.html#SEC172" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC172">16.3 RTL Template</A>) is a vector of incomplete
RTL expressions which show what the instruction should look like.  It is
incomplete because it may contain <CODE>match_operand</CODE>,
<CODE>match_operator</CODE>, and <CODE>match_dup</CODE> expressions that stand for
operands of the instruction.
<P>

If the vector has only one element, that element is the template for the
instruction pattern.  If the vector has multiple elements, then the
instruction pattern is a <CODE>parallel</CODE> expression containing the
elements described.
</P><P>

<LI>
<A NAME="IDX887"></A>
<A NAME="IDX888"></A>
A condition.  This is a string which contains a C expression that is
the final test to decide whether an insn body matches this pattern.
<P>

<A NAME="IDX889"></A>
For a named pattern, the condition (if present) may not depend on
the data in the insn being matched, but only the target-machine-type
flags.  The compiler needs to test these conditions during
initialization in order to learn exactly which named instructions are
available in a particular run.
</P><P>

<A NAME="IDX890"></A>
For nameless patterns, the condition is applied only when matching an
individual insn, and only after the insn has matched the pattern's
recognition template.  The insn's operands may be found in the vector
<CODE>operands</CODE>.
</P><P>

<LI>
The <EM>output template</EM>: a string that says how to output matching
insns as assembler code.  <SAMP>`%'</SAMP> in this string specifies where
to substitute the value of an operand.  See section <A HREF="gcc_16.html#SEC173" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC173">16.4 Output Templates and Operand Substitution</A>.
<P>

When simple substitution isn't general enough, you can specify a piece
of C code to compute the output.  See section <A HREF="gcc_16.html#SEC174" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC174">16.5 C Statements for Assembler Output</A>.
</P><P>

<LI>
Optionally, a vector containing the values of attributes for insns matching
this pattern.  See section <A HREF="gcc_16.html#SEC190" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC190">16.15 Instruction Attributes</A>.
</OL>
<P>

<A NAME="Example"></A>
<HR SIZE="6">
<A NAME="SEC171"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC170" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC170"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC172" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC172"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC172" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC172"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.2 Example of <CODE>define_insn</CODE> </H2>
<!--docid::SEC171::-->
<P>

Here is an actual example of an instruction pattern, for the 68000/68020.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(define_insn "tstsi"
  [(set (cc0)
        (match_operand:SI 0 "general_operand" "rm"))]
  ""
  "*
{ if (TARGET_68020 || ! ADDRESS_REG_P (operands[0]))
    return \"tstl %0\";
  return \"cmpl #0,%0\"; }")
</pre></td></tr></table></P><P>

This is an instruction that sets the condition codes based on the value of
a general operand.  It has no condition, so any insn whose RTL description
has the form shown may be handled according to this pattern.  The name
<SAMP>`tstsi'</SAMP> means "test a <CODE>SImode</CODE> value" and tells the RTL generation
pass that, when it is necessary to test such a value, an insn to do so
can be constructed using this pattern.
</P><P>

The output control string is a piece of C code which chooses which
output template to return based on the kind of operand and the specific
type of CPU for which code is being generated.
</P><P>

<SAMP>`"rm"'</SAMP> is an operand constraint.  Its meaning is explained below.
</P><P>

<A NAME="RTL Template"></A>
<HR SIZE="6">
<A NAME="SEC172"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC171" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC171"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC173" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC173"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC173" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC173"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.3 RTL Template </H2>
<!--docid::SEC172::-->
<P>

The RTL template is used to define which insns match the particular pattern
and how to find their operands.  For named patterns, the RTL template also
says how to construct an insn from specified operands.
</P><P>

Construction involves substituting specified operands into a copy of the
template.  Matching involves determining the values that serve as the
operands in the insn being matched.  Both of these activities are
controlled by special expression types that direct matching and
substitution of the operands.
</P><P>

<DL COMPACT>
<A NAME="IDX891"></A>
<DT><CODE>(match_operand:<VAR>m</VAR> <VAR>n</VAR> <VAR>predicate</VAR> <VAR>constraint</VAR>)</CODE>
<DD>This expression is a placeholder for operand number <VAR>n</VAR> of
the insn.  When constructing an insn, operand number <VAR>n</VAR>
will be substituted at this point.  When matching an insn, whatever
appears at this position in the insn will be taken as operand
number <VAR>n</VAR>; but it must satisfy <VAR>predicate</VAR> or this instruction
pattern will not match at all.
<P>

Operand numbers must be chosen consecutively counting from zero in
each instruction pattern.  There may be only one <CODE>match_operand</CODE>
expression in the pattern for each operand number.  Usually operands
are numbered in the order of appearance in <CODE>match_operand</CODE>
expressions.  In the case of a <CODE>define_expand</CODE>, any operand numbers
used only in <CODE>match_dup</CODE> expressions have higher values than all
other operand numbers.
</P><P>

<VAR>predicate</VAR> is a string that is the name of a C function that accepts two
arguments, an expression and a machine mode.  During matching, the
function will be called with the putative operand as the expression and
<VAR>m</VAR> as the mode argument (if <VAR>m</VAR> is not specified,
<CODE>VOIDmode</CODE> will be used, which normally causes <VAR>predicate</VAR> to accept
any mode).  If it returns zero, this instruction pattern fails to match.
<VAR>predicate</VAR> may be an empty string; then it means no test is to be done
on the operand, so anything which occurs in this position is valid.
</P><P>

Most of the time, <VAR>predicate</VAR> will reject modes other than <VAR>m</VAR>---but
not always.  For example, the predicate <CODE>address_operand</CODE> uses
<VAR>m</VAR> as the mode of memory ref that the address should be valid for.
Many predicates accept <CODE>const_int</CODE> nodes even though their mode is
<CODE>VOIDmode</CODE>.
</P><P>

<VAR>constraint</VAR> controls reloading and the choice of the best register
class to use for a value, as explained later (see section <A HREF="gcc_16.html#SEC175" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC175">16.6 Operand Constraints</A>).
</P><P>

People are often unclear on the difference between the constraint and the
predicate.  The predicate helps decide whether a given insn matches the
pattern.  The constraint plays no role in this decision; instead, it
controls various decisions in the case of an insn which does match.
</P><P>

<A NAME="IDX892"></A>
On CISC machines, the most common <VAR>predicate</VAR> is
<CODE>"general_operand"</CODE>.  This function checks that the putative
operand is either a constant, a register or a memory reference, and that
it is valid for mode <VAR>m</VAR>.
</P><P>

<A NAME="IDX893"></A>
For an operand that must be a register, <VAR>predicate</VAR> should be
<CODE>"register_operand"</CODE>.  Using <CODE>"general_operand"</CODE> would be
valid, since the reload pass would copy any non-register operands
through registers, but this would make GNU CC do extra work, it would
prevent invariant operands (such as constant) from being removed from
loops, and it would prevent the register allocator from doing the best
possible job.  On RISC machines, it is usually most efficient to allow
<VAR>predicate</VAR> to accept only objects that the constraints allow.
</P><P>

<A NAME="IDX894"></A>
For an operand that must be a constant, you must be sure to either use
<CODE>"immediate_operand"</CODE> for <VAR>predicate</VAR>, or make the instruction
pattern's extra condition require a constant, or both.  You cannot
expect the constraints to do this work!  If the constraints allow only
constants, but the predicate allows something else, the compiler will
crash when that case arises.
</P><P>

<A NAME="IDX895"></A>
<DT><CODE>(match_scratch:<VAR>m</VAR> <VAR>n</VAR> <VAR>constraint</VAR>)</CODE>
<DD>This expression is also a placeholder for operand number <VAR>n</VAR>
and indicates that operand must be a <CODE>scratch</CODE> or <CODE>reg</CODE>
expression.
<P>

When matching patterns, this is equivalent to
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(match_operand:<VAR>m</VAR> <VAR>n</VAR> "scratch_operand" <VAR>pred</VAR>)
</FONT></pre></td></tr></table></P><P>

but, when generating RTL, it produces a (<CODE>scratch</CODE>:<VAR>m</VAR>)
expression.
</P><P>

If the last few expressions in a <CODE>parallel</CODE> are <CODE>clobber</CODE>
expressions whose operands are either a hard register or
<CODE>match_scratch</CODE>, the combiner can add or delete them when
necessary.  See section <A HREF="gcc_15.html#SEC162" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_15.html#SEC162">15.13 Side Effect Expressions</A>.
</P><P>

<A NAME="IDX896"></A>
<DT><CODE>(match_dup <VAR>n</VAR>)</CODE>
<DD>This expression is also a placeholder for operand number <VAR>n</VAR>.
It is used when the operand needs to appear more than once in the
insn.
<P>

In construction, <CODE>match_dup</CODE> acts just like <CODE>match_operand</CODE>:
the operand is substituted into the insn being constructed.  But in
matching, <CODE>match_dup</CODE> behaves differently.  It assumes that operand
number <VAR>n</VAR> has already been determined by a <CODE>match_operand</CODE>
appearing earlier in the recognition template, and it matches only an
identical-looking expression.
</P><P>

<A NAME="IDX897"></A>
<DT><CODE>(match_operator:<VAR>m</VAR> <VAR>n</VAR> <VAR>predicate</VAR> [<VAR>operands</VAR><small>...</small>])</CODE>
<DD>This pattern is a kind of placeholder for a variable RTL expression
code.
<P>

When constructing an insn, it stands for an RTL expression whose
expression code is taken from that of operand <VAR>n</VAR>, and whose
operands are constructed from the patterns <VAR>operands</VAR>.
</P><P>

When matching an expression, it matches an expression if the function
<VAR>predicate</VAR> returns nonzero on that expression <EM>and</EM> the
patterns <VAR>operands</VAR> match the operands of the expression.
</P><P>

Suppose that the function <CODE>commutative_operator</CODE> is defined as
follows, to match any expression whose operator is one of the
commutative arithmetic operators of RTL and whose mode is <VAR>mode</VAR>:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>int
commutative_operator (x, mode)
     rtx x;
     enum machine_mode mode;
{
  enum rtx_code code = GET_CODE (x);
  if (GET_MODE (x) != mode)
    return 0;
  return (GET_RTX_CLASS (code) == 'c'
          || code == EQ || code == NE);
}
</FONT></pre></td></tr></table></P><P>

Then the following pattern will match any RTL expression consisting
of a commutative operator applied to two general operands:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(match_operator:SI 3 "commutative_operator"
  [(match_operand:SI 1 "general_operand" "g")
   (match_operand:SI 2 "general_operand" "g")])
</FONT></pre></td></tr></table></P><P>

Here the vector <CODE>[<VAR>operands</VAR><small>...</small>]</CODE> contains two patterns
because the expressions to be matched all contain two operands.
</P><P>

When this pattern does match, the two operands of the commutative
operator are recorded as operands 1 and 2 of the insn.  (This is done
by the two instances of <CODE>match_operand</CODE>.)  Operand 3 of the insn
will be the entire commutative expression: use <CODE>GET_CODE
(operands[3])</CODE> to see which commutative operator was used.
</P><P>

The machine mode <VAR>m</VAR> of <CODE>match_operator</CODE> works like that of
<CODE>match_operand</CODE>: it is passed as the second argument to the
predicate function, and that function is solely responsible for
deciding whether the expression to be matched "has" that mode.
</P><P>

When constructing an insn, argument 3 of the gen-function will specify
the operation (i.e. the expression code) for the expression to be
made.  It should be an RTL expression, whose expression code is copied
into a new expression whose operands are arguments 1 and 2 of the
gen-function.  The subexpressions of argument 3 are not used;
only its expression code matters.
</P><P>

When <CODE>match_operator</CODE> is used in a pattern for matching an insn,
it usually best if the operand number of the <CODE>match_operator</CODE>
is higher than that of the actual operands of the insn.  This improves
register allocation because the register allocator often looks at
operands 1 and 2 of insns to see if it can do register tying.
</P><P>

There is no way to specify constraints in <CODE>match_operator</CODE>.  The
operand of the insn which corresponds to the <CODE>match_operator</CODE>
never has any constraints because it is never reloaded as a whole.
However, if parts of its <VAR>operands</VAR> are matched by
<CODE>match_operand</CODE> patterns, those parts may have constraints of
their own.
</P><P>

<A NAME="IDX898"></A>
<DT><CODE>(match_op_dup:<VAR>m</VAR> <VAR>n</VAR>[<VAR>operands</VAR><small>...</small>])</CODE>
<DD>Like <CODE>match_dup</CODE>, except that it applies to operators instead of
operands.  When constructing an insn, operand number <VAR>n</VAR> will be
substituted at this point.  But in matching, <CODE>match_op_dup</CODE> behaves
differently.  It assumes that operand number <VAR>n</VAR> has already been
determined by a <CODE>match_operator</CODE> appearing earlier in the
recognition template, and it matches only an identical-looking
expression.
<P>

<A NAME="IDX899"></A>
<DT><CODE>(match_parallel <VAR>n</VAR> <VAR>predicate</VAR> [<VAR>subpat</VAR><small>...</small>])</CODE>
<DD>This pattern is a placeholder for an insn that consists of a
<CODE>parallel</CODE> expression with a variable number of elements.  This
expression should only appear at the top level of an insn pattern.
<P>

When constructing an insn, operand number <VAR>n</VAR> will be substituted at
this point.  When matching an insn, it matches if the body of the insn
is a <CODE>parallel</CODE> expression with at least as many elements as the
vector of <VAR>subpat</VAR> expressions in the <CODE>match_parallel</CODE>, if each
<VAR>subpat</VAR> matches the corresponding element of the <CODE>parallel</CODE>,
<EM>and</EM> the function <VAR>predicate</VAR> returns nonzero on the
<CODE>parallel</CODE> that is the body of the insn.  It is the responsibility
of the predicate to validate elements of the <CODE>parallel</CODE> beyond
those listed in the <CODE>match_parallel</CODE>.</P><P>

A typical use of <CODE>match_parallel</CODE> is to match load and store
multiple expressions, which can contain a variable number of elements
in a <CODE>parallel</CODE>.  For example,
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn ""
  [(match_parallel 0 "load_multiple_operation"
     [(set (match_operand:SI 1 "gpc_reg_operand" "=r")
           (match_operand:SI 2 "memory_operand" "m"))
      (use (reg:SI 179))
      (clobber (reg:SI 179))])]
  ""
  "loadm 0,0,%1,%2")
</FONT></pre></td></tr></table></P><P>

This example comes from <TT>`a29k.md'</TT>.  The function
<CODE>load_multiple_operations</CODE> is defined in <TT>`a29k.c'</TT> and checks
that subsequent elements in the <CODE>parallel</CODE> are the same as the
<CODE>set</CODE> in the pattern, except that they are referencing subsequent
registers and memory locations.
</P><P>

An insn that matches this pattern might look like:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(parallel
 [(set (reg:SI 20) (mem:SI (reg:SI 100)))
  (use (reg:SI 179))
  (clobber (reg:SI 179))
  (set (reg:SI 21)
       (mem:SI (plus:SI (reg:SI 100)
                        (const_int 4))))
  (set (reg:SI 22)
       (mem:SI (plus:SI (reg:SI 100)
                        (const_int 8))))])
</FONT></pre></td></tr></table></P><P>

<A NAME="IDX900"></A>
<DT><CODE>(match_par_dup <VAR>n</VAR> [<VAR>subpat</VAR><small>...</small>])</CODE>
<DD>Like <CODE>match_op_dup</CODE>, but for <CODE>match_parallel</CODE> instead of
<CODE>match_operator</CODE>.
<P>

<A NAME="IDX901"></A>
<DT><CODE>(match_insn <VAR>predicate</VAR>)</CODE>
<DD>Match a complete insn.  Unlike the other <CODE>match_*</CODE> recognizers,
<CODE>match_insn</CODE> does not take an operand number.
<P>

The machine mode <VAR>m</VAR> of <CODE>match_insn</CODE> works like that of
<CODE>match_operand</CODE>: it is passed as the second argument to the
predicate function, and that function is solely responsible for
deciding whether the expression to be matched "has" that mode.
</P><P>

<A NAME="IDX902"></A>
<DT><CODE>(match_insn2 <VAR>n</VAR> <VAR>predicate</VAR>)</CODE>
<DD>Match a complete insn.
<P>

The machine mode <VAR>m</VAR> of <CODE>match_insn2</CODE> works like that of
<CODE>match_operand</CODE>: it is passed as the second argument to the
predicate function, and that function is solely responsible for
deciding whether the expression to be matched "has" that mode.
</P><P>

<A NAME="IDX903"></A>
<DT><CODE>(address (match_operand:<VAR>m</VAR> <VAR>n</VAR> "address_operand" ""))</CODE>
<DD>This complex of expressions is a placeholder for an operand number
<VAR>n</VAR> in a "load address" instruction: an operand which specifies
a memory location in the usual way, but for which the actual operand
value used is the address of the location, not the contents of the
location.
<P>

<CODE>address</CODE> expressions never appear in RTL code, only in machine
descriptions.  And they are used only in machine descriptions that do
not use the operand constraint feature.  When operand constraints are
in use, the letter <SAMP>`p'</SAMP> in the constraint serves this purpose.
</P><P>

<VAR>m</VAR> is the machine mode of the <EM>memory location being
addressed</EM>, not the machine mode of the address itself.  That mode is
always the same on a given target machine (it is <CODE>Pmode</CODE>, which
normally is <CODE>SImode</CODE>), so there is no point in mentioning it;
thus, no machine mode is written in the <CODE>address</CODE> expression.  If
some day support is added for machines in which addresses of different
kinds of objects appear differently or are used differently (such as
the PDP-10), different formats would perhaps need different machine
modes and these modes might be written in the <CODE>address</CODE>
expression.
</DL>
<P>

<A NAME="Output Template"></A>
<HR SIZE="6">
<A NAME="SEC173"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC172" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC172"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC174" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC174"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC174" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC174"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.4 Output Templates and Operand Substitution </H2>
<!--docid::SEC173::-->
<P>

<A NAME="IDX904"></A>
<A NAME="IDX905"></A>
The <EM>output template</EM> is a string which specifies how to output the
assembler code for an instruction pattern.  Most of the template is a
fixed string which is output literally.  The character <SAMP>`%'</SAMP> is used
to specify where to substitute an operand; it can also be used to
identify places where different variants of the assembler require
different syntax.
</P><P>

In the simplest case, a <SAMP>`%'</SAMP> followed by a digit <VAR>n</VAR> says to output
operand <VAR>n</VAR> at that point in the string.
</P><P>

<SAMP>`%'</SAMP> followed by a letter and a digit says to output an operand in an
alternate fashion.  Four letters have standard, built-in meanings described
below.  The machine description macro <CODE>PRINT_OPERAND</CODE> can define
additional letters with nonstandard meanings.
</P><P>

<SAMP>`%c<VAR>digit</VAR>'</SAMP> can be used to substitute an operand that is a
constant value without the syntax that normally indicates an immediate
operand.
</P><P>

<SAMP>`%n<VAR>digit</VAR>'</SAMP> is like <SAMP>`%c<VAR>digit</VAR>'</SAMP> except that the value of
the constant is negated before printing.
</P><P>

<SAMP>`%a<VAR>digit</VAR>'</SAMP> can be used to substitute an operand as if it were a
memory reference, with the actual operand treated as the address.  This may
be useful when outputting a "load address" instruction, because often the
assembler syntax for such an instruction requires you to write the operand
as if it were a memory reference.
</P><P>

<SAMP>`%l<VAR>digit</VAR>'</SAMP> is used to substitute a <CODE>label_ref</CODE> into a jump
instruction.
</P><P>

<SAMP>`%='</SAMP> outputs a number which is unique to each instruction in the
entire compilation.  This is useful for making local labels to be
referred to more than once in a single template that generates multiple
assembler instructions.
</P><P>

<SAMP>`%'</SAMP> followed by a punctuation character specifies a substitution that
does not use an operand.  Only one case is standard: <SAMP>`%%'</SAMP> outputs a
<SAMP>`%'</SAMP> into the assembler code.  Other nonstandard cases can be
defined in the <CODE>PRINT_OPERAND</CODE> macro.  You must also define
which punctuation characters are valid with the
<CODE>PRINT_OPERAND_PUNCT_VALID_P</CODE> macro.
</P><P>

<A NAME="IDX906"></A>
<A NAME="IDX907"></A>
The template may generate multiple assembler instructions.  Write the text
for the instructions, with <SAMP>`\;'</SAMP> between them.
</P><P>

<A NAME="IDX908"></A>
When the RTL contains two operands which are required by constraint to match
each other, the output template must refer only to the lower-numbered operand.
Matching operands are not always identical, and the rest of the compiler
arranges to put the proper RTL expression for printing into the lower-numbered
operand.
</P><P>

One use of nonstandard letters or punctuation following <SAMP>`%'</SAMP> is to
distinguish between different assembler languages for the same machine; for
example, Motorola syntax versus MIT syntax for the 68000.  Motorola syntax
requires periods in most opcode names, while MIT syntax does not.  For
example, the opcode <SAMP>`movel'</SAMP> in MIT syntax is <SAMP>`move.l'</SAMP> in Motorola
syntax.  The same file of patterns is used for both kinds of output syntax,
but the character sequence <SAMP>`%.'</SAMP> is used in each place where Motorola
syntax wants a period.  The <CODE>PRINT_OPERAND</CODE> macro for Motorola syntax
defines the sequence to output a period; the macro for MIT syntax defines
it to do nothing.
</P><P>

<A NAME="IDX909"></A>
As a special case, a template consisting of the single character <CODE>#</CODE>
instructs the compiler to first split the insn, and then output the
resulting instructions separately.  This helps eliminate redundancy in the
output templates.   If you have a <CODE>define_insn</CODE> that needs to emit
multiple assembler instructions, and there is an matching <CODE>define_split</CODE>
already defined, then you can simply use <CODE>#</CODE> as the output template
instead of writing an output template that emits the multiple assembler
instructions.
</P><P>

If the macro <CODE>ASSEMBLER_DIALECT</CODE> is defined, you can use construct
of the form <SAMP>`{option0|option1|option2}'</SAMP> in the templates.  These
describe multiple variants of assembler language syntax.
See section <A HREF="gcc_17.html#SEC239" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC239">17.16.7 Output of Assembler Instructions</A>.
</P><P>

<A NAME="Output Statement"></A>
<HR SIZE="6">
<A NAME="SEC174"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC173" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC173"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC175" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC175"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC175" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC175"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.5 C Statements for Assembler Output </H2>
<!--docid::SEC174::-->
<P>

Often a single fixed template string cannot produce correct and efficient
assembler code for all the cases that are recognized by a single
instruction pattern.  For example, the opcodes may depend on the kinds of
operands; or some unfortunate combinations of operands may require extra
machine instructions.
</P><P>

If the output control string starts with a <SAMP>`@'</SAMP>, then it is actually
a series of templates, each on a separate line.  (Blank lines and
leading spaces and tabs are ignored.)  The templates correspond to the
pattern's constraint alternatives (see section <A HREF="gcc_16.html#SEC177" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC177">16.6.2 Multiple Alternative Constraints</A>).  For example,
if a target machine has a two-address add instruction <SAMP>`addr'</SAMP> to add
into a register and another <SAMP>`addm'</SAMP> to add a register to memory, you
might write this pattern:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn "addsi3"
  [(set (match_operand:SI 0 "general_operand" "=r,m")
        (plus:SI (match_operand:SI 1 "general_operand" "0,0")
                 (match_operand:SI 2 "general_operand" "g,r")))]
  ""
  "@
   addr %2,%0
   addm %2,%0")
</FONT></pre></td></tr></table></P><P>

<A NAME="IDX910"></A>
<A NAME="IDX911"></A>
If the output control string starts with a <SAMP>`*'</SAMP>, then it is not an
output template but rather a piece of C program that should compute a
template.  It should execute a <CODE>return</CODE> statement to return the
template-string you want.  Most such templates use C string literals, which
require doublequote characters to delimit them.  To include these
doublequote characters in the string, prefix each one with <SAMP>`\'</SAMP>.
</P><P>

The operands may be found in the array <CODE>operands</CODE>, whose C data type
is <CODE>rtx []</CODE>.
</P><P>

It is very common to select different ways of generating assembler code
based on whether an immediate operand is within a certain range.  Be
careful when doing this, because the result of <CODE>INTVAL</CODE> is an
integer on the host machine.  If the host machine has more bits in an
<CODE>int</CODE> than the target machine has in the mode in which the constant
will be used, then some of the bits you get from <CODE>INTVAL</CODE> will be
superfluous.  For proper results, you must carefully disregard the
values of those bits.
</P><P>

<A NAME="IDX912"></A>
It is possible to output an assembler instruction and then go on to output
or compute more of them, using the subroutine <CODE>output_asm_insn</CODE>.  This
receives two arguments: a template-string and a vector of operands.  The
vector may be <CODE>operands</CODE>, or it may be another array of <CODE>rtx</CODE>
that you declare locally and initialize yourself.
</P><P>

<A NAME="IDX913"></A>
When an insn pattern has multiple alternatives in its constraints, often
the appearance of the assembler code is determined mostly by which alternative
was matched.  When this is so, the C code can test the variable
<CODE>which_alternative</CODE>, which is the ordinal number of the alternative
that was actually satisfied (0 for the first, 1 for the second alternative,
etc.).
</P><P>

For example, suppose there are two opcodes for storing zero, <SAMP>`clrreg'</SAMP>
for registers and <SAMP>`clrmem'</SAMP> for memory locations.  Here is how
a pattern could use <CODE>which_alternative</CODE> to choose between them:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn ""
  [(set (match_operand:SI 0 "general_operand" "=r,m")
        (const_int 0))]
  ""
  "*
  return (which_alternative == 0
          ? \"clrreg %0\" : \"clrmem %0\");
  ")
</FONT></pre></td></tr></table></P><P>

The example above, where the assembler code to generate was
<EM>solely</EM> determined by the alternative, could also have been specified
as follows, having the output control string start with a <SAMP>`@'</SAMP>:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn ""
  [(set (match_operand:SI 0 "general_operand" "=r,m")
        (const_int 0))]
  ""
  "@
   clrreg %0
   clrmem %0")
</FONT></pre></td></tr></table></P><P>

<A NAME="Constraints"></A>
<HR SIZE="6">
<A NAME="SEC175"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC174" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC174"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC176" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC176"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.6 Operand Constraints </H2>
<!--docid::SEC175::-->
<P>

Each <CODE>match_operand</CODE> in an instruction pattern can specify a
constraint for the type of operands allowed.
Constraints can say whether
an operand may be in a register, and which kinds of register; whether the
operand can be a memory reference, and which kinds of address; whether the
operand may be an immediate constant, and which possible values it may
have.  Constraints can also require two operands to match.
</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC176" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC176">16.6.1 Simple Constraints</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Basic use of constraints.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC177" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC177">16.6.2 Multiple Alternative Constraints</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">When an insn has two alternative constraint-patterns.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC178" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC178">16.6.3 Register Class Preferences</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Constraints guide which hard register to put things in.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC179" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC179">16.6.4 Constraint Modifier Characters</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">More precise control over effects of constraints.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC180" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC180">16.6.5 Constraints for Particular Machines</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Existing constraints for some particular machines.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC181" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC181">16.6.6 Not Using Constraints</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Describing a clean machine without constraints.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Simple Constraints"></A>
<HR SIZE="6">
<A NAME="SEC176"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC175" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC175"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC177" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC177"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC175" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC175"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.6.1 Simple Constraints </H3>
<!--docid::SEC176::-->
<P>

The simplest kind of constraint is a string full of letters, each of
which describes one kind of operand that is permitted.  Here are
the letters that are allowed:
</P><P>

<DL COMPACT>
<A NAME="IDX914"></A>
<A NAME="IDX915"></A>
<DT><SAMP>`m'</SAMP>
<DD>A memory operand is allowed, with any kind of address that the machine
supports in general.
<P>

<A NAME="IDX916"></A>
<A NAME="IDX917"></A>
<DT><SAMP>`o'</SAMP>
<DD>A memory operand is allowed, but only if the address is
<EM>offsettable</EM>.  This means that adding a small integer (actually,
the width in bytes of the operand, as determined by its machine mode)
may be added to the address and the result is also a valid memory
address.
<P>

<A NAME="IDX918"></A>
For example, an address which is constant is offsettable; so is an
address that is the sum of a register and a constant (as long as a
slightly larger constant is also within the range of address-offsets
supported by the machine); but an autoincrement or autodecrement
address is not offsettable.  More complicated indirect/indexed
addresses may or may not be offsettable depending on the other
addressing modes that the machine supports.
</P><P>

Note that in an output operand which can be matched by another
operand, the constraint letter <SAMP>`o'</SAMP> is valid only when accompanied
by both <SAMP>`&#60;'</SAMP> (if the target machine has predecrement addressing)
and <SAMP>`&#62;'</SAMP> (if the target machine has preincrement addressing).
</P><P>

<A NAME="IDX919"></A>
<DT><SAMP>`V'</SAMP>
<DD>A memory operand that is not offsettable.  In other words, anything that
would fit the <SAMP>`m'</SAMP> constraint but not the <SAMP>`o'</SAMP> constraint.
<P>

<A NAME="IDX920"></A>
<DT><SAMP>`&#60;'</SAMP>
<DD>A memory operand with autodecrement addressing (either predecrement or
postdecrement) is allowed.
<P>

<A NAME="IDX921"></A>
<DT><SAMP>`&#62;'</SAMP>
<DD>A memory operand with autoincrement addressing (either preincrement or
postincrement) is allowed.
<P>

<A NAME="IDX922"></A>
<A NAME="IDX923"></A>
<DT><SAMP>`r'</SAMP>
<DD>A register operand is allowed provided that it is in a general
register.
<P>

<A NAME="IDX924"></A>
<DT><SAMP>`d'</SAMP>, <SAMP>`a'</SAMP>, <SAMP>`f'</SAMP>, <small>...</small>
<DD>Other letters can be defined in machine-dependent fashion to stand for
particular classes of registers.  <SAMP>`d'</SAMP>, <SAMP>`a'</SAMP> and <SAMP>`f'</SAMP> are
defined on the 68000/68020 to stand for data, address and floating
point registers.
<P>

<A NAME="IDX925"></A>
<A NAME="IDX926"></A>
<DT><SAMP>`i'</SAMP>
<DD>An immediate integer operand (one with constant value) is allowed.
This includes symbolic constants whose values will be known only at
assembly time.
<P>

<A NAME="IDX927"></A>
<DT><SAMP>`n'</SAMP>
<DD>An immediate integer operand with a known numeric value is allowed.
Many systems cannot support assembly-time constants for operands less
than a word wide.  Constraints for these operands should use <SAMP>`n'</SAMP>
rather than <SAMP>`i'</SAMP>.
<P>

<A NAME="IDX928"></A>
<DT><SAMP>`I'</SAMP>, <SAMP>`J'</SAMP>, <SAMP>`K'</SAMP>, <small>...</small> <SAMP>`P'</SAMP>
<DD>Other letters in the range <SAMP>`I'</SAMP> through <SAMP>`P'</SAMP> may be defined in
a machine-dependent fashion to permit immediate integer operands with
explicit integer values in specified ranges.  For example, on the
68000, <SAMP>`I'</SAMP> is defined to stand for the range of values 1 to 8.
This is the range permitted as a shift count in the shift
instructions.
<P>

<A NAME="IDX929"></A>
<DT><SAMP>`E'</SAMP>
<DD>An immediate floating operand (expression code <CODE>const_double</CODE>) is
allowed, but only if the target floating point format is the same as
that of the host machine (on which the compiler is running).
<P>

<A NAME="IDX930"></A>
<DT><SAMP>`F'</SAMP>
<DD>An immediate floating operand (expression code <CODE>const_double</CODE>) is
allowed.
<P>

<A NAME="IDX931"></A>
<A NAME="IDX932"></A>
<DT><SAMP>`G'</SAMP>, <SAMP>`H'</SAMP>
<DD><SAMP>`G'</SAMP> and <SAMP>`H'</SAMP> may be defined in a machine-dependent fashion to
permit immediate floating operands in particular ranges of values.
<P>

<A NAME="IDX933"></A>
<DT><SAMP>`s'</SAMP>
<DD>An immediate integer operand whose value is not an explicit integer is
allowed.
<P>

This might appear strange; if an insn allows a constant operand with a
value not known at compile time, it certainly must allow any known
value.  So why use <SAMP>`s'</SAMP> instead of <SAMP>`i'</SAMP>?  Sometimes it allows
better code to be generated.
</P><P>

For example, on the 68000 in a fullword instruction it is possible to
use an immediate operand; but if the immediate value is between -128
and 127, better code results from loading the value into a register and
using the register.  This is because the load into the register can be
done with a <SAMP>`moveq'</SAMP> instruction.  We arrange for this to happen
by defining the letter <SAMP>`K'</SAMP> to mean "any integer outside the
range -128 to 127", and then specifying <SAMP>`Ks'</SAMP> in the operand
constraints.
</P><P>

<A NAME="IDX934"></A>
<DT><SAMP>`g'</SAMP>
<DD>Any register, memory or immediate integer operand is allowed, except for
registers that are not general registers.
<P>

<A NAME="IDX935"></A>
<DT><SAMP>`X'</SAMP>
<DD>Any operand whatsoever is allowed, even if it does not satisfy
<CODE>general_operand</CODE>.  This is normally used in the constraint of
a <CODE>match_scratch</CODE> when certain alternatives will not actually
require a scratch register.
<P>

<A NAME="IDX936"></A>
<A NAME="IDX937"></A>
<DT><SAMP>`0'</SAMP>, <SAMP>`1'</SAMP>, <SAMP>`2'</SAMP>, <small>...</small> <SAMP>`9'</SAMP>
<DD>An operand that matches the specified operand number is allowed.  If a
digit is used together with letters within the same alternative, the
digit should come last.
<P>

<A NAME="IDX938"></A>
<A NAME="IDX939"></A>
This is called a <EM>matching constraint</EM> and what it really means is
that the assembler has only a single operand that fills two roles
considered separate in the RTL insn.  For example, an add insn has two
input operands and one output operand in the RTL, but on most CISC
machines an add instruction really has only two operands, one of them an
input-output operand:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>addl #35,r12
</FONT></pre></td></tr></table></P><P>

Matching constraints are used in these circumstances.
More precisely, the two operands that match must include one input-only
operand and one output-only operand.  Moreover, the digit must be a
smaller number than the number of the operand that uses it in the
constraint.
</P><P>

For operands to match in a particular case usually means that they
are identical-looking RTL expressions.  But in a few special cases
specific kinds of dissimilarity are allowed.  For example, <CODE>*x</CODE>
as an input operand will match <CODE>*x++</CODE> as an output operand.
For proper results in such cases, the output template should always
use the output-operand's number when printing the operand.
</P><P>

<A NAME="IDX940"></A>
<A NAME="IDX941"></A>
<A NAME="IDX942"></A>
<A NAME="IDX943"></A>
<DT><SAMP>`p'</SAMP>
<DD>An operand that is a valid memory address is allowed.  This is
for "load address" and "push address" instructions.
<P>

<A NAME="IDX944"></A>
<SAMP>`p'</SAMP> in the constraint must be accompanied by <CODE>address_operand</CODE>
as the predicate in the <CODE>match_operand</CODE>.  This predicate interprets
the mode specified in the <CODE>match_operand</CODE> as the mode of the memory
reference for which the address would be valid.
</P><P>

<A NAME="IDX945"></A>
<A NAME="IDX946"></A>
<DT><SAMP>`Q'</SAMP>, <SAMP>`R'</SAMP>, <SAMP>`S'</SAMP>, <small>...</small> <SAMP>`U'</SAMP>
<DD>Letters in the range <SAMP>`Q'</SAMP> through <SAMP>`U'</SAMP> may be defined in a
machine-dependent fashion to stand for arbitrary operand types.
The machine description macro <CODE>EXTRA_CONSTRAINT</CODE> is passed the
operand as its first argument and the constraint letter as its
second operand.
<P>

A typical use for this would be to distinguish certain types of
memory references that affect other insn operands.
</P><P>

Do not define these constraint letters to accept register references
(<CODE>reg</CODE>); the reload pass does not expect this and would not handle
it properly.
</DL>
<P>

In order to have valid assembler code, each operand must satisfy
its constraint.  But a failure to do so does not prevent the pattern
from applying to an insn.  Instead, it directs the compiler to modify
the code so that the constraint will be satisfied.  Usually this is
done by copying an operand into a register.
</P><P>

Contrast, therefore, the two instruction patterns that follow:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn ""
  [(set (match_operand:SI 0 "general_operand" "=r")
        (plus:SI (match_dup 0)
                 (match_operand:SI 1 "general_operand" "r")))]
  ""
  "<small>...</small>")
</FONT></pre></td></tr></table></P><P>

which has two operands, one of which must appear in two places, and
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn ""
  [(set (match_operand:SI 0 "general_operand" "=r")
        (plus:SI (match_operand:SI 1 "general_operand" "0")
                 (match_operand:SI 2 "general_operand" "r")))]
  ""
  "<small>...</small>")
</FONT></pre></td></tr></table></P><P>

which has three operands, two of which are required by a constraint to be
identical.  If we are considering an insn of the form
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(insn <VAR>n</VAR> <VAR>prev</VAR> <VAR>next</VAR>
  (set (reg:SI 3)
       (plus:SI (reg:SI 6) (reg:SI 109)))
  <small>...</small>)
</FONT></pre></td></tr></table></P><P>

the first pattern would not apply at all, because this insn does not
contain two identical subexpressions in the right place.  The pattern would
say, "That does not look like an add instruction; try other patterns."
The second pattern would say, "Yes, that's an add instruction, but there
is something wrong with it."  It would direct the reload pass of the
compiler to generate additional insns to make the constraint true.  The
results might look like this:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(insn <VAR>n2</VAR> <VAR>prev</VAR> <VAR>n</VAR>
  (set (reg:SI 3) (reg:SI 6))
  <small>...</small>)

(insn <VAR>n</VAR> <VAR>n2</VAR> <VAR>next</VAR>
  (set (reg:SI 3)
       (plus:SI (reg:SI 3) (reg:SI 109)))
  <small>...</small>)
</FONT></pre></td></tr></table></P><P>

It is up to you to make sure that each operand, in each pattern, has
constraints that can handle any RTL expression that could be present for
that operand.  (When multiple alternatives are in use, each pattern must,
for each possible combination of operand expressions, have at least one
alternative which can handle that combination of operands.)  The
constraints don't need to <EM>allow</EM> any possible operand--when this is
the case, they do not constrain--but they must at least point the way to
reloading any possible operand so that it will fit.
</P><P>

<UL>
<LI>
If the constraint accepts whatever operands the predicate permits,
there is no problem: reloading is never necessary for this operand.
<P>

For example, an operand whose constraints permit everything except
registers is safe provided its predicate rejects registers.
</P><P>

An operand whose predicate accepts only constant values is safe
provided its constraints include the letter <SAMP>`i'</SAMP>.  If any possible
constant value is accepted, then nothing less than <SAMP>`i'</SAMP> will do;
if the predicate is more selective, then the constraints may also be
more selective.
</P><P>

<LI>
Any operand expression can be reloaded by copying it into a register.
So if an operand's constraints allow some kind of register, it is
certain to be safe.  It need not permit all classes of registers; the
compiler knows how to copy a register into another register of the
proper class in order to make an instruction valid.
<P>

<A NAME="IDX947"></A>
<A NAME="IDX948"></A>
<LI>
A nonoffsettable memory reference can be reloaded by copying the
address into a register.  So if the constraint uses the letter
<SAMP>`o'</SAMP>, all memory references are taken care of.
<P>

<LI>
A constant operand can be reloaded by allocating space in memory to
hold it as preinitialized data.  Then the memory reference can be used
in place of the constant.  So if the constraint uses the letters
<SAMP>`o'</SAMP> or <SAMP>`m'</SAMP>, constant operands are not a problem.
<P>

<LI>
If the constraint permits a constant and a pseudo register used in an insn
was not allocated to a hard register and is equivalent to a constant,
the register will be replaced with the constant.  If the predicate does
not permit a constant and the insn is re-recognized for some reason, the
compiler will crash.  Thus the predicate must always recognize any
objects allowed by the constraint.
</UL>
<P>

If the operand's predicate can recognize registers, but the constraint does
not permit them, it can make the compiler crash.  When this operand happens
to be a register, the reload pass will be stymied, because it does not know
how to copy a register temporarily into memory.
</P><P>

If the predicate accepts a unary operator, the constraint applies to the
operand.  For example, the MIPS processor at ISA level 3 supports an
instruction which adds two registers in <CODE>SImode</CODE> to produce a
<CODE>DImode</CODE> result, but only if the registers are correctly sign
extended.  This predicate for the input operands accepts a
<CODE>sign_extend</CODE> of an <CODE>SImode</CODE> register.  Write the constraint
to indicate the type of register that is required for the operand of the
<CODE>sign_extend</CODE>.
</P><P>

<A NAME="Multi-Alternative"></A>
<HR SIZE="6">
<A NAME="SEC177"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC176" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC176"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC178" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC178"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC178" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC178"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC175" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC175"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.6.2 Multiple Alternative Constraints </H3>
<!--docid::SEC177::-->
<P>

Sometimes a single instruction has multiple alternative sets of possible
operands.  For example, on the 68000, a logical-or instruction can combine
register or an immediate value into memory, or it can combine any kind of
operand into a register; but it cannot combine one memory location into
another.
</P><P>

These constraints are represented as multiple alternatives.  An alternative
can be described by a series of letters for each operand.  The overall
constraint for an operand is made from the letters for this operand
from the first alternative, a comma, the letters for this operand from
the second alternative, a comma, and so on until the last alternative.
Here is how it is done for fullword logical-or on the 68000:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn "iorsi3"
  [(set (match_operand:SI 0 "general_operand" "=m,d")
        (ior:SI (match_operand:SI 1 "general_operand" "%0,0")
                (match_operand:SI 2 "general_operand" "dKs,dmKs")))]
  <small>...</small>)
</FONT></pre></td></tr></table></P><P>

The first alternative has <SAMP>`m'</SAMP> (memory) for operand 0, <SAMP>`0'</SAMP> for
operand 1 (meaning it must match operand 0), and <SAMP>`dKs'</SAMP> for operand
2.  The second alternative has <SAMP>`d'</SAMP> (data register) for operand 0,
<SAMP>`0'</SAMP> for operand 1, and <SAMP>`dmKs'</SAMP> for operand 2.  The <SAMP>`='</SAMP> and
<SAMP>`%'</SAMP> in the constraints apply to all the alternatives; their
meaning is explained in the next section (see section <A HREF="gcc_16.html#SEC178" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC178">16.6.3 Register Class Preferences</A>).
</P><P>

If all the operands fit any one alternative, the instruction is valid.
Otherwise, for each alternative, the compiler counts how many instructions
must be added to copy the operands so that that alternative applies.
The alternative requiring the least copying is chosen.  If two alternatives
need the same amount of copying, the one that comes first is chosen.
These choices can be altered with the <SAMP>`?'</SAMP> and <SAMP>`!'</SAMP> characters:
</P><P>

<DL COMPACT>
<A NAME="IDX949"></A>
<A NAME="IDX950"></A>
<DT><CODE>?</CODE>
<DD>Disparage slightly the alternative that the <SAMP>`?'</SAMP> appears in,
as a choice when no alternative applies exactly.  The compiler regards
this alternative as one unit more costly for each <SAMP>`?'</SAMP> that appears
in it.
<P>

<A NAME="IDX951"></A>
<A NAME="IDX952"></A>
<DT><CODE>!</CODE>
<DD>Disparage severely the alternative that the <SAMP>`!'</SAMP> appears in.
This alternative can still be used if it fits without reloading,
but if reloading is needed, some other alternative will be used.
</DL>
<P>

When an insn pattern has multiple alternatives in its constraints, often
the appearance of the assembler code is determined mostly by which
alternative was matched.  When this is so, the C code for writing the
assembler code can use the variable <CODE>which_alternative</CODE>, which is
the ordinal number of the alternative that was actually satisfied (0 for
the first, 1 for the second alternative, etc.).  See section <A HREF="gcc_16.html#SEC174" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC174">16.5 C Statements for Assembler Output</A>.
</P><P>

<A NAME="Class Preferences"></A>
<HR SIZE="6">
<A NAME="SEC178"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC177" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC177"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC179" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC179"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC179" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC179"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC175" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC175"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.6.3 Register Class Preferences </H3>
<!--docid::SEC178::-->
<P>

<A NAME="IDX953"></A>
The operand constraints have another function: they enable the compiler
to decide which kind of hardware register a pseudo register is best
allocated to.  The compiler examines the constraints that apply to the
insns that use the pseudo register, looking for the machine-dependent
letters such as <SAMP>`d'</SAMP> and <SAMP>`a'</SAMP> that specify classes of registers.
The pseudo register is put in whichever class gets the most "votes".
The constraint letters <SAMP>`g'</SAMP> and <SAMP>`r'</SAMP> also vote: they vote in
favor of a general register.  The machine description says which registers
are considered general.
</P><P>

Of course, on some machines all registers are equivalent, and no register
classes are defined.  Then none of this complexity is relevant.
</P><P>

<A NAME="Modifiers"></A>
<HR SIZE="6">
<A NAME="SEC179"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC178" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC178"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC180" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC180"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC180" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC180"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC175" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC175"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.6.4 Constraint Modifier Characters </H3>
<!--docid::SEC179::-->
<P>

Here are constraint modifier characters.
</P><P>

<DL COMPACT>
<A NAME="IDX954"></A>
<DT><SAMP>`='</SAMP>
<DD>Means that this operand is write-only for this instruction: the previous
value is discarded and replaced by output data.
<P>

<A NAME="IDX955"></A>
<DT><SAMP>`+'</SAMP>
<DD>Means that this operand is both read and written by the instruction.
<P>

When the compiler fixes up the operands to satisfy the constraints,
it needs to know which operands are inputs to the instruction and
which are outputs from it.  <SAMP>`='</SAMP> identifies an output; <SAMP>`+'</SAMP>
identifies an operand that is both input and output; all other operands
are assumed to be input only.
</P><P>

<A NAME="IDX956"></A>
<A NAME="IDX957"></A>
<DT><SAMP>`&#38;'</SAMP>
<DD>Means (in a particular alternative) that this operand is an
<EM>earlyclobber</EM> operand, which is modified before the instruction is
finished using the input operands.  Therefore, this operand may not lie
in a register that is used as an input operand or as part of any memory
address.
<P>

<SAMP>`&#38;'</SAMP> applies only to the alternative in which it is written.  In
constraints with multiple alternatives, sometimes one alternative
requires <SAMP>`&#38;'</SAMP> while others do not.  See, for example, the
<SAMP>`movdf'</SAMP> insn of the 68000.
</P><P>

An input operand can be tied to an earlyclobber operand if its only 
use as an input occurs before the early result is written.  Adding
alternatives of this form often allows GCC to produce better code
when only some of the inputs can be affected by the earlyclobber. 
See, for example, the <SAMP>`mulsi3'</SAMP> insn of the ARM.
</P><P>

<SAMP>`&#38;'</SAMP> does not obviate the need to write <SAMP>`='</SAMP>.
</P><P>

<A NAME="IDX958"></A>
<DT><SAMP>`%'</SAMP>
<DD>Declares the instruction to be commutative for this operand and the
following operand.  This means that the compiler may interchange the
two operands if that is the cheapest way to make all operands fit the
constraints.
This is often used in patterns for addition instructions
that really have only two operands: the result must go in one of the
arguments.  Here for example, is how the 68000 halfword-add
instruction is defined:
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn "addhi3"
  [(set (match_operand:HI 0 "general_operand" "=m,r")
     (plus:HI (match_operand:HI 1 "general_operand" "%0,0")
              (match_operand:HI 2 "general_operand" "di,g")))]
  <small>...</small>)
</FONT></pre></td></tr></table></P><P>

<A NAME="IDX959"></A>
<DT><SAMP>`#'</SAMP>
<DD>Says that all following characters, up to the next comma, are to be
ignored as a constraint.  They are significant only for choosing
register preferences.
<P>

<A NAME="IDX960"></A>
<DT><SAMP>`*'</SAMP>
<DD>Says that the following character should be ignored when choosing
register preferences.  <SAMP>`*'</SAMP> has no effect on the meaning of the
constraint as a constraint, and no effect on reloading.
<P>

Here is an example: the 68000 has an instruction to sign-extend a
halfword in a data register, and can also sign-extend a value by
copying it into an address register.  While either kind of register is
acceptable, the constraints on an address-register destination are
less strict, so it is best if register allocation makes an address
register its goal.  Therefore, <SAMP>`*'</SAMP> is used so that the <SAMP>`d'</SAMP>
constraint letter (for data register) is ignored when computing
register preferences.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn "extendhisi2"
  [(set (match_operand:SI 0 "general_operand" "=*d,a")
        (sign_extend:SI
         (match_operand:HI 1 "general_operand" "0,g")))]
  <small>...</small>)
</FONT></pre></td></tr></table></DL>
<P>

<A NAME="Machine Constraints"></A>
<HR SIZE="6">
<A NAME="SEC180"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC179" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC179"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC181" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC181"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC181" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC181"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC175" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC175"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.6.5 Constraints for Particular Machines </H3>
<!--docid::SEC180::-->
<P>

Whenever possible, you should use the general-purpose constraint letters
in <CODE>asm</CODE> arguments, since they will convey meaning more readily to
people reading your code.  Failing that, use the constraint letters
that usually have very similar meanings across architectures.  The most
commonly used constraints are <SAMP>`m'</SAMP> and <SAMP>`r'</SAMP> (for memory and
general-purpose registers respectively; see section <A HREF="gcc_16.html#SEC176" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC176">16.6.1 Simple Constraints</A>), and
<SAMP>`I'</SAMP>, usually the letter indicating the most common
immediate-constant format.
</P><P>

For each machine architecture, the <TT>`config/<VAR>machine</VAR>.h'</TT> file
defines additional constraints.  These constraints are used by the
compiler itself for instruction generation, as well as for <CODE>asm</CODE>
statements; therefore, some of the constraints are not particularly
interesting for <CODE>asm</CODE>.  The constraints are defined through these
macros:
</P><P>

<DL COMPACT>
<DT><CODE>REG_CLASS_FROM_LETTER</CODE>
<DD>Register class constraints (usually lower case).
<P>

<DT><CODE>CONST_OK_FOR_LETTER_P</CODE>
<DD>Immediate constant constraints, for non-floating point constants of
word size or smaller precision (usually upper case).
<P>

<DT><CODE>CONST_DOUBLE_OK_FOR_LETTER_P</CODE>
<DD>Immediate constant constraints, for all floating point constants and for
constants of greater than word size precision (usually upper case).
<P>

<DT><CODE>EXTRA_CONSTRAINT</CODE>
<DD>Special cases of registers or memory.  This macro is not required, and
is only defined for some machines.
</DL>
<P>

Inspecting these macro definitions in the compiler source for your
machine is the best way to be certain you have the right constraints.
However, here is a summary of the machine-dependent constraints
available on some particular machines.
</P><P>

<DL COMPACT>
<DT><EM>ARM family---<TT>`arm.h'</TT></EM>
<DD><DL COMPACT>
<DT><CODE>f</CODE>
<DD>Floating-point register
<P>

<DT><CODE>F</CODE>
<DD>One of the floating-point constants 0.0, 0.5, 1.0, 2.0, 3.0, 4.0, 5.0
or 10.0
<P>

<DT><CODE>G</CODE>
<DD>Floating-point constant that would satisfy the constraint <SAMP>`F'</SAMP> if it
were negated
<P>

<DT><CODE>I</CODE>
<DD>Integer that is valid as an immediate operand in a data processing
instruction.  That is, an integer in the range 0 to 255 rotated by a
multiple of 2
<P>

<DT><CODE>J</CODE>
<DD>Integer in the range -4095 to 4095
<P>

<DT><CODE>K</CODE>
<DD>Integer that satisfies constraint <SAMP>`I'</SAMP> when inverted (ones complement)
<P>

<DT><CODE>L</CODE>
<DD>Integer that satisfies constraint <SAMP>`I'</SAMP> when negated (twos complement)
<P>

<DT><CODE>M</CODE>
<DD>Integer in the range 0 to 32
<P>

<DT><CODE>Q</CODE>
<DD>A memory reference where the exact address is in a single register
(`<SAMP>`m'</SAMP>' is preferable for <CODE>asm</CODE> statements)
<P>

<DT><CODE>R</CODE>
<DD>An item in the constant pool
<P>

<DT><CODE>S</CODE>
<DD>A symbol in the text segment of the current file
</DL>
<P>

<DT><EM>AMD 29000 family---<TT>`a29k.h'</TT></EM>
<DD><DL COMPACT>
<DT><CODE>l</CODE>
<DD>Local register 0
<P>

<DT><CODE>b</CODE>
<DD>Byte Pointer (<SAMP>`BP'</SAMP>) register
<P>

<DT><CODE>q</CODE>
<DD><SAMP>`Q'</SAMP> register
<P>

<DT><CODE>h</CODE>
<DD>Special purpose register
<P>

<DT><CODE>A</CODE>
<DD>First accumulator register
<P>

<DT><CODE>a</CODE>
<DD>Other accumulator register
<P>

<DT><CODE>f</CODE>
<DD>Floating point register
<P>

<DT><CODE>I</CODE>
<DD>Constant greater than 0, less than 0x100
<P>

<DT><CODE>J</CODE>
<DD>Constant greater than 0, less than 0x10000
<P>

<DT><CODE>K</CODE>
<DD>Constant whose high 24 bits are on (1)
<P>

<DT><CODE>L</CODE>
<DD>16 bit constant whose high 8 bits are on (1)
<P>

<DT><CODE>M</CODE>
<DD>32 bit constant whose high 16 bits are on (1)
<P>

<DT><CODE>N</CODE>
<DD>32 bit negative constant that fits in 8 bits
<P>

<DT><CODE>O</CODE>
<DD>The constant 0x80000000 or, on the 29050, any 32 bit constant
whose low 16 bits are 0.
<P>

<DT><CODE>P</CODE>
<DD>16 bit negative constant that fits in 8 bits
<P>

<DT><CODE>G</CODE>
<DD><DT><CODE>H</CODE>
<DD>A floating point constant (in <CODE>asm</CODE> statements, use the machine
independent <SAMP>`E'</SAMP> or <SAMP>`F'</SAMP> instead)
</DL>
<P>

<DT><EM>IBM RS6000---<TT>`rs6000.h'</TT></EM>
<DD><DL COMPACT>
<DT><CODE>b</CODE>
<DD>Address base register
<P>

<DT><CODE>f</CODE>
<DD>Floating point register
<P>

<DT><CODE>h</CODE>
<DD><SAMP>`MQ'</SAMP>, <SAMP>`CTR'</SAMP>, or <SAMP>`LINK'</SAMP> register
<P>

<DT><CODE>q</CODE>
<DD><SAMP>`MQ'</SAMP> register
<P>

<DT><CODE>c</CODE>
<DD><SAMP>`CTR'</SAMP> register
<P>

<DT><CODE>l</CODE>
<DD><SAMP>`LINK'</SAMP> register
<P>

<DT><CODE>x</CODE>
<DD><SAMP>`CR'</SAMP> register (condition register) number 0
<P>

<DT><CODE>y</CODE>
<DD><SAMP>`CR'</SAMP> register (condition register)
<P>

<DT><CODE>z</CODE>
<DD><SAMP>`FPMEM'</SAMP> stack memory for FPR-GPR transfers
<P>

<DT><CODE>I</CODE>
<DD>Signed 16 bit constant
<P>

<DT><CODE>J</CODE>
<DD>Constant whose low 16 bits are 0
<P>

<DT><CODE>K</CODE>
<DD>Constant whose high 16 bits are 0
<P>

<DT><CODE>L</CODE>
<DD>Constant suitable as a mask operand
<P>

<DT><CODE>M</CODE>
<DD>Constant larger than 31
<P>

<DT><CODE>N</CODE>
<DD>Exact power of 2
<P>

<DT><CODE>O</CODE>
<DD>Zero
<P>

<DT><CODE>P</CODE>
<DD>Constant whose negation is a signed 16 bit constant
<P>

<DT><CODE>G</CODE>
<DD>Floating point constant that can be loaded into a register with one
instruction per word
<P>

<DT><CODE>Q</CODE>
<DD>Memory operand that is an offset from a register (<SAMP>`m'</SAMP> is preferable
for <CODE>asm</CODE> statements)
<P>

<DT><CODE>R</CODE>
<DD>AIX TOC entry
<P>

<DT><CODE>S</CODE>
<DD>Constant suitable as a 64-bit mask operand
<P>

<DT><CODE>U</CODE>
<DD>System V Release 4 small data area reference
</DL>
<P>

<DT><EM>Intel 386---<TT>`i386.h'</TT></EM>
<DD><DL COMPACT>
<DT><CODE>q</CODE>
<DD><SAMP>`a'</SAMP>, <CODE>b</CODE>, <CODE>c</CODE>, or <CODE>d</CODE> register
<P>

<DT><CODE>A</CODE>
<DD><SAMP>`a'</SAMP>, or <CODE>d</CODE> register (for 64-bit ints)
<P>

<DT><CODE>f</CODE>
<DD>Floating point register
<P>

<DT><CODE>t</CODE>
<DD>First (top of stack) floating point register
<P>

<DT><CODE>u</CODE>
<DD>Second floating point register
<P>

<DT><CODE>a</CODE>
<DD><SAMP>`a'</SAMP> register
<P>

<DT><CODE>b</CODE>
<DD><SAMP>`b'</SAMP> register
<P>

<DT><CODE>c</CODE>
<DD><SAMP>`c'</SAMP> register
<P>

<DT><CODE>d</CODE>
<DD><SAMP>`d'</SAMP> register
<P>

<DT><CODE>D</CODE>
<DD><SAMP>`di'</SAMP> register
<P>

<DT><CODE>S</CODE>
<DD><SAMP>`si'</SAMP> register
<P>

<DT><CODE>I</CODE>
<DD>Constant in range 0 to 31 (for 32 bit shifts)
<P>

<DT><CODE>J</CODE>
<DD>Constant in range 0 to 63 (for 64 bit shifts)
<P>

<DT><CODE>K</CODE>
<DD><SAMP>`0xff'</SAMP>
<P>

<DT><CODE>L</CODE>
<DD><SAMP>`0xffff'</SAMP>
<P>

<DT><CODE>M</CODE>
<DD>0, 1, 2, or 3 (shifts for <CODE>lea</CODE> instruction)
<P>

<DT><CODE>N</CODE>
<DD>Constant in range 0 to 255 (for <CODE>out</CODE> instruction)
<P>

<DT><CODE>G</CODE>
<DD>Standard 80387 floating point constant
</DL>
<P>

<DT><EM>Intel 960---<TT>`i960.h'</TT></EM>
<DD><DL COMPACT>
<DT><CODE>f</CODE>
<DD>Floating point register (<CODE>fp0</CODE> to <CODE>fp3</CODE>)
<P>

<DT><CODE>l</CODE>
<DD>Local register (<CODE>r0</CODE> to <CODE>r15</CODE>)
<P>

<DT><CODE>b</CODE>
<DD>Global register (<CODE>g0</CODE> to <CODE>g15</CODE>)
<P>

<DT><CODE>d</CODE>
<DD>Any local or global register
<P>

<DT><CODE>I</CODE>
<DD>Integers from 0 to 31
<P>

<DT><CODE>J</CODE>
<DD>0
<P>

<DT><CODE>K</CODE>
<DD>Integers from -31 to 0
<P>

<DT><CODE>G</CODE>
<DD>Floating point 0
<P>

<DT><CODE>H</CODE>
<DD>Floating point 1
</DL>
<P>

<DT><EM>MIPS---<TT>`mips.h'</TT></EM>
<DD><DL COMPACT>
<DT><CODE>d</CODE>
<DD>General-purpose integer register
<P>

<DT><CODE>f</CODE>
<DD>Floating-point register (if available)
<P>

<DT><CODE>h</CODE>
<DD><SAMP>`Hi'</SAMP> register
<P>

<DT><CODE>l</CODE>
<DD><SAMP>`Lo'</SAMP> register
<P>

<DT><CODE>x</CODE>
<DD><SAMP>`Hi'</SAMP> or <SAMP>`Lo'</SAMP> register
<P>

<DT><CODE>y</CODE>
<DD>General-purpose integer register
<P>

<DT><CODE>z</CODE>
<DD>Floating-point status register
<P>

<DT><CODE>I</CODE>
<DD>Signed 16 bit constant (for arithmetic instructions)
<P>

<DT><CODE>J</CODE>
<DD>Zero
<P>

<DT><CODE>K</CODE>
<DD>Zero-extended 16-bit constant (for logic instructions)
<P>

<DT><CODE>L</CODE>
<DD>Constant with low 16 bits zero (can be loaded with <CODE>lui</CODE>)
<P>

<DT><CODE>M</CODE>
<DD>32 bit constant which requires two instructions to load (a constant
which is not <SAMP>`I'</SAMP>, <SAMP>`K'</SAMP>, or <SAMP>`L'</SAMP>)
<P>

<DT><CODE>N</CODE>
<DD>Negative 16 bit constant
<P>

<DT><CODE>O</CODE>
<DD>Exact power of two
<P>

<DT><CODE>P</CODE>
<DD>Positive 16 bit constant
<P>

<DT><CODE>G</CODE>
<DD>Floating point zero
<P>

<DT><CODE>Q</CODE>
<DD>Memory reference that can be loaded with more than one instruction
(<SAMP>`m'</SAMP> is preferable for <CODE>asm</CODE> statements)
<P>

<DT><CODE>R</CODE>
<DD>Memory reference that can be loaded with one instruction
(<SAMP>`m'</SAMP> is preferable for <CODE>asm</CODE> statements)
<P>

<DT><CODE>S</CODE>
<DD>Memory reference in external OSF/rose PIC format
(<SAMP>`m'</SAMP> is preferable for <CODE>asm</CODE> statements)
</DL>
<P>

<DT><EM>Motorola 680x0---<TT>`m68k.h'</TT></EM>
<DD><DL COMPACT>
<DT><CODE>a</CODE>
<DD>Address register
<P>

<DT><CODE>d</CODE>
<DD>Data register
<P>

<DT><CODE>f</CODE>
<DD>68881 floating-point register, if available
<P>

<DT><CODE>x</CODE>
<DD>Sun FPA (floating-point) register, if available
<P>

<DT><CODE>y</CODE>
<DD>First 16 Sun FPA registers, if available
<P>

<DT><CODE>I</CODE>
<DD>Integer in the range 1 to 8
<P>

<DT><CODE>J</CODE>
<DD>16 bit signed number
<P>

<DT><CODE>K</CODE>
<DD>Signed number whose magnitude is greater than 0x80
<P>

<DT><CODE>L</CODE>
<DD>Integer in the range -8 to -1
<P>

<DT><CODE>M</CODE>
<DD>Signed number whose magnitude is greater than 0x100
<P>

<DT><CODE>G</CODE>
<DD>Floating point constant that is not a 68881 constant
<P>

<DT><CODE>H</CODE>
<DD>Floating point constant that can be used by Sun FPA
</DL>
<P>

<DT><EM>SPARC---<TT>`sparc.h'</TT></EM>
<DD><DL COMPACT>
<DT><CODE>f</CODE>
<DD>Floating-point register that can hold 32 or 64 bit values.
<P>

<DT><CODE>e</CODE>
<DD>Floating-point register that can hold 64 or 128 bit values.
<P>

<DT><CODE>I</CODE>
<DD>Signed 13 bit constant
<P>

<DT><CODE>J</CODE>
<DD>Zero
<P>

<DT><CODE>K</CODE>
<DD>32 bit constant with the low 12 bits clear (a constant that can be
loaded with the <CODE>sethi</CODE> instruction)
<P>

<DT><CODE>G</CODE>
<DD>Floating-point zero
<P>

<DT><CODE>H</CODE>
<DD>Signed 13 bit constant, sign-extended to 32 or 64 bits
<P>

<DT><CODE>Q</CODE>
<DD>Memory reference that can be loaded with one instruction  (<SAMP>`m'</SAMP> is
more appropriate for <CODE>asm</CODE> statements)
<P>

<DT><CODE>S</CODE>
<DD>Constant, or memory address
<P>

<DT><CODE>T</CODE>
<DD>Memory address aligned to an 8-byte boundary
<P>

<DT><CODE>U</CODE>
<DD>Even register
</DL>
</DL>
<P>

<A NAME="No Constraints"></A>
<HR SIZE="6">
<A NAME="SEC181"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC180" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC180"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC175" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC175"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.6.6 Not Using Constraints </H3>
<!--docid::SEC181::-->
<P>

Some machines are so clean that operand constraints are not required.  For
example, on the Vax, an operand valid in one context is valid in any other
context.  On such a machine, every operand constraint would be <SAMP>`g'</SAMP>,
excepting only operands of "load address" instructions which are
written as if they referred to a memory location's contents but actual
refer to its address.  They would have constraint <SAMP>`p'</SAMP>.
</P><P>

<A NAME="IDX961"></A>
For such machines, instead of writing <SAMP>`g'</SAMP> and <SAMP>`p'</SAMP> for all
the constraints, you can choose to write a description with empty constraints.
Then you write <SAMP>`""'</SAMP> for the constraint in every <CODE>match_operand</CODE>.
Address operands are identified by writing an <CODE>address</CODE> expression
around the <CODE>match_operand</CODE>, not by their constraints.
</P><P>

When the machine description has just empty constraints, certain parts
of compilation are skipped, making the compiler faster.  However,
few machines actually do not need constraints; all machine descriptions
now in existence use constraints.
</P><P>

<A NAME="Standard Names"></A>
<HR SIZE="6">
<A NAME="SEC182"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC181" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC181"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC183" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC183"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC183" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC183"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.7 Standard Pattern Names For Generation </H2>
<!--docid::SEC182::-->
<P>

Here is a table of the instruction names that are meaningful in the RTL
generation pass of the compiler.  Giving one of these names to an
instruction pattern tells the RTL generation pass that it can use the
pattern to accomplish a certain task.
</P><P>

<DL COMPACT>
<A NAME="IDX962"></A>
<DT><SAMP>`mov<VAR>m</VAR>'</SAMP>
<DD>Here <VAR>m</VAR> stands for a two-letter machine mode name, in lower case.
This instruction pattern moves data with that machine mode from operand
1 to operand 0.  For example, <SAMP>`movsi'</SAMP> moves full-word data.
<P>

If operand 0 is a <CODE>subreg</CODE> with mode <VAR>m</VAR> of a register whose
own mode is wider than <VAR>m</VAR>, the effect of this instruction is
to store the specified value in the part of the register that corresponds
to mode <VAR>m</VAR>.  The effect on the rest of the register is undefined.
</P><P>

This class of patterns is special in several ways.  First of all, each
of these names <EM>must</EM> be defined, because there is no other way
to copy a datum from one place to another.
</P><P>

Second, these patterns are not used solely in the RTL generation pass.
Even the reload pass can generate move insns to copy values from stack
slots into temporary registers.  When it does so, one of the operands is
a hard register and the other is an operand that can need to be reloaded
into a register.
</P><P>

<A NAME="IDX963"></A>
Therefore, when given such a pair of operands, the pattern must generate
RTL which needs no reloading and needs no temporary registers--no
registers other than the operands.  For example, if you support the
pattern with a <CODE>define_expand</CODE>, then in such a case the
<CODE>define_expand</CODE> mustn't call <CODE>force_reg</CODE> or any other such
function which might generate new pseudo registers.
</P><P>

This requirement exists even for subword modes on a RISC machine where
fetching those modes from memory normally requires several insns and
some temporary registers.  Look in <TT>`spur.md'</TT> to see how the
requirement can be satisfied.
</P><P>

<A NAME="IDX964"></A>
During reload a memory reference with an invalid address may be passed
as an operand.  Such an address will be replaced with a valid address
later in the reload pass.  In this case, nothing may be done with the
address except to use it as it stands.  If it is copied, it will not be
replaced with a valid address.  No attempt should be made to make such
an address into a valid address and no routine (such as
<CODE>change_address</CODE>) that will do so may be called.  Note that
<CODE>general_operand</CODE> will fail when applied to such an address.
</P><P>

<A NAME="IDX965"></A>
The global variable <CODE>reload_in_progress</CODE> (which must be explicitly
declared if required) can be used to determine whether such special
handling is required.
</P><P>

The variety of operands that have reloads depends on the rest of the
machine description, but typically on a RISC machine these can only be
pseudo registers that did not get hard registers, while on other
machines explicit memory references will get optional reloads.
</P><P>

If a scratch register is required to move an object to or from memory,
it can be allocated using <CODE>gen_reg_rtx</CODE> prior to life analysis.
</P><P>

If there are cases needing
scratch registers after reload, you must define
<CODE>SECONDARY_INPUT_RELOAD_CLASS</CODE> and perhaps also
<CODE>SECONDARY_OUTPUT_RELOAD_CLASS</CODE> to detect them, and provide
patterns <SAMP>`reload_in<VAR>m</VAR>'</SAMP> or <SAMP>`reload_out<VAR>m</VAR>'</SAMP> to handle
them.  See section <A HREF="gcc_17.html#SEC211" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC211">17.6 Register Classes</A>.
</P><P>

<A NAME="IDX966"></A>
The global variable <CODE>no_new_pseudos</CODE> can be used to determine if it
is unsafe to create new pseudo registers.  If this variable is nonzero, then
it is unsafe to call <CODE>gen_reg_rtx</CODE> to allocate a new pseudo.
</P><P>

The constraints on a <SAMP>`mov<VAR>m</VAR>'</SAMP> must permit moving any hard
register to any other hard register provided that
<CODE>HARD_REGNO_MODE_OK</CODE> permits mode <VAR>m</VAR> in both registers and
<CODE>REGISTER_MOVE_COST</CODE> applied to their classes returns a value of 2.
</P><P>

It is obligatory to support floating point <SAMP>`mov<VAR>m</VAR>'</SAMP>
instructions into and out of any registers that can hold fixed point
values, because unions and structures (which have modes <CODE>SImode</CODE> or
<CODE>DImode</CODE>) can be in those registers and they may have floating
point members.
</P><P>

There may also be a need to support fixed point <SAMP>`mov<VAR>m</VAR>'</SAMP>
instructions in and out of floating point registers.  Unfortunately, I
have forgotten why this was so, and I don't know whether it is still
true.  If <CODE>HARD_REGNO_MODE_OK</CODE> rejects fixed point values in
floating point registers, then the constraints of the fixed point
<SAMP>`mov<VAR>m</VAR>'</SAMP> instructions must be designed to avoid ever trying to
reload into a floating point register.
</P><P>

<A NAME="IDX967"></A>
<A NAME="IDX968"></A>
<DT><SAMP>`reload_in<VAR>m</VAR>'</SAMP>
<DD><DT><SAMP>`reload_out<VAR>m</VAR>'</SAMP>
<DD>Like <SAMP>`mov<VAR>m</VAR>'</SAMP>, but used when a scratch register is required to
move between operand 0 and operand 1.  Operand 2 describes the scratch
register.  See the discussion of the <CODE>SECONDARY_RELOAD_CLASS</CODE>
macro in see section <A HREF="gcc_17.html#SEC211" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC211">17.6 Register Classes</A>.
<P>

<A NAME="IDX969"></A>
<DT><SAMP>`movstrict<VAR>m</VAR>'</SAMP>
<DD>Like <SAMP>`mov<VAR>m</VAR>'</SAMP> except that if operand 0 is a <CODE>subreg</CODE>
with mode <VAR>m</VAR> of a register whose natural mode is wider,
the <SAMP>`movstrict<VAR>m</VAR>'</SAMP> instruction is guaranteed not to alter
any of the register except the part which belongs to mode <VAR>m</VAR>.
<P>

<A NAME="IDX970"></A>
<DT><SAMP>`load_multiple'</SAMP>
<DD>Load several consecutive memory locations into consecutive registers.
Operand 0 is the first of the consecutive registers, operand 1
is the first memory location, and operand 2 is a constant: the
number of consecutive registers.
<P>

Define this only if the target machine really has such an instruction;
do not define this if the most efficient way of loading consecutive
registers from memory is to do them one at a time.
</P><P>

On some machines, there are restrictions as to which consecutive
registers can be stored into memory, such as particular starting or
ending register numbers or only a range of valid counts.  For those
machines, use a <CODE>define_expand</CODE> (see section <A HREF="gcc_16.html#SEC188" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC188">16.13 Defining RTL Sequences for Code Generation</A>)
and make the pattern fail if the restrictions are not met.
</P><P>

Write the generated insn as a <CODE>parallel</CODE> with elements being a
<CODE>set</CODE> of one register from the appropriate memory location (you may
also need <CODE>use</CODE> or <CODE>clobber</CODE> elements).  Use a
<CODE>match_parallel</CODE> (see section <A HREF="gcc_16.html#SEC172" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC172">16.3 RTL Template</A>) to recognize the insn.  See
<TT>`a29k.md'</TT> and <TT>`rs6000.md'</TT> for examples of the use of this insn
pattern.
</P><P>

<A NAME="IDX971"></A>
<DT><SAMP>`store_multiple'</SAMP>
<DD>Similar to <SAMP>`load_multiple'</SAMP>, but store several consecutive registers
into consecutive memory locations.  Operand 0 is the first of the
consecutive memory locations, operand 1 is the first register, and
operand 2 is a constant: the number of consecutive registers.
<P>

<A NAME="IDX972"></A>
<DT><SAMP>`add<VAR>m</VAR>3'</SAMP>
<DD>Add operand 2 and operand 1, storing the result in operand 0.  All operands
must have mode <VAR>m</VAR>.  This can be used even on two-address machines, by
means of constraints requiring operands 1 and 0 to be the same location.
<P>

<A NAME="IDX973"></A>
<A NAME="IDX974"></A>
<A NAME="IDX975"></A>
<A NAME="IDX976"></A>
<A NAME="IDX977"></A>
<A NAME="IDX978"></A>
<A NAME="IDX979"></A>
<A NAME="IDX980"></A>
<A NAME="IDX981"></A>
<A NAME="IDX982"></A>
<A NAME="IDX983"></A>
<A NAME="IDX984"></A>
<A NAME="IDX985"></A>
<DT><SAMP>`sub<VAR>m</VAR>3'</SAMP>, <SAMP>`mul<VAR>m</VAR>3'</SAMP>
<DD><DT><SAMP>`div<VAR>m</VAR>3'</SAMP>, <SAMP>`udiv<VAR>m</VAR>3'</SAMP>, <SAMP>`mod<VAR>m</VAR>3'</SAMP>, <SAMP>`umod<VAR>m</VAR>3'</SAMP>
<DD><DT><SAMP>`smin<VAR>m</VAR>3'</SAMP>, <SAMP>`smax<VAR>m</VAR>3'</SAMP>, <SAMP>`umin<VAR>m</VAR>3'</SAMP>, <SAMP>`umax<VAR>m</VAR>3'</SAMP>
<DD><DT><SAMP>`and<VAR>m</VAR>3'</SAMP>, <SAMP>`ior<VAR>m</VAR>3'</SAMP>, <SAMP>`xor<VAR>m</VAR>3'</SAMP>
<DD>Similar, for other arithmetic operations.
<P>

<A NAME="IDX986"></A>
<DT><SAMP>`mulhisi3'</SAMP>
<DD>Multiply operands 1 and 2, which have mode <CODE>HImode</CODE>, and store
a <CODE>SImode</CODE> product in operand 0.
<P>

<A NAME="IDX987"></A>
<A NAME="IDX988"></A>
<DT><SAMP>`mulqihi3'</SAMP>, <SAMP>`mulsidi3'</SAMP>
<DD>Similar widening-multiplication instructions of other widths.
<P>

<A NAME="IDX989"></A>
<A NAME="IDX990"></A>
<A NAME="IDX991"></A>
<DT><SAMP>`umulqihi3'</SAMP>, <SAMP>`umulhisi3'</SAMP>, <SAMP>`umulsidi3'</SAMP>
<DD>Similar widening-multiplication instructions that do unsigned
multiplication.
<P>

<A NAME="IDX992"></A>
<DT><SAMP>`mul<VAR>m</VAR>3_highpart'</SAMP>
<DD>Perform a signed multiplication of operands 1 and 2, which have mode
<VAR>m</VAR>, and store the most significant half of the product in operand 0.
The least significant half of the product is discarded.
<P>

<A NAME="IDX993"></A>
<DT><SAMP>`umul<VAR>m</VAR>3_highpart'</SAMP>
<DD>Similar, but the multiplication is unsigned.
<P>

<A NAME="IDX994"></A>
<DT><SAMP>`divmod<VAR>m</VAR>4'</SAMP>
<DD>Signed division that produces both a quotient and a remainder.
Operand 1 is divided by operand 2 to produce a quotient stored
in operand 0 and a remainder stored in operand 3.
<P>

For machines with an instruction that produces both a quotient and a
remainder, provide a pattern for <SAMP>`divmod<VAR>m</VAR>4'</SAMP> but do not
provide patterns for <SAMP>`div<VAR>m</VAR>3'</SAMP> and <SAMP>`mod<VAR>m</VAR>3'</SAMP>.  This
allows optimization in the relatively common case when both the quotient
and remainder are computed.
</P><P>

If an instruction that just produces a quotient or just a remainder
exists and is more efficient than the instruction that produces both,
write the output routine of <SAMP>`divmod<VAR>m</VAR>4'</SAMP> to call
<CODE>find_reg_note</CODE> and look for a <CODE>REG_UNUSED</CODE> note on the
quotient or remainder and generate the appropriate instruction.
</P><P>

<A NAME="IDX995"></A>
<DT><SAMP>`udivmod<VAR>m</VAR>4'</SAMP>
<DD>Similar, but does unsigned division.
<P>

<A NAME="IDX996"></A>
<DT><SAMP>`ashl<VAR>m</VAR>3'</SAMP>
<DD>Arithmetic-shift operand 1 left by a number of bits specified by operand
2, and store the result in operand 0.  Here <VAR>m</VAR> is the mode of
operand 0 and operand 1; operand 2's mode is specified by the
instruction pattern, and the compiler will convert the operand to that
mode before generating the instruction.
<P>

<A NAME="IDX997"></A>
<A NAME="IDX998"></A>
<A NAME="IDX999"></A>
<A NAME="IDX1000"></A>
<DT><SAMP>`ashr<VAR>m</VAR>3'</SAMP>, <SAMP>`lshr<VAR>m</VAR>3'</SAMP>, <SAMP>`rotl<VAR>m</VAR>3'</SAMP>, <SAMP>`rotr<VAR>m</VAR>3'</SAMP>
<DD>Other shift and rotate instructions, analogous to the
<CODE>ashl<VAR>m</VAR>3</CODE> instructions.
<P>

<A NAME="IDX1001"></A>
<DT><SAMP>`neg<VAR>m</VAR>2'</SAMP>
<DD>Negate operand 1 and store the result in operand 0.
<P>

<A NAME="IDX1002"></A>
<DT><SAMP>`abs<VAR>m</VAR>2'</SAMP>
<DD>Store the absolute value of operand 1 into operand 0.
<P>

<A NAME="IDX1003"></A>
<DT><SAMP>`sqrt<VAR>m</VAR>2'</SAMP>
<DD>Store the square root of operand 1 into operand 0.
<P>

The <CODE>sqrt</CODE> built-in function of C always uses the mode which
corresponds to the C data type <CODE>double</CODE>.
</P><P>

<A NAME="IDX1004"></A>
<DT><SAMP>`ffs<VAR>m</VAR>2'</SAMP>
<DD>Store into operand 0 one plus the index of the least significant 1-bit
of operand 1.  If operand 1 is zero, store zero.  <VAR>m</VAR> is the mode
of operand 0; operand 1's mode is specified by the instruction
pattern, and the compiler will convert the operand to that mode before
generating the instruction.
<P>

The <CODE>ffs</CODE> built-in function of C always uses the mode which
corresponds to the C data type <CODE>int</CODE>.
</P><P>

<A NAME="IDX1005"></A>
<DT><SAMP>`one_cmpl<VAR>m</VAR>2'</SAMP>
<DD>Store the bitwise-complement of operand 1 into operand 0.
<P>

<A NAME="IDX1006"></A>
<DT><SAMP>`cmp<VAR>m</VAR>'</SAMP>
<DD>Compare operand 0 and operand 1, and set the condition codes.
The RTL pattern should look like this:
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(set (cc0) (compare (match_operand:<VAR>m</VAR> 0 <small>...</small>)
                    (match_operand:<VAR>m</VAR> 1 <small>...</small>)))
</FONT></pre></td></tr></table></P><P>

<A NAME="IDX1007"></A>
<DT><SAMP>`tst<VAR>m</VAR>'</SAMP>
<DD>Compare operand 0 against zero, and set the condition codes.
The RTL pattern should look like this:
<P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(set (cc0) (match_operand:<VAR>m</VAR> 0 <small>...</small>))
</FONT></pre></td></tr></table></P><P>

<SAMP>`tst<VAR>m</VAR>'</SAMP> patterns should not be defined for machines that do
not use <CODE>(cc0)</CODE>.  Doing so would confuse the optimizer since it
would no longer be clear which <CODE>set</CODE> operations were comparisons.
The <SAMP>`cmp<VAR>m</VAR>'</SAMP> patterns should be used instead.
</P><P>

<A NAME="IDX1008"></A>
<DT><SAMP>`movstr<VAR>m</VAR>'</SAMP>
<DD>Block move instruction.  The addresses of the destination and source
strings are the first two operands, and both are in mode <CODE>Pmode</CODE>.
<P>

The number of bytes to move is the third operand, in mode <VAR>m</VAR>.
Usually, you specify <CODE>word_mode</CODE> for <VAR>m</VAR>.  However, if you can
generate better code knowing the range of valid lengths is smaller than
those representable in a full word, you should provide a pattern with a
mode corresponding to the range of values you can handle efficiently
(e.g., <CODE>QImode</CODE> for values in the range 0--127; note we avoid numbers
that appear negative) and also a pattern with <CODE>word_mode</CODE>.
</P><P>

The fourth operand is the known shared alignment of the source and
destination, in the form of a <CODE>const_int</CODE> rtx.  Thus, if the
compiler knows that both source and destination are word-aligned,
it may provide the value 4 for this operand.
</P><P>

Descriptions of multiple <CODE>movstr<VAR>m</VAR></CODE> patterns can only be
beneficial if the patterns for smaller modes have fewer restrictions
on their first, second and fourth operands.  Note that the mode <VAR>m</VAR>
in <CODE>movstr<VAR>m</VAR></CODE> does not impose any restriction on the mode of
individually moved data units in the block.
</P><P>

These patterns need not give special consideration to the possibility
that the source and destination strings might overlap.
</P><P>

<A NAME="IDX1009"></A>
<DT><SAMP>`clrstr<VAR>m</VAR>'</SAMP>
<DD>Block clear instruction.  The addresses of the destination string is the
first operand, in mode <CODE>Pmode</CODE>.  The number of bytes to clear is
the second operand, in mode <VAR>m</VAR>.  See <SAMP>`movstr<VAR>m</VAR>'</SAMP> for
a discussion of the choice of mode.
<P>

The third operand is the known alignment of the destination, in the form
of a <CODE>const_int</CODE> rtx.  Thus, if the compiler knows that the
destination is word-aligned, it may provide the value 4 for this
operand.
</P><P>

The use for multiple <CODE>clrstr<VAR>m</VAR></CODE> is as for <CODE>movstr<VAR>m</VAR></CODE>.
</P><P>

<A NAME="IDX1010"></A>
<DT><SAMP>`cmpstr<VAR>m</VAR>'</SAMP>
<DD>Block compare instruction, with five operands.  Operand 0 is the output;
it has mode <VAR>m</VAR>.  The remaining four operands are like the operands
of <SAMP>`movstr<VAR>m</VAR>'</SAMP>.  The two memory blocks specified are compared
byte by byte in lexicographic order.  The effect of the instruction is
to store a value in operand 0 whose sign indicates the result of the
comparison.
<P>

<A NAME="IDX1011"></A>
<DT><SAMP>`strlen<VAR>m</VAR>'</SAMP>
<DD>Compute the length of a string, with three operands.
Operand 0 is the result (of mode <VAR>m</VAR>), operand 1 is
a <CODE>mem</CODE> referring to the first character of the string,
operand 2 is the character to search for (normally zero),
and operand 3 is a constant describing the known alignment
of the beginning of the string.
<P>

<A NAME="IDX1012"></A>
<DT><SAMP>`float<VAR>m</VAR><VAR>n</VAR>2'</SAMP>
<DD>Convert signed integer operand 1 (valid for fixed point mode <VAR>m</VAR>) to
floating point mode <VAR>n</VAR> and store in operand 0 (which has mode
<VAR>n</VAR>).
<P>

<A NAME="IDX1013"></A>
<DT><SAMP>`floatuns<VAR>m</VAR><VAR>n</VAR>2'</SAMP>
<DD>Convert unsigned integer operand 1 (valid for fixed point mode <VAR>m</VAR>)
to floating point mode <VAR>n</VAR> and store in operand 0 (which has mode
<VAR>n</VAR>).
<P>

<A NAME="IDX1014"></A>
<DT><SAMP>`fix<VAR>m</VAR><VAR>n</VAR>2'</SAMP>
<DD>Convert operand 1 (valid for floating point mode <VAR>m</VAR>) to fixed
point mode <VAR>n</VAR> as a signed number and store in operand 0 (which
has mode <VAR>n</VAR>).  This instruction's result is defined only when
the value of operand 1 is an integer.
<P>

<A NAME="IDX1015"></A>
<DT><SAMP>`fixuns<VAR>m</VAR><VAR>n</VAR>2'</SAMP>
<DD>Convert operand 1 (valid for floating point mode <VAR>m</VAR>) to fixed
point mode <VAR>n</VAR> as an unsigned number and store in operand 0 (which
has mode <VAR>n</VAR>).  This instruction's result is defined only when the
value of operand 1 is an integer.
<P>

<A NAME="IDX1016"></A>
<DT><SAMP>`ftrunc<VAR>m</VAR>2'</SAMP>
<DD>Convert operand 1 (valid for floating point mode <VAR>m</VAR>) to an
integer value, still represented in floating point mode <VAR>m</VAR>, and
store it in operand 0 (valid for floating point mode <VAR>m</VAR>).
<P>

<A NAME="IDX1017"></A>
<DT><SAMP>`fix_trunc<VAR>m</VAR><VAR>n</VAR>2'</SAMP>
<DD>Like <SAMP>`fix<VAR>m</VAR><VAR>n</VAR>2'</SAMP> but works for any floating point value
of mode <VAR>m</VAR> by converting the value to an integer.
<P>

<A NAME="IDX1018"></A>
<DT><SAMP>`fixuns_trunc<VAR>m</VAR><VAR>n</VAR>2'</SAMP>
<DD>Like <SAMP>`fixuns<VAR>m</VAR><VAR>n</VAR>2'</SAMP> but works for any floating point
value of mode <VAR>m</VAR> by converting the value to an integer.
<P>

<A NAME="IDX1019"></A>
<DT><SAMP>`trunc<VAR>m</VAR><VAR>n</VAR>2'</SAMP>
<DD>Truncate operand 1 (valid for mode <VAR>m</VAR>) to mode <VAR>n</VAR> and
store in operand 0 (which has mode <VAR>n</VAR>).  Both modes must be fixed
point or both floating point.
<P>

<A NAME="IDX1020"></A>
<DT><SAMP>`extend<VAR>m</VAR><VAR>n</VAR>2'</SAMP>
<DD>Sign-extend operand 1 (valid for mode <VAR>m</VAR>) to mode <VAR>n</VAR> and
store in operand 0 (which has mode <VAR>n</VAR>).  Both modes must be fixed
point or both floating point.
<P>

<A NAME="IDX1021"></A>
<DT><SAMP>`zero_extend<VAR>m</VAR><VAR>n</VAR>2'</SAMP>
<DD>Zero-extend operand 1 (valid for mode <VAR>m</VAR>) to mode <VAR>n</VAR> and
store in operand 0 (which has mode <VAR>n</VAR>).  Both modes must be fixed
point.
<P>

<A NAME="IDX1022"></A>
<DT><SAMP>`extv'</SAMP>
<DD>Extract a bit field from operand 1 (a register or memory operand), where
operand 2 specifies the width in bits and operand 3 the starting bit,
and store it in operand 0.  Operand 0 must have mode <CODE>word_mode</CODE>.
Operand 1 may have mode <CODE>byte_mode</CODE> or <CODE>word_mode</CODE>; often
<CODE>word_mode</CODE> is allowed only for registers.  Operands 2 and 3 must
be valid for <CODE>word_mode</CODE>.
<P>

The RTL generation pass generates this instruction only with constants
for operands 2 and 3.
</P><P>

The bit-field value is sign-extended to a full word integer
before it is stored in operand 0.
</P><P>

<A NAME="IDX1023"></A>
<DT><SAMP>`extzv'</SAMP>
<DD>Like <SAMP>`extv'</SAMP> except that the bit-field value is zero-extended.
<P>

<A NAME="IDX1024"></A>
<DT><SAMP>`insv'</SAMP>
<DD>Store operand 3 (which must be valid for <CODE>word_mode</CODE>) into a bit
field in operand 0, where operand 1 specifies the width in bits and
operand 2 the starting bit.  Operand 0 may have mode <CODE>byte_mode</CODE> or
<CODE>word_mode</CODE>; often <CODE>word_mode</CODE> is allowed only for registers.
Operands 1 and 2 must be valid for <CODE>word_mode</CODE>.
<P>

The RTL generation pass generates this instruction only with constants
for operands 1 and 2.
</P><P>

<A NAME="IDX1025"></A>
<DT><SAMP>`mov<VAR>mode</VAR>cc'</SAMP>
<DD>Conditionally move operand 2 or operand 3 into operand 0 according to the
comparison in operand 1.  If the comparison is true, operand 2 is moved
into operand 0, otherwise operand 3 is moved.
<P>

The mode of the operands being compared need not be the same as the operands
being moved.  Some machines, sparc64 for example, have instructions that
conditionally move an integer value based on the floating point condition
codes and vice versa.
</P><P>

If the machine does not have conditional move instructions, do not
define these patterns.
</P><P>

<A NAME="IDX1026"></A>
<DT><SAMP>`s<VAR>cond</VAR>'</SAMP>
<DD>Store zero or nonzero in the operand according to the condition codes.
Value stored is nonzero iff the condition <VAR>cond</VAR> is true.
<VAR>cond</VAR> is the name of a comparison operation expression code, such
as <CODE>eq</CODE>, <CODE>lt</CODE> or <CODE>leu</CODE>.
<P>

You specify the mode that the operand must have when you write the
<CODE>match_operand</CODE> expression.  The compiler automatically sees
which mode you have used and supplies an operand of that mode.
</P><P>

The value stored for a true condition must have 1 as its low bit, or
else must be negative.  Otherwise the instruction is not suitable and
you should omit it from the machine description.  You describe to the
compiler exactly which value is stored by defining the macro
<CODE>STORE_FLAG_VALUE</CODE> (see section <A HREF="gcc_17.html#SEC250" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC250">17.19 Miscellaneous Parameters</A>).  If a description cannot be
found that can be used for all the <SAMP>`s<VAR>cond</VAR>'</SAMP> patterns, you
should omit those operations from the machine description.
</P><P>

These operations may fail, but should do so only in relatively
uncommon cases; if they would fail for common cases involving
integer comparisons, it is best to omit these patterns.
</P><P>

If these operations are omitted, the compiler will usually generate code
that copies the constant one to the target and branches around an
assignment of zero to the target.  If this code is more efficient than
the potential instructions used for the <SAMP>`s<VAR>cond</VAR>'</SAMP> pattern
followed by those required to convert the result into a 1 or a zero in
<CODE>SImode</CODE>, you should omit the <SAMP>`s<VAR>cond</VAR>'</SAMP> operations from
the machine description.
</P><P>

<A NAME="IDX1027"></A>
<DT><SAMP>`b<VAR>cond</VAR>'</SAMP>
<DD>Conditional branch instruction.  Operand 0 is a <CODE>label_ref</CODE> that
refers to the label to jump to.  Jump if the condition codes meet
condition <VAR>cond</VAR>.
<P>

Some machines do not follow the model assumed here where a comparison
instruction is followed by a conditional branch instruction.  In that
case, the <SAMP>`cmp<VAR>m</VAR>'</SAMP> (and <SAMP>`tst<VAR>m</VAR>'</SAMP>) patterns should
simply store the operands away and generate all the required insns in a
<CODE>define_expand</CODE> (see section <A HREF="gcc_16.html#SEC188" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC188">16.13 Defining RTL Sequences for Code Generation</A>) for the conditional
branch operations.  All calls to expand <SAMP>`b<VAR>cond</VAR>'</SAMP> patterns are
immediately preceded by calls to expand either a <SAMP>`cmp<VAR>m</VAR>'</SAMP>
pattern or a <SAMP>`tst<VAR>m</VAR>'</SAMP> pattern.
</P><P>

Machines that use a pseudo register for the condition code value, or
where the mode used for the comparison depends on the condition being
tested, should also use the above mechanism.  See section <A HREF="gcc_16.html#SEC185" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC185">16.10 Defining Jump Instruction Patterns</A>.
</P><P>

The above discussion also applies to the <SAMP>`mov<VAR>mode</VAR>cc'</SAMP> and
<SAMP>`s<VAR>cond</VAR>'</SAMP> patterns.
</P><P>

<A NAME="IDX1028"></A>
<DT><SAMP>`call'</SAMP>
<DD>Subroutine call instruction returning no value.  Operand 0 is the
function to call; operand 1 is the number of bytes of arguments pushed
as a <CODE>const_int</CODE>; operand 2 is the number of registers used as
operands.
<P>

On most machines, operand 2 is not actually stored into the RTL
pattern.  It is supplied for the sake of some RISC machines which need
to put this information into the assembler code; they can put it in
the RTL instead of operand 1.
</P><P>

Operand 0 should be a <CODE>mem</CODE> RTX whose address is the address of the
function.  Note, however, that this address can be a <CODE>symbol_ref</CODE>
expression even if it would not be a legitimate memory address on the
target machine.  If it is also not a valid argument for a call
instruction, the pattern for this operation should be a
<CODE>define_expand</CODE> (see section <A HREF="gcc_16.html#SEC188" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC188">16.13 Defining RTL Sequences for Code Generation</A>) that places the
address into a register and uses that register in the call instruction.
</P><P>

<A NAME="IDX1029"></A>
<DT><SAMP>`call_value'</SAMP>
<DD>Subroutine call instruction returning a value.  Operand 0 is the hard
register in which the value is returned.  There are three more
operands, the same as the three operands of the <SAMP>`call'</SAMP>
instruction (but with numbers increased by one).
<P>

Subroutines that return <CODE>BLKmode</CODE> objects use the <SAMP>`call'</SAMP>
insn.
</P><P>

<A NAME="IDX1030"></A>
<A NAME="IDX1031"></A>
<DT><SAMP>`call_pop'</SAMP>, <SAMP>`call_value_pop'</SAMP>
<DD>Similar to <SAMP>`call'</SAMP> and <SAMP>`call_value'</SAMP>, except used if defined and
if <CODE>RETURN_POPS_ARGS</CODE> is non-zero.  They should emit a <CODE>parallel</CODE>
that contains both the function call and a <CODE>set</CODE> to indicate the
adjustment made to the frame pointer.
<P>

For machines where <CODE>RETURN_POPS_ARGS</CODE> can be non-zero, the use of these
patterns increases the number of functions for which the frame pointer
can be eliminated, if desired.
</P><P>

<A NAME="IDX1032"></A>
<DT><SAMP>`untyped_call'</SAMP>
<DD>Subroutine call instruction returning a value of any type.  Operand 0 is
the function to call; operand 1 is a memory location where the result of
calling the function is to be stored; operand 2 is a <CODE>parallel</CODE>
expression where each element is a <CODE>set</CODE> expression that indicates
the saving of a function return value into the result block.
<P>

This instruction pattern should be defined to support
<CODE>__builtin_apply</CODE> on machines where special instructions are needed
to call a subroutine with arbitrary arguments or to save the value
returned.  This instruction pattern is required on machines that have
multiple registers that can hold a return value (i.e.
<CODE>FUNCTION_VALUE_REGNO_P</CODE> is true for more than one register).
</P><P>

<A NAME="IDX1033"></A>
<DT><SAMP>`return'</SAMP>
<DD>Subroutine return instruction.  This instruction pattern name should be
defined only if a single instruction can do all the work of returning
from a function.
<P>

Like the <SAMP>`mov<VAR>m</VAR>'</SAMP> patterns, this pattern is also used after the
RTL generation phase.  In this case it is to support machines where
multiple instructions are usually needed to return from a function, but
some class of functions only requires one instruction to implement a
return.  Normally, the applicable functions are those which do not need
to save any registers or allocate stack space.
</P><P>

<A NAME="IDX1034"></A>
<A NAME="IDX1035"></A>
For such machines, the condition specified in this pattern should only
be true when <CODE>reload_completed</CODE> is non-zero and the function's
epilogue would only be a single instruction.  For machines with register
windows, the routine <CODE>leaf_function_p</CODE> may be used to determine if
a register window push is required.
</P><P>

Machines that have conditional return instructions should define patterns
such as
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn ""
  [(set (pc)
        (if_then_else (match_operator
                         0 "comparison_operator"
                         [(cc0) (const_int 0)])
                      (return)
                      (pc)))]
  "<VAR>condition</VAR>"
  "<small>...</small>")
</FONT></pre></td></tr></table></P><P>

where <VAR>condition</VAR> would normally be the same condition specified on the
named <SAMP>`return'</SAMP> pattern.
</P><P>

<A NAME="IDX1036"></A>
<DT><SAMP>`untyped_return'</SAMP>
<DD>Untyped subroutine return instruction.  This instruction pattern should
be defined to support <CODE>__builtin_return</CODE> on machines where special
instructions are needed to return a value of any type.
<P>

Operand 0 is a memory location where the result of calling a function
with <CODE>__builtin_apply</CODE> is stored; operand 1 is a <CODE>parallel</CODE>
expression where each element is a <CODE>set</CODE> expression that indicates
the restoring of a function return value from the result block.
</P><P>

<A NAME="IDX1037"></A>
<DT><SAMP>`nop'</SAMP>
<DD>No-op instruction.  This instruction pattern name should always be defined
to output a no-op in assembler code.  <CODE>(const_int 0)</CODE> will do as an
RTL pattern.
<P>

<A NAME="IDX1038"></A>
<DT><SAMP>`indirect_jump'</SAMP>
<DD>An instruction to jump to an address which is operand zero.
This pattern name is mandatory on all machines.
<P>

<A NAME="IDX1039"></A>
<DT><SAMP>`casesi'</SAMP>
<DD>Instruction to jump through a dispatch table, including bounds checking.
This instruction takes five operands:
<P>

<OL>
<LI>
The index to dispatch on, which has mode <CODE>SImode</CODE>.
<P>

<LI>
The lower bound for indices in the table, an integer constant.
<P>

<LI>
The total range of indices in the table--the largest index
minus the smallest one (both inclusive).
<P>

<LI>
A label that precedes the table itself.
<P>

<LI>
A label to jump to if the index has a value outside the bounds.
(If the machine-description macro <CODE>CASE_DROPS_THROUGH</CODE> is defined,
then an out-of-bounds index drops through to the code following
the jump table instead of jumping to this label.  In that case,
this label is not actually used by the <SAMP>`casesi'</SAMP> instruction,
but it is always provided as an operand.)
</OL>
<P>

The table is a <CODE>addr_vec</CODE> or <CODE>addr_diff_vec</CODE> inside of a
<CODE>jump_insn</CODE>.  The number of elements in the table is one plus the
difference between the upper bound and the lower bound.
</P><P>

<A NAME="IDX1040"></A>
<DT><SAMP>`tablejump'</SAMP>
<DD>Instruction to jump to a variable address.  This is a low-level
capability which can be used to implement a dispatch table when there
is no <SAMP>`casesi'</SAMP> pattern.
<P>

This pattern requires two operands: the address or offset, and a label
which should immediately precede the jump table.  If the macro
<CODE>CASE_VECTOR_PC_RELATIVE</CODE> evaluates to a nonzero value then the first
operand is an offset which counts from the address of the table; otherwise,
it is an absolute address to jump to.  In either case, the first operand has
mode <CODE>Pmode</CODE>.
</P><P>

The <SAMP>`tablejump'</SAMP> insn is always the last insn before the jump
table it uses.  Its assembler code normally has no need to use the
second operand, but you should incorporate it in the RTL pattern so
that the jump optimizer will not delete the table as unreachable code.
</P><P>

<A NAME="IDX1041"></A>
<DT><SAMP>`canonicalize_funcptr_for_compare'</SAMP>
<DD>Canonicalize the function pointer in operand 1 and store the result
into operand 0.
<P>

Operand 0 is always a <CODE>reg</CODE> and has mode <CODE>Pmode</CODE>; operand 1
may be a <CODE>reg</CODE>, <CODE>mem</CODE>, <CODE>symbol_ref</CODE>, <CODE>const_int</CODE>, etc
and also has mode <CODE>Pmode</CODE>.
</P><P>

Canonicalization of a function pointer usually involves computing
the address of the function which would be called if the function
pointer were used in an indirect call.
</P><P>

Only define this pattern if function pointers on the target machine
can have different values but still call the same function when
used in an indirect call.
</P><P>

<A NAME="IDX1042"></A>
<A NAME="IDX1043"></A>
<A NAME="IDX1044"></A>
<A NAME="IDX1045"></A>
<A NAME="IDX1046"></A>
<A NAME="IDX1047"></A>
<DT><SAMP>`save_stack_block'</SAMP>
<DD><DT><SAMP>`save_stack_function'</SAMP>
<DD><DT><SAMP>`save_stack_nonlocal'</SAMP>
<DD><DT><SAMP>`restore_stack_block'</SAMP>
<DD><DT><SAMP>`restore_stack_function'</SAMP>
<DD><DT><SAMP>`restore_stack_nonlocal'</SAMP>
<DD>Most machines save and restore the stack pointer by copying it to or
from an object of mode <CODE>Pmode</CODE>.  Do not define these patterns on
such machines.
<P>

Some machines require special handling for stack pointer saves and
restores.  On those machines, define the patterns corresponding to the
non-standard cases by using a <CODE>define_expand</CODE> (see section <A HREF="gcc_16.html#SEC188" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC188">16.13 Defining RTL Sequences for Code Generation</A>) that produces the required insns.  The three types of
saves and restores are:
</P><P>

<OL>
<LI>
<SAMP>`save_stack_block'</SAMP> saves the stack pointer at the start of a block
that allocates a variable-sized object, and <SAMP>`restore_stack_block'</SAMP>
restores the stack pointer when the block is exited.
<P>

<LI>
<SAMP>`save_stack_function'</SAMP> and <SAMP>`restore_stack_function'</SAMP> do a
similar job for the outermost block of a function and are used when the
function allocates variable-sized objects or calls <CODE>alloca</CODE>.  Only
the epilogue uses the restored stack pointer, allowing a simpler save or
restore sequence on some machines.
<P>

<LI>
<SAMP>`save_stack_nonlocal'</SAMP> is used in functions that contain labels
branched to by nested functions.  It saves the stack pointer in such a
way that the inner function can use <SAMP>`restore_stack_nonlocal'</SAMP> to
restore the stack pointer.  The compiler generates code to restore the
frame and argument pointer registers, but some machines require saving
and restoring additional data such as register window information or
stack backchains.  Place insns in these patterns to save and restore any
such required data.
</OL>
<P>

When saving the stack pointer, operand 0 is the save area and operand 1
is the stack pointer.  The mode used to allocate the save area defaults
to <CODE>Pmode</CODE> but you can override that choice by defining the
<CODE>STACK_SAVEAREA_MODE</CODE> macro (see section <A HREF="gcc_17.html#SEC202" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC202">17.3 Storage Layout</A>).  You must
specify an integral mode, or <CODE>VOIDmode</CODE> if no save area is needed
for a particular type of save (either because no save is needed or
because a machine-specific save area can be used).  Operand 0 is the
stack pointer and operand 1 is the save area for restore operations.  If
<SAMP>`save_stack_block'</SAMP> is defined, operand 0 must not be
<CODE>VOIDmode</CODE> since these saves can be arbitrarily nested.
</P><P>

A save area is a <CODE>mem</CODE> that is at a constant offset from
<CODE>virtual_stack_vars_rtx</CODE> when the stack pointer is saved for use by
nonlocal gotos and a <CODE>reg</CODE> in the other two cases.
</P><P>

<A NAME="IDX1048"></A>
<DT><SAMP>`allocate_stack'</SAMP>
<DD>Subtract (or add if <CODE>STACK_GROWS_DOWNWARD</CODE> is undefined) operand 1 from
the stack pointer to create space for dynamically allocated data.
<P>

Store the resultant pointer to this space into operand 0.  If you
are allocating space from the main stack, do this by emitting a
move insn to copy <CODE>virtual_stack_dynamic_rtx</CODE> to operand 0.
If you are allocating the space elsewhere, generate code to copy the
location of the space to operand 0.  In the latter case, you must
ensure this space gets freed when the corresponding space on the main
stack is free.
</P><P>

Do not define this pattern if all that must be done is the subtraction.
Some machines require other operations such as stack probes or
maintaining the back chain.  Define this pattern to emit those
operations in addition to updating the stack pointer.
</P><P>

<A NAME="IDX1049"></A>
<DT><SAMP>`probe'</SAMP>
<DD>Some machines require instructions to be executed after space is
allocated from the stack, for example to generate a reference at
the bottom of the stack.
<P>

If you need to emit instructions before the stack has been adjusted,
put them into the <SAMP>`allocate_stack'</SAMP> pattern.  Otherwise, define
this pattern to emit the required instructions.
</P><P>

No operands are provided.
</P><P>

<A NAME="IDX1050"></A>
<DT><SAMP>`check_stack'</SAMP>
<DD>If stack checking cannot be done on your system by probing the stack with
a load or store instruction (see section <A HREF="gcc_17.html#SEC214" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC214">17.7.2 Specifying How Stack Checking is Done</A>), define this pattern
to perform the needed check and signaling an error if the stack
has overflowed.  The single operand is the location in the stack furthest
from the current stack pointer that you need to validate.  Normally,
on machines where this pattern is needed, you would obtain the stack
limit from a global or thread-specific variable or register.
<P>

<A NAME="IDX1051"></A>
<DT><SAMP>`nonlocal_goto'</SAMP>
<DD>Emit code to generate a non-local goto, e.g., a jump from one function
to a label in an outer function.  This pattern has four arguments,
each representing a value to be used in the jump.  The first
argument is to be loaded into the frame pointer, the second is
the address to branch to (code to dispatch to the actual label),
the third is the address of a location where the stack is saved,
and the last is the address of the label, to be placed in the
location for the incoming static chain.
<P>

On most machines you need not define this pattern, since GNU CC will
already generate the correct code, which is to load the frame pointer
and static chain, restore the stack (using the
<SAMP>`restore_stack_nonlocal'</SAMP> pattern, if defined), and jump indirectly
to the dispatcher.  You need only define this pattern if this code will
not work on your machine.
</P><P>

<A NAME="IDX1052"></A>
<DT><SAMP>`nonlocal_goto_receiver'</SAMP>
<DD>This pattern, if defined, contains code needed at the target of a
nonlocal goto after the code already generated by GNU CC.  You will not
normally need to define this pattern.  A typical reason why you might
need this pattern is if some value, such as a pointer to a global table,
must be restored when the frame pointer is restored.  Note that a nonlocal
goto only ocurrs within a unit-of-translation, so a global table pointer
that is shared by all functions of a given module need not be restored.
There are no arguments.
<P>

<A NAME="IDX1053"></A>
<DT><SAMP>`exception_receiver'</SAMP>
<DD>This pattern, if defined, contains code needed at the site of an
exception handler that isn't needed at the site of a nonlocal goto.  You
will not normally need to define this pattern.  A typical reason why you
might need this pattern is if some value, such as a pointer to a global
table, must be restored after control flow is branched to the handler of
an exception.  There are no arguments.
<P>

<A NAME="IDX1054"></A>
<DT><SAMP>`builtin_setjmp_setup'</SAMP>
<DD>This pattern, if defined, contains additional code needed to initialize
the <CODE>jmp_buf</CODE>.  You will not normally need to define this pattern.
A typical reason why you might need this pattern is if some value, such
as a pointer to a global table, must be restored.  Though it is
preferred that the pointer value be recalculated if possible (given the
address of a label for instance).  The single argument is a pointer to
the <CODE>jmp_buf</CODE>.  Note that the buffer is five words long and that
the first three are normally used by the generic mechanism.
<P>

<A NAME="IDX1055"></A>
<DT><SAMP>`builtin_setjmp_receiver'</SAMP>
<DD>This pattern, if defined, contains code needed at the site of an
builtin setjmp that isn't needed at the site of a nonlocal goto.  You
will not normally need to define this pattern.  A typical reason why you
might need this pattern is if some value, such as a pointer to a global
table, must be restored.  It takes one argument, which is the label
to which builtin_longjmp transfered control; this pattern may be emitted
at a small offset from that label.
<P>

<A NAME="IDX1056"></A>
<DT><SAMP>`builtin_longjmp'</SAMP>
<DD>This pattern, if defined, performs the entire action of the longjmp.
You will not normally need to define this pattern unless you also define
<CODE>builtin_setjmp_setup</CODE>.  The single argument is a pointer to the
<CODE>jmp_buf</CODE>.
<P>

<A NAME="IDX1057"></A>
<DT><SAMP>`eh_epilogue'</SAMP>
<DD>This pattern, if defined, affects the way <CODE>__builtin_eh_return</CODE>,
and thence <CODE>__throw</CODE> are built.  It is intended to allow communication
between the exception handling machinery and the normal epilogue code
for the target.
<P>

The pattern takes three arguments.  The first is the exception context
pointer.  This will have already been copied to the function return
register appropriate for a pointer; normally this can be ignored.  The
second argument is an offset to be added to the stack pointer.  It will 
have been copied to some arbitrary call-clobbered hard reg so that it
will survive until after reload to when the normal epilogue is generated. 
The final argument is the address of the exception handler to which
the function should return.  This will normally need to copied by the
pattern to some special register.
</P><P>

This pattern must be defined if <CODE>RETURN_ADDR_RTX</CODE> does not yield
something that can be reliably and permanently modified, i.e. a fixed
hard register or a stack memory reference.
</P><P>

<A NAME="IDX1058"></A>
<DT><SAMP>`prologue'</SAMP>
<DD>This pattern, if defined, emits RTL for entry to a function.  The function
entry is resposible for setting up the stack frame, initializing the frame
pointer register, saving callee saved registers, etc.
<P>

Using a prologue pattern is generally preferred over defining
<CODE>FUNCTION_PROLOGUE</CODE> to emit assembly code for the prologue.
</P><P>

The <CODE>prologue</CODE> pattern is particularly useful for targets which perform
instruction scheduling.
</P><P>

<A NAME="IDX1059"></A>
<DT><SAMP>`epilogue'</SAMP>
<DD>This pattern, if defined, emits RTL for exit from a function.  The function
exit is resposible for deallocating the stack frame, restoring callee saved
registers and emitting the return instruction.
<P>

Using an epilogue pattern is generally preferred over defining
<CODE>FUNCTION_EPILOGUE</CODE> to emit assembly code for the prologue.
</P><P>

The <CODE>epilogue</CODE> pattern is particularly useful for targets which perform
instruction scheduling or which have delay slots for their return instruction.
</P><P>

<A NAME="IDX1060"></A>
<DT><SAMP>`sibcall_epilogue'</SAMP>
<DD>This pattern, if defined, emits RTL for exit from a function without the final
branch back to the calling function.  This pattern will be emitted before any
sibling call (aka tail call) sites.
<P>

The <CODE>sibcall_epilogue</CODE> pattern must not clobber any arguments used for
parameter passing or any stack slots for arguments passed to the current
function.  
</DL>
<P>

<A NAME="Pattern Ordering"></A>
<HR SIZE="6">
<A NAME="SEC183"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC182" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC182"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC184" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC184"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC184" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC184"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.8 When the Order of Patterns Matters </H2>
<!--docid::SEC183::-->
<P>

Sometimes an insn can match more than one instruction pattern.  Then the
pattern that appears first in the machine description is the one used.
Therefore, more specific patterns (patterns that will match fewer things)
and faster instructions (those that will produce better code when they
do match) should usually go first in the description.
</P><P>

In some cases the effect of ordering the patterns can be used to hide
a pattern when it is not valid.  For example, the 68000 has an
instruction for converting a fullword to floating point and another
for converting a byte to floating point.  An instruction converting
an integer to floating point could match either one.  We put the
pattern to convert the fullword first to make sure that one will
be used rather than the other.  (Otherwise a large integer might
be generated as a single-byte immediate quantity, which would not work.)
Instead of using this pattern ordering it would be possible to make the
pattern for convert-a-byte smart enough to deal properly with any
constant value.
</P><P>

<A NAME="Dependent Patterns"></A>
<HR SIZE="6">
<A NAME="SEC184"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC183" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC183"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC185" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC185"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.9 Interdependence of Patterns </H2>
<!--docid::SEC184::-->
<P>

Every machine description must have a named pattern for each of the
conditional branch names <SAMP>`b<VAR>cond</VAR>'</SAMP>.  The recognition template
must always have the form
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(set (pc)
     (if_then_else (<VAR>cond</VAR> (cc0) (const_int 0))
                   (label_ref (match_operand 0 "" ""))
                   (pc)))
</pre></td></tr></table></P><P>

In addition, every machine description must have an anonymous pattern
for each of the possible reverse-conditional branches.  Their templates
look like
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(set (pc)
     (if_then_else (<VAR>cond</VAR> (cc0) (const_int 0))
                   (pc)
                   (label_ref (match_operand 0 "" ""))))
</pre></td></tr></table></P><P>

They are necessary because jump optimization can turn direct-conditional
branches into reverse-conditional branches.
</P><P>

It is often convenient to use the <CODE>match_operator</CODE> construct to
reduce the number of patterns that must be specified for branches.  For
example,
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(define_insn ""
  [(set (pc)
        (if_then_else (match_operator 0 "comparison_operator"
                                      [(cc0) (const_int 0)])
                      (pc)
                      (label_ref (match_operand 1 "" ""))))]
  "<VAR>condition</VAR>"
  "<small>...</small>")
</pre></td></tr></table></P><P>

In some cases machines support instructions identical except for the
machine mode of one or more operands.  For example, there may be
"sign-extend halfword" and "sign-extend byte" instructions whose
patterns are
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(set (match_operand:SI 0 <small>...</small>)
     (extend:SI (match_operand:HI 1 <small>...</small>)))

(set (match_operand:SI 0 <small>...</small>)
     (extend:SI (match_operand:QI 1 <small>...</small>)))
</pre></td></tr></table></P><P>

Constant integers do not specify a machine mode, so an instruction to
extend a constant value could match either pattern.  The pattern it
actually will match is the one that appears first in the file.  For correct
results, this must be the one for the widest possible mode (<CODE>HImode</CODE>,
here).  If the pattern matches the <CODE>QImode</CODE> instruction, the results
will be incorrect if the constant value does not actually fit that mode.
</P><P>

Such instructions to extend constants are rarely generated because they are
optimized away, but they do occasionally happen in nonoptimized
compilations.
</P><P>

If a constraint in a pattern allows a constant, the reload pass may
replace a register with a constant permitted by the constraint in some
cases.  Similarly for memory references.  Because of this substitution,
you should not provide separate patterns for increment and decrement
instructions.  Instead, they should be generated from the same pattern
that supports register-register add insns by examining the operands and
generating the appropriate machine instruction.
</P><P>

<A NAME="Jump Patterns"></A>
<HR SIZE="6">
<A NAME="SEC185"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC184" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC184"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC186" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC186"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC171" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC171"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.10 Defining Jump Instruction Patterns </H2>
<!--docid::SEC185::-->
<P>

For most machines, GNU CC assumes that the machine has a condition code.
A comparison insn sets the condition code, recording the results of both
signed and unsigned comparison of the given operands.  A separate branch
insn tests the condition code and branches or not according its value.
The branch insns come in distinct signed and unsigned flavors.  Many
common machines, such as the Vax, the 68000 and the 32000, work this
way.
</P><P>

Some machines have distinct signed and unsigned compare instructions, and
only one set of conditional branch instructions.  The easiest way to handle
these machines is to treat them just like the others until the final stage
where assembly code is written.  At this time, when outputting code for the
compare instruction, peek ahead at the following branch using
<CODE>next_cc0_user (insn)</CODE>.  (The variable <CODE>insn</CODE> refers to the insn
being output, in the output-writing code in an instruction pattern.)  If
the RTL says that is an unsigned branch, output an unsigned compare;
otherwise output a signed compare.  When the branch itself is output, you
can treat signed and unsigned branches identically.
</P><P>

The reason you can do this is that GNU CC always generates a pair of
consecutive RTL insns, possibly separated by <CODE>note</CODE> insns, one to
set the condition code and one to test it, and keeps the pair inviolate
until the end.
</P><P>

To go with this technique, you must define the machine-description macro
<CODE>NOTICE_UPDATE_CC</CODE> to do <CODE>CC_STATUS_INIT</CODE>; in other words, no
compare instruction is superfluous.
</P><P>

Some machines have compare-and-branch instructions and no condition code.
A similar technique works for them.  When it is time to "output" a
compare instruction, record its operands in two static variables.  When
outputting the branch-on-condition-code instruction that follows, actually
output a compare-and-branch instruction that uses the remembered operands.
</P><P>

It also works to define patterns for compare-and-branch instructions.
In optimizing compilation, the pair of compare and branch instructions
will be combined according to these patterns.  But this does not happen
if optimization is not requested.  So you must use one of the solutions
above in addition to any special patterns you define.
</P><P>

In many RISC machines, most instructions do not affect the condition
code and there may not even be a separate condition code register.  On
these machines, the restriction that the definition and use of the
condition code be adjacent insns is not necessary and can prevent
important optimizations.  For example, on the IBM RS/6000, there is a
delay for taken branches unless the condition code register is set three
instructions earlier than the conditional branch.  The instruction
scheduler cannot perform this optimization if it is not permitted to
separate the definition and use of the condition code register.
</P><P>

On these machines, do not use <CODE>(cc0)</CODE>, but instead use a register
to represent the condition code.  If there is a specific condition code
register in the machine, use a hard register.  If the condition code or
comparison result can be placed in any general register, or if there are
multiple condition registers, use a pseudo register.
</P><P>

<A NAME="IDX1061"></A>
<A NAME="IDX1062"></A>
On some machines, the type of branch instruction generated may depend on
the way the condition code was produced; for example, on the 68k and
Sparc, setting the condition code directly from an add or subtract
instruction does not clear the overflow bit the way that a test
instruction does, so a different branch instruction must be used for
some conditional branches.  For machines that use <CODE>(cc0)</CODE>, the set
and use of the condition code must be adjacent (separated only by
<CODE>note</CODE> insns) allowing flags in <CODE>cc_status</CODE> to be used.
(See section <A HREF="gcc_17.html#SEC228" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC228">17.12 Condition Code Status</A>.)  Also, the comparison and branch insns can be
located from each other by using the functions <CODE>prev_cc0_setter</CODE>
and <CODE>next_cc0_user</CODE>.
</P><P>

However, this is not true on machines that do not use <CODE>(cc0)</CODE>.  On
those machines, no assumptions can be made about the adjacency of the
compare and branch insns and the above methods cannot be used.  Instead,
we use the machine mode of the condition code register to record
different formats of the condition code register.
</P><P>

Registers used to store the condition code value should have a mode that
is in class <CODE>MODE_CC</CODE>.  Normally, it will be <CODE>CCmode</CODE>.  If
additional modes are required (as for the add example mentioned above in
the Sparc), define the macro <CODE>EXTRA_CC_MODES</CODE> to list the
additional modes required (see section <A HREF="gcc_17.html#SEC228" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC228">17.12 Condition Code Status</A>).  Also define
<CODE>EXTRA_CC_NAMES</CODE> to list the names of those modes and
<CODE>SELECT_CC_MODE</CODE> to choose a mode given an operand of a compare.
</P><P>

If it is known during RTL generation that a different mode will be
required (for example, if the machine has separate compare instructions
for signed and unsigned quantities, like most IBM processors), they can
be specified at that time.
</P><P>

If the cases that require different modes would be made by instruction
combination, the macro <CODE>SELECT_CC_MODE</CODE> determines which machine
mode should be used for the comparison result.  The patterns should be
written using that mode.  To support the case of the add on the Sparc
discussed above, we have the pattern
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn ""
  [(set (reg:CC_NOOV 0)
        (compare:CC_NOOV
          (plus:SI (match_operand:SI 0 "register_operand" "%r")
                   (match_operand:SI 1 "arith_operand" "rI"))
          (const_int 0)))]
  ""
  "<small>...</small>")
</FONT></pre></td></tr></table></P><P>

The <CODE>SELECT_CC_MODE</CODE> macro on the Sparc returns <CODE>CC_NOOVmode</CODE>
for comparisons whose argument is a <CODE>plus</CODE>.
</P><P>

<A NAME="Insn Canonicalizations"></A>
<HR SIZE="6">
<A NAME="SEC186"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC185" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC185"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC187" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC187"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC171" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC171"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.11 Canonicalization of Instructions </H2>
<!--docid::SEC186::-->
<P>

There are often cases where multiple RTL expressions could represent an
operation performed by a single machine instruction.  This situation is
most commonly encountered with logical, branch, and multiply-accumulate
instructions.  In such cases, the compiler attempts to convert these
multiple RTL expressions into a single canonical form to reduce the
number of insn patterns required.
</P><P>

In addition to algebraic simplifications, following canonicalizations
are performed:
</P><P>

<UL>
<LI>
For commutative and comparison operators, a constant is always made the
second operand.  If a machine only supports a constant as the second
operand, only patterns that match a constant in the second operand need
be supplied.
<P>

<A NAME="IDX1063"></A>
<A NAME="IDX1064"></A>
<A NAME="IDX1065"></A>
<A NAME="IDX1066"></A>
<A NAME="IDX1067"></A>
For these operators, if only one operand is a <CODE>neg</CODE>, <CODE>not</CODE>,
<CODE>mult</CODE>, <CODE>plus</CODE>, or <CODE>minus</CODE> expression, it will be the
first operand.
</P><P>

<A NAME="IDX1068"></A>
<LI>
For the <CODE>compare</CODE> operator, a constant is always the second operand
on machines where <CODE>cc0</CODE> is used (see section <A HREF="gcc_16.html#SEC185" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC185">16.10 Defining Jump Instruction Patterns</A>).  On other
machines, there are rare cases where the compiler might want to construct
a <CODE>compare</CODE> with a constant as the first operand.  However, these
cases are not common enough for it to be worthwhile to provide a pattern
matching a constant as the first operand unless the machine actually has
such an instruction.
<P>

An operand of <CODE>neg</CODE>, <CODE>not</CODE>, <CODE>mult</CODE>, <CODE>plus</CODE>, or
<CODE>minus</CODE> is made the first operand under the same conditions as
above.
</P><P>

<LI>
<CODE>(minus <VAR>x</VAR> (const_int <VAR>n</VAR>))</CODE> is converted to
<CODE>(plus <VAR>x</VAR> (const_int <VAR>-n</VAR>))</CODE>.
<P>

<LI>
Within address computations (i.e., inside <CODE>mem</CODE>), a left shift is
converted into the appropriate multiplication by a power of two.
<P>

<A NAME="IDX1069"></A>
<A NAME="IDX1070"></A>
<A NAME="IDX1071"></A>
<LI>
De`Morgan's Law is used to move bitwise negation inside a bitwise
logical-and or logical-or operation.  If this results in only one
operand being a <CODE>not</CODE> expression, it will be the first one.
<P>

A machine that has an instruction that performs a bitwise logical-and of one
operand with the bitwise negation of the other should specify the pattern
for that instruction as
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(define_insn ""
  [(set (match_operand:<VAR>m</VAR> 0 <small>...</small>)
        (and:<VAR>m</VAR> (not:<VAR>m</VAR> (match_operand:<VAR>m</VAR> 1 <small>...</small>))
                     (match_operand:<VAR>m</VAR> 2 <small>...</small>)))]
  "<small>...</small>"
  "<small>...</small>")
</pre></td></tr></table></P><P>

Similarly, a pattern for a "NAND" instruction should be written
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(define_insn ""
  [(set (match_operand:<VAR>m</VAR> 0 <small>...</small>)
        (ior:<VAR>m</VAR> (not:<VAR>m</VAR> (match_operand:<VAR>m</VAR> 1 <small>...</small>))
                     (not:<VAR>m</VAR> (match_operand:<VAR>m</VAR> 2 <small>...</small>))))]
  "<small>...</small>"
  "<small>...</small>")
</pre></td></tr></table></P><P>

In both cases, it is not necessary to include patterns for the many
logically equivalent RTL expressions.
</P><P>

<A NAME="IDX1072"></A>
<LI>
The only possible RTL expressions involving both bitwise exclusive-or
and bitwise negation are <CODE>(xor:<VAR>m</VAR> <VAR>x</VAR> <VAR>y</VAR>)</CODE>
and <CODE>(not:<VAR>m</VAR> (xor:<VAR>m</VAR> <VAR>x</VAR> <VAR>y</VAR>))</CODE>.<P>

<LI>
The sum of three items, one of which is a constant, will only appear in
the form
<P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>(plus:<VAR>m</VAR> (plus:<VAR>m</VAR> <VAR>x</VAR> <VAR>y</VAR>) <VAR>constant</VAR>)
</pre></td></tr></table></P><P>

<LI>
On machines that do not use <CODE>cc0</CODE>,
<CODE>(compare <VAR>x</VAR> (const_int 0))</CODE> will be converted to
<VAR>x</VAR>.<P>

<A NAME="IDX1073"></A>
<A NAME="IDX1074"></A>
<LI>
Equality comparisons of a group of bits (usually a single bit) with zero
will be written using <CODE>zero_extract</CODE> rather than the equivalent
<CODE>and</CODE> or <CODE>sign_extract</CODE> operations.
<P>

</UL>
<P>

<A NAME="Peephole Definitions"></A>
<HR SIZE="6">
<A NAME="SEC187"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC186" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC186"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC188" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC188"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC171" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC171"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.12 Machine-Specific Peephole Optimizers </H2>
<!--docid::SEC187::-->
<P>

In addition to instruction patterns the <TT>`md'</TT> file may contain
definitions of machine-specific peephole optimizations.
</P><P>

The combiner does not notice certain peephole optimizations when the data
flow in the program does not suggest that it should try them.  For example,
sometimes two consecutive insns related in purpose can be combined even
though the second one does not appear to use a register computed in the
first one.  A machine-specific peephole optimizer can detect such
opportunities.
</P><P>

A definition looks like this:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_peephole
  [<VAR>insn-pattern-1</VAR>
   <VAR>insn-pattern-2</VAR>
   <small>...</small>]
  "<VAR>condition</VAR>"
  "<VAR>template</VAR>"
  "<VAR>optional insn-attributes</VAR>")
</FONT></pre></td></tr></table></P><P>

The last string operand may be omitted if you are not using any
machine-specific information in this machine description.  If present,
it must obey the same rules as in a <CODE>define_insn</CODE>.
</P><P>

In this skeleton, <VAR>insn-pattern-1</VAR> and so on are patterns to match
consecutive insns.  The optimization applies to a sequence of insns when
<VAR>insn-pattern-1</VAR> matches the first one, <VAR>insn-pattern-2</VAR> matches
the next, and so on.</P><P>

Each of the insns matched by a peephole must also match a
<CODE>define_insn</CODE>.  Peepholes are checked only at the last stage just
before code generation, and only optionally.  Therefore, any insn which
would match a peephole but no <CODE>define_insn</CODE> will cause a crash in code
generation in an unoptimized compilation, or at various optimization
stages.
</P><P>

The operands of the insns are matched with <CODE>match_operands</CODE>,
<CODE>match_operator</CODE>, and <CODE>match_dup</CODE>, as usual.  What is not
usual is that the operand numbers apply to all the insn patterns in the
definition.  So, you can check for identical operands in two insns by
using <CODE>match_operand</CODE> in one insn and <CODE>match_dup</CODE> in the
other.
</P><P>

The operand constraints used in <CODE>match_operand</CODE> patterns do not have
any direct effect on the applicability of the peephole, but they will
be validated afterward, so make sure your constraints are general enough
to apply whenever the peephole matches.  If the peephole matches
but the constraints are not satisfied, the compiler will crash.
</P><P>

It is safe to omit constraints in all the operands of the peephole; or
you can write constraints which serve as a double-check on the criteria
previously tested.
</P><P>

Once a sequence of insns matches the patterns, the <VAR>condition</VAR> is
checked.  This is a C expression which makes the final decision whether to
perform the optimization (we do so if the expression is nonzero).  If
<VAR>condition</VAR> is omitted (in other words, the string is empty) then the
optimization is applied to every sequence of insns that matches the
patterns.
</P><P>

The defined peephole optimizations are applied after register allocation
is complete.  Therefore, the peephole definition can check which
operands have ended up in which kinds of registers, just by looking at
the operands.
</P><P>

<A NAME="IDX1075"></A>
The way to refer to the operands in <VAR>condition</VAR> is to write
<CODE>operands[<VAR>i</VAR>]</CODE> for operand number <VAR>i</VAR> (as matched by
<CODE>(match_operand <VAR>i</VAR> <small>...</small>)</CODE>).  Use the variable <CODE>insn</CODE>
to refer to the last of the insns being matched; use
<CODE>prev_active_insn</CODE> to find the preceding insns.
</P><P>

<A NAME="IDX1076"></A>
When optimizing computations with intermediate results, you can use
<VAR>condition</VAR> to match only when the intermediate results are not used
elsewhere.  Use the C expression <CODE>dead_or_set_p (<VAR>insn</VAR>,
<VAR>op</VAR>)</CODE>, where <VAR>insn</VAR> is the insn in which you expect the value
to be used for the last time (from the value of <CODE>insn</CODE>, together
with use of <CODE>prev_nonnote_insn</CODE>), and <VAR>op</VAR> is the intermediate
value (from <CODE>operands[<VAR>i</VAR>]</CODE>).</P><P>

Applying the optimization means replacing the sequence of insns with one
new insn.  The <VAR>template</VAR> controls ultimate output of assembler code
for this combined insn.  It works exactly like the template of a
<CODE>define_insn</CODE>.  Operand numbers in this template are the same ones
used in matching the original sequence of insns.
</P><P>

The result of a defined peephole optimizer does not need to match any of
the insn patterns in the machine description; it does not even have an
opportunity to match them.  The peephole optimizer definition itself serves
as the insn pattern to control how the insn is output.
</P><P>

Defined peephole optimizers are run as assembler code is being output,
so the insns they produce are never combined or rearranged in any way.
</P><P>

Here is an example, taken from the 68000 machine description:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_peephole
  [(set (reg:SI 15) (plus:SI (reg:SI 15) (const_int 4)))
   (set (match_operand:DF 0 "register_operand" "=f")
        (match_operand:DF 1 "register_operand" "ad"))]
  "FP_REG_P (operands[0]) &&#38; ! FP_REG_P (operands[1])"
  "*
{
  rtx xoperands[2];
  xoperands[1] = gen_rtx (REG, SImode, REGNO (operands[1]) + 1);
#ifdef MOTOROLA
  output_asm_insn (\"move.l %1,(sp)\", xoperands);
  output_asm_insn (\"move.l %1,-(sp)\", operands);
  return \"fmove.d (sp)+,%0\";
#else
  output_asm_insn (\"movel %1,sp@\", xoperands);
  output_asm_insn (\"movel %1,sp@-\", operands);
  return \"fmoved sp@+,%0\";
#endif
}
")
</FONT></pre></td></tr></table></P><P>

The effect of this optimization is to change
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>jbsr _foobar
addql #4,sp
movel d1,sp@-
movel d0,sp@-
fmoved sp@+,fp0
</FONT></pre></td></tr></table></P><P>

into
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>jbsr _foobar
movel d1,sp@
movel d0,sp@-
fmoved sp@+,fp0
</FONT></pre></td></tr></table></P><P>

<VAR>insn-pattern-1</VAR> and so on look <EM>almost</EM> like the second
operand of <CODE>define_insn</CODE>.  There is one important difference: the
second operand of <CODE>define_insn</CODE> consists of one or more RTX's
enclosed in square brackets.  Usually, there is only one: then the same
action can be written as an element of a <CODE>define_peephole</CODE>.  But
when there are multiple actions in a <CODE>define_insn</CODE>, they are
implicitly enclosed in a <CODE>parallel</CODE>.  Then you must explicitly
write the <CODE>parallel</CODE>, and the square brackets within it, in the
<CODE>define_peephole</CODE>.  Thus, if an insn pattern looks like this,
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn "divmodsi4"
  [(set (match_operand:SI 0 "general_operand" "=d")
        (div:SI (match_operand:SI 1 "general_operand" "0")
                (match_operand:SI 2 "general_operand" "dmsK")))
   (set (match_operand:SI 3 "general_operand" "=d")
        (mod:SI (match_dup 1) (match_dup 2)))]
  "TARGET_68020"
  "divsl%.l %2,%3:%0")
</FONT></pre></td></tr></table></P><P>

then the way to mention this insn in a peephole is as follows:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_peephole
  [<small>...</small>
   (parallel
    [(set (match_operand:SI 0 "general_operand" "=d")
          (div:SI (match_operand:SI 1 "general_operand" "0")
                  (match_operand:SI 2 "general_operand" "dmsK")))
     (set (match_operand:SI 3 "general_operand" "=d")
          (mod:SI (match_dup 1) (match_dup 2)))])
   <small>...</small>]
  <small>...</small>)
</FONT></pre></td></tr></table></P><P>

<A NAME="Expander Definitions"></A>
<HR SIZE="6">
<A NAME="SEC188"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC187" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC187"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC189" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC189"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC171" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC171"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.13 Defining RTL Sequences for Code Generation </H2>
<!--docid::SEC188::-->
<P>

On some target machines, some standard pattern names for RTL generation
cannot be handled with single insn, but a sequence of RTL insns can
represent them.  For these target machines, you can write a
<CODE>define_expand</CODE> to specify how to generate the sequence of RTL.
</P><P>

<A NAME="IDX1077"></A>
A <CODE>define_expand</CODE> is an RTL expression that looks almost like a
<CODE>define_insn</CODE>; but, unlike the latter, a <CODE>define_expand</CODE> is used
only for RTL generation and it can produce more than one RTL insn.
</P><P>

A <CODE>define_expand</CODE> RTX has four operands:
</P><P>

<UL>
<LI>
The name.  Each <CODE>define_expand</CODE> must have a name, since the only
use for it is to refer to it by name.
<P>

<A NAME="IDX1078"></A>
<LI>
The RTL template.  This is just like the RTL template for a
<CODE>define_peephole</CODE> in that it is a vector of RTL expressions
each being one insn.
<P>

<LI>
The condition, a string containing a C expression.  This expression is
used to express how the availability of this pattern depends on
subclasses of target machine, selected by command-line options when GNU
CC is run.  This is just like the condition of a <CODE>define_insn</CODE> that
has a standard name.  Therefore, the condition (if present) may not
depend on the data in the insn being matched, but only the
target-machine-type flags.  The compiler needs to test these conditions
during initialization in order to learn exactly which named instructions
are available in a particular run.
<P>

<LI>
The preparation statements, a string containing zero or more C
statements which are to be executed before RTL code is generated from
the RTL template.
<P>

Usually these statements prepare temporary registers for use as
internal operands in the RTL template, but they can also generate RTL
insns directly by calling routines such as <CODE>emit_insn</CODE>, etc.
Any such insns precede the ones that come from the RTL template.
</UL>
<P>

Every RTL insn emitted by a <CODE>define_expand</CODE> must match some
<CODE>define_insn</CODE> in the machine description.  Otherwise, the compiler
will crash when trying to generate code for the insn or trying to optimize
it.
</P><P>

The RTL template, in addition to controlling generation of RTL insns,
also describes the operands that need to be specified when this pattern
is used.  In particular, it gives a predicate for each operand.
</P><P>

A true operand, which needs to be specified in order to generate RTL from
the pattern, should be described with a <CODE>match_operand</CODE> in its first
occurrence in the RTL template.  This enters information on the operand's
predicate into the tables that record such things.  GNU CC uses the
information to preload the operand into a register if that is required for
valid RTL code.  If the operand is referred to more than once, subsequent
references should use <CODE>match_dup</CODE>.
</P><P>

The RTL template may also refer to internal "operands" which are
temporary registers or labels used only within the sequence made by the
<CODE>define_expand</CODE>.  Internal operands are substituted into the RTL
template with <CODE>match_dup</CODE>, never with <CODE>match_operand</CODE>.  The
values of the internal operands are not passed in as arguments by the
compiler when it requests use of this pattern.  Instead, they are computed
within the pattern, in the preparation statements.  These statements
compute the values and store them into the appropriate elements of
<CODE>operands</CODE> so that <CODE>match_dup</CODE> can find them.
</P><P>

There are two special macros defined for use in the preparation statements:
<CODE>DONE</CODE> and <CODE>FAIL</CODE>.  Use them with a following semicolon,
as a statement.
</P><P>

<DL COMPACT>

<A NAME="IDX1079"></A>
<DT><CODE>DONE</CODE>
<DD>Use the <CODE>DONE</CODE> macro to end RTL generation for the pattern.  The
only RTL insns resulting from the pattern on this occasion will be
those already emitted by explicit calls to <CODE>emit_insn</CODE> within the
preparation statements; the RTL template will not be generated.
<P>

<A NAME="IDX1080"></A>
<DT><CODE>FAIL</CODE>
<DD>Make the pattern fail on this occasion.  When a pattern fails, it means
that the pattern was not truly available.  The calling routines in the
compiler will try other strategies for code generation using other patterns.
<P>

Failure is currently supported only for binary (addition, multiplication,
shifting, etc.) and bitfield (<CODE>extv</CODE>, <CODE>extzv</CODE>, and <CODE>insv</CODE>)
operations.
</DL>
<P>

Here is an example, the definition of left-shift for the SPUR chip:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_expand "ashlsi3"
  [(set (match_operand:SI 0 "register_operand" "")
        (ashift:SI
          (match_operand:SI 1 "register_operand" "")
          (match_operand:SI 2 "nonmemory_operand" "")))]
  ""
  "
</FONT></pre></td></tr></table></P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>{
  if (GET_CODE (operands[2]) != CONST_INT
      || (unsigned) INTVAL (operands[2]) &#62; 3)
    FAIL;
}")
</FONT></pre></td></tr></table></P><P>

This example uses <CODE>define_expand</CODE> so that it can generate an RTL insn
for shifting when the shift-count is in the supported range of 0 to 3 but
fail in other cases where machine insns aren't available.  When it fails,
the compiler tries another strategy using different patterns (such as, a
library call).
</P><P>

If the compiler were able to handle nontrivial condition-strings in
patterns with names, then it would be possible to use a
<CODE>define_insn</CODE> in that case.  Here is another case (zero-extension
on the 68000) which makes more use of the power of <CODE>define_expand</CODE>:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_expand "zero_extendhisi2"
  [(set (match_operand:SI 0 "general_operand" "")
        (const_int 0))
   (set (strict_low_part
          (subreg:HI
            (match_dup 0)
            0))
        (match_operand:HI 1 "general_operand" ""))]
  ""
  "operands[1] = make_safe_from (operands[1], operands[0]);")
</FONT></pre></td></tr></table></P><P>

<A NAME="IDX1081"></A>
Here two RTL insns are generated, one to clear the entire output operand
and the other to copy the input operand into its low half.  This sequence
is incorrect if the input operand refers to [the old value of] the output
operand, so the preparation statement makes sure this isn't so.  The
function <CODE>make_safe_from</CODE> copies the <CODE>operands[1]</CODE> into a
temporary register if it refers to <CODE>operands[0]</CODE>.  It does this
by emitting another RTL insn.
</P><P>

Finally, a third example shows the use of an internal operand.
Zero-extension on the SPUR chip is done by <CODE>and</CODE>-ing the result
against a halfword mask.  But this mask cannot be represented by a
<CODE>const_int</CODE> because the constant value is too large to be legitimate
on this machine.  So it must be copied into a register with
<CODE>force_reg</CODE> and then the register used in the <CODE>and</CODE>.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_expand "zero_extendhisi2"
  [(set (match_operand:SI 0 "register_operand" "")
        (and:SI (subreg:SI
                  (match_operand:HI 1 "register_operand" "")
                  0)
                (match_dup 2)))]
  ""
  "operands[2]
     = force_reg (SImode, GEN_INT (65535)); ")
</FONT></pre></td></tr></table></P><P>

<STRONG>Note:</STRONG> If the <CODE>define_expand</CODE> is used to serve a
standard binary or unary arithmetic operation or a bitfield operation,
then the last insn it generates must not be a <CODE>code_label</CODE>,
<CODE>barrier</CODE> or <CODE>note</CODE>.  It must be an <CODE>insn</CODE>,
<CODE>jump_insn</CODE> or <CODE>call_insn</CODE>.  If you don't need a real insn
at the end, emit an insn to copy the result of the operation into
itself.  Such an insn will generate no code, but it can avoid problems
in the compiler.</P><P>

<A NAME="Insn Splitting"></A>
<HR SIZE="6">
<A NAME="SEC189"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC188" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC188"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC190" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC190"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC171" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC171"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.14 Defining How to Split Instructions </H2>
<!--docid::SEC189::-->
<P>

There are two cases where you should specify how to split a pattern into
multiple insns.  On machines that have instructions requiring delay
slots (see section <A HREF="gcc_16.html#SEC197" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC197">16.15.7 Delay Slot Scheduling</A>) or that have instructions whose output is
not available for multiple cycles (see section <A HREF="gcc_16.html#SEC198" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC198">16.15.8 Specifying Function Units</A>), the compiler
phases that optimize these cases need to be able to move insns into
one-instruction delay slots.  However, some insns may generate more than one
machine instruction.  These insns cannot be placed into a delay slot.
</P><P>

Often you can rewrite the single insn as a list of individual insns,
each corresponding to one machine instruction.  The disadvantage of
doing so is that it will cause the compilation to be slower and require
more space.  If the resulting insns are too complex, it may also
suppress some optimizations.  The compiler splits the insn if there is a
reason to believe that it might improve instruction or delay slot
scheduling.
</P><P>

The insn combiner phase also splits putative insns.  If three insns are
merged into one insn with a complex expression that cannot be matched by
some <CODE>define_insn</CODE> pattern, the combiner phase attempts to split
the complex pattern into two insns that are recognized.  Usually it can
break the complex pattern into two patterns by splitting out some
subexpression.  However, in some other cases, such as performing an
addition of a large constant in two insns on a RISC machine, the way to
split the addition into two insns is machine-dependent.
</P><P>

<A NAME="IDX1082"></A>
The <CODE>define_split</CODE> definition tells the compiler how to split a
complex insn into several simpler insns.  It looks like this:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_split
  [<VAR>insn-pattern</VAR>]
  "<VAR>condition</VAR>"
  [<VAR>new-insn-pattern-1</VAR>
   <VAR>new-insn-pattern-2</VAR>
   <small>...</small>]
  "<VAR>preparation statements</VAR>")
</FONT></pre></td></tr></table></P><P>

<VAR>insn-pattern</VAR> is a pattern that needs to be split and
<VAR>condition</VAR> is the final condition to be tested, as in a
<CODE>define_insn</CODE>.  When an insn matching <VAR>insn-pattern</VAR> and
satisfying <VAR>condition</VAR> is found, it is replaced in the insn list
with the insns given by <VAR>new-insn-pattern-1</VAR>,
<VAR>new-insn-pattern-2</VAR>, etc.
</P><P>

The <VAR>preparation statements</VAR> are similar to those statements that
are specified for <CODE>define_expand</CODE> (see section <A HREF="gcc_16.html#SEC188" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC188">16.13 Defining RTL Sequences for Code Generation</A>)
and are executed before the new RTL is generated to prepare for the
generated code or emit some insns whose pattern is not fixed.  Unlike
those in <CODE>define_expand</CODE>, however, these statements must not
generate any new pseudo-registers.  Once reload has completed, they also
must not allocate any space in the stack frame.
</P><P>

Patterns are matched against <VAR>insn-pattern</VAR> in two different
circumstances.  If an insn needs to be split for delay slot scheduling
or insn scheduling, the insn is already known to be valid, which means
that it must have been matched by some <CODE>define_insn</CODE> and, if
<CODE>reload_completed</CODE> is non-zero, is known to satisfy the constraints
of that <CODE>define_insn</CODE>.  In that case, the new insn patterns must
also be insns that are matched by some <CODE>define_insn</CODE> and, if
<CODE>reload_completed</CODE> is non-zero, must also satisfy the constraints
of those definitions.
</P><P>

As an example of this usage of <CODE>define_split</CODE>, consider the following
example from <TT>`a29k.md'</TT>, which splits a <CODE>sign_extend</CODE> from
<CODE>HImode</CODE> to <CODE>SImode</CODE> into a pair of shift insns:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_split
  [(set (match_operand:SI 0 "gen_reg_operand" "")
        (sign_extend:SI (match_operand:HI 1 "gen_reg_operand" "")))]
  ""
  [(set (match_dup 0)
        (ashift:SI (match_dup 1)
                   (const_int 16)))
   (set (match_dup 0)
        (ashiftrt:SI (match_dup 0)
                     (const_int 16)))]
  "
{ operands[1] = gen_lowpart (SImode, operands[1]); }")
</FONT></pre></td></tr></table></P><P>

When the combiner phase tries to split an insn pattern, it is always the
case that the pattern is <EM>not</EM> matched by any <CODE>define_insn</CODE>.
The combiner pass first tries to split a single <CODE>set</CODE> expression
and then the same <CODE>set</CODE> expression inside a <CODE>parallel</CODE>, but
followed by a <CODE>clobber</CODE> of a pseudo-reg to use as a scratch
register.  In these cases, the combiner expects exactly two new insn
patterns to be generated.  It will verify that these patterns match some
<CODE>define_insn</CODE> definitions, so you need not do this test in the
<CODE>define_split</CODE> (of course, there is no point in writing a
<CODE>define_split</CODE> that will never produce insns that match).
</P><P>

Here is an example of this use of <CODE>define_split</CODE>, taken from
<TT>`rs6000.md'</TT>:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_split
  [(set (match_operand:SI 0 "gen_reg_operand" "")
        (plus:SI (match_operand:SI 1 "gen_reg_operand" "")
                 (match_operand:SI 2 "non_add_cint_operand" "")))]
  ""
  [(set (match_dup 0) (plus:SI (match_dup 1) (match_dup 3)))
   (set (match_dup 0) (plus:SI (match_dup 0) (match_dup 4)))]
"
{
  int low = INTVAL (operands[2]) &#38; 0xffff;
  int high = (unsigned) INTVAL (operands[2]) &#62;&#62; 16;

  if (low &#38; 0x8000)
    high++, low |= 0xffff0000;

  operands[3] = GEN_INT (high &#60;&#60; 16);
  operands[4] = GEN_INT (low);
}")
</FONT></pre></td></tr></table></P><P>

Here the predicate <CODE>non_add_cint_operand</CODE> matches any
<CODE>const_int</CODE> that is <EM>not</EM> a valid operand of a single add
insn.  The add with the smaller displacement is written so that it
can be substituted into the address of a subsequent operation.
</P><P>

An example that uses a scratch register, from the same file, generates
an equality comparison of a register and a large constant:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_split
  [(set (match_operand:CC 0 "cc_reg_operand" "")
        (compare:CC (match_operand:SI 1 "gen_reg_operand" "")
                    (match_operand:SI 2 "non_short_cint_operand" "")))
   (clobber (match_operand:SI 3 "gen_reg_operand" ""))]
  "find_single_use (operands[0], insn, 0)
   &#38;&#38; (GET_CODE (*find_single_use (operands[0], insn, 0)) == EQ
       || GET_CODE (*find_single_use (operands[0], insn, 0)) == NE)"
  [(set (match_dup 3) (xor:SI (match_dup 1) (match_dup 4)))
   (set (match_dup 0) (compare:CC (match_dup 3) (match_dup 5)))]
  "
{
  /* Get the constant we are comparing against, C, and see what it
     looks like sign-extended to 16 bits.  Then see what constant
     could be XOR'ed with C to get the sign-extended value.  */

  int c = INTVAL (operands[2]);
  int sextc = (c &#60;&#60; 16) &#62;&#62; 16;
  int xorv = c ^ sextc;

  operands[4] = GEN_INT (xorv);
  operands[5] = GEN_INT (sextc);
}")
</FONT></pre></td></tr></table></P><P>

To avoid confusion, don't write a single <CODE>define_split</CODE> that
accepts some insns that match some <CODE>define_insn</CODE> as well as some
insns that don't.  Instead, write two separate <CODE>define_split</CODE>
definitions, one for the insns that are valid and one for the insns that
are not valid.
</P><P>

<A NAME="Insn Attributes"></A>
<HR SIZE="6">
<A NAME="SEC190"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC189" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC189"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC191" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC191"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC171" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC171"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC169" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC169"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 16.15 Instruction Attributes </H2>
<!--docid::SEC190::-->
<P>

In addition to describing the instruction supported by the target machine,
the <TT>`md'</TT> file also defines a group of <EM>attributes</EM> and a set of
values for each.  Every generated insn is assigned a value for each attribute.
One possible attribute would be the effect that the insn has on the machine's
condition code.  This attribute can then be used by <CODE>NOTICE_UPDATE_CC</CODE>
to track the condition codes.
</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC191" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC191">16.15.1 Defining Attributes and their Values</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Specifying attributes and their values.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC192" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC192">16.15.2 Attribute Expressions</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Valid expressions for attribute values.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC193" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC193">16.15.3 Assigning Attribute Values to Insns</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Assigning attribute values to insns.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC194" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC194">16.15.4 Example of Attribute Specifications</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">An example of assigning attributes.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC195" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC195">16.15.5 Computing the Length of an Insn</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Computing the length of insns.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC196" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC196">16.15.6 Constant Attributes</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Defining attributes that are constant.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC197" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC197">16.15.7 Delay Slot Scheduling</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Defining delay slots required for a machine.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="gcc_16.html#SEC198" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC198">16.15.8 Specifying Function Units</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Specifying information for insn scheduling.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Defining Attributes"></A>
<HR SIZE="6">
<A NAME="SEC191"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC190" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC190"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC192" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC192"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC171" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC171"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC190" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC190"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.15.1 Defining Attributes and their Values </H3>
<!--docid::SEC191::-->
<P>

<A NAME="IDX1083"></A>
The <CODE>define_attr</CODE> expression is used to define each attribute required
by the target machine.  It looks like:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_attr <VAR>name</VAR> <VAR>list-of-values</VAR> <VAR>default</VAR>)
</FONT></pre></td></tr></table></P><P>

<VAR>name</VAR> is a string specifying the name of the attribute being defined.
</P><P>

<VAR>list-of-values</VAR> is either a string that specifies a comma-separated
list of values that can be assigned to the attribute, or a null string to
indicate that the attribute takes numeric values.
</P><P>

<VAR>default</VAR> is an attribute expression that gives the value of this
attribute for insns that match patterns whose definition does not include
an explicit value for this attribute.  See section <A HREF="gcc_16.html#SEC194" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC194">16.15.4 Example of Attribute Specifications</A>, for more
information on the handling of defaults.  See section <A HREF="gcc_16.html#SEC196" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC196">16.15.6 Constant Attributes</A>,
for information on attributes that do not depend on any particular insn.
</P><P>

<A NAME="IDX1084"></A>
For each defined attribute, a number of definitions are written to the
<TT>`insn-attr.h'</TT> file.  For cases where an explicit set of values is
specified for an attribute, the following are defined:
</P><P>

<UL>
<LI>
A <SAMP>`#define'</SAMP> is written for the symbol <SAMP>`HAVE_ATTR_<VAR>name</VAR>'</SAMP>.
<P>

<LI>
An enumeral class is defined for <SAMP>`attr_<VAR>name</VAR>'</SAMP> with
elements of the form <SAMP>`<VAR>upper-name</VAR>_<VAR>upper-value</VAR>'</SAMP> where
the attribute name and value are first converted to upper case.
<P>

<LI>
A function <SAMP>`get_attr_<VAR>name</VAR>'</SAMP> is defined that is passed an insn and
returns the attribute value for that insn.
</UL>
<P>

For example, if the following is present in the <TT>`md'</TT> file:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_attr "type" "branch,fp,load,store,arith" <small>...</small>)
</FONT></pre></td></tr></table></P><P>

the following lines will be written to the file <TT>`insn-attr.h'</TT>.
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>#define HAVE_ATTR_type
enum attr_type {TYPE_BRANCH, TYPE_FP, TYPE_LOAD,
                 TYPE_STORE, TYPE_ARITH};
extern enum attr_type get_attr_type ();
</FONT></pre></td></tr></table></P><P>

If the attribute takes numeric values, no <CODE>enum</CODE> type will be
defined and the function to obtain the attribute's value will return
<CODE>int</CODE>.
</P><P>

<A NAME="Expressions"></A>
<HR SIZE="6">
<A NAME="SEC192"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC191" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC191"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC193" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC193"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC193" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC193"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC190" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC190"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.15.2 Attribute Expressions </H3>
<!--docid::SEC192::-->
<P>

RTL expressions used to define attributes use the codes described above
plus a few specific to attribute definitions, to be discussed below.
Attribute value expressions must have one of the following forms:
</P><P>

<DL COMPACT>
<A NAME="IDX1085"></A>
<DT><CODE>(const_int <VAR>i</VAR>)</CODE>
<DD>The integer <VAR>i</VAR> specifies the value of a numeric attribute.  <VAR>i</VAR>
must be non-negative.
<P>

The value of a numeric attribute can be specified either with a
<CODE>const_int</CODE>, or as an integer represented as a string in
<CODE>const_string</CODE>, <CODE>eq_attr</CODE> (see below), <CODE>attr</CODE>,
<CODE>symbol_ref</CODE>, simple arithmetic expressions, and <CODE>set_attr</CODE>
overrides on specific instructions (see section <A HREF="gcc_16.html#SEC193" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC193">16.15.3 Assigning Attribute Values to Insns</A>).
</P><P>

<A NAME="IDX1086"></A>
<DT><CODE>(const_string <VAR>value</VAR>)</CODE>
<DD>The string <VAR>value</VAR> specifies a constant attribute value.
If <VAR>value</VAR> is specified as <SAMP>`"*"'</SAMP>, it means that the default value of
the attribute is to be used for the insn containing this expression.
<SAMP>`"*"'</SAMP> obviously cannot be used in the <VAR>default</VAR> expression
of a <CODE>define_attr</CODE>.<P>

If the attribute whose value is being specified is numeric, <VAR>value</VAR>
must be a string containing a non-negative integer (normally
<CODE>const_int</CODE> would be used in this case).  Otherwise, it must
contain one of the valid values for the attribute.
</P><P>

<A NAME="IDX1087"></A>
<DT><CODE>(if_then_else <VAR>test</VAR> <VAR>true-value</VAR> <VAR>false-value</VAR>)</CODE>
<DD><VAR>test</VAR> specifies an attribute test, whose format is defined below.
The value of this expression is <VAR>true-value</VAR> if <VAR>test</VAR> is true,
otherwise it is <VAR>false-value</VAR>.
<P>

<A NAME="IDX1088"></A>
<DT><CODE>(cond [<VAR>test1</VAR> <VAR>value1</VAR> <small>...</small>] <VAR>default</VAR>)</CODE>
<DD>The first operand of this expression is a vector containing an even
number of expressions and consisting of pairs of <VAR>test</VAR> and <VAR>value</VAR>
expressions.  The value of the <CODE>cond</CODE> expression is that of the
<VAR>value</VAR> corresponding to the first true <VAR>test</VAR> expression.  If
none of the <VAR>test</VAR> expressions are true, the value of the <CODE>cond</CODE>
expression is that of the <VAR>default</VAR> expression.
</DL>
<P>

<VAR>test</VAR> expressions can have one of the following forms:
</P><P>

<DL COMPACT>
<A NAME="IDX1089"></A>
<DT><CODE>(const_int <VAR>i</VAR>)</CODE>
<DD>This test is true if <VAR>i</VAR> is non-zero and false otherwise.
<P>

<A NAME="IDX1090"></A>
<A NAME="IDX1091"></A>
<A NAME="IDX1092"></A>
<DT><CODE>(not <VAR>test</VAR>)</CODE>
<DD><DT><CODE>(ior <VAR>test1</VAR> <VAR>test2</VAR>)</CODE>
<DD><DT><CODE>(and <VAR>test1</VAR> <VAR>test2</VAR>)</CODE>
<DD>These tests are true if the indicated logical function is true.
<P>

<A NAME="IDX1093"></A>
<DT><CODE>(match_operand:<VAR>m</VAR> <VAR>n</VAR> <VAR>pred</VAR> <VAR>constraints</VAR>)</CODE>
<DD>This test is true if operand <VAR>n</VAR> of the insn whose attribute value
is being determined has mode <VAR>m</VAR> (this part of the test is ignored
if <VAR>m</VAR> is <CODE>VOIDmode</CODE>) and the function specified by the string
<VAR>pred</VAR> returns a non-zero value when passed operand <VAR>n</VAR> and mode
<VAR>m</VAR> (this part of the test is ignored if <VAR>pred</VAR> is the null
string).
<P>

The <VAR>constraints</VAR> operand is ignored and should be the null string.
</P><P>

<A NAME="IDX1094"></A>
<A NAME="IDX1095"></A>
<A NAME="IDX1096"></A>
<A NAME="IDX1097"></A>
<A NAME="IDX1098"></A>
<A NAME="IDX1099"></A>
<A NAME="IDX1100"></A>
<A NAME="IDX1101"></A>
<A NAME="IDX1102"></A>
<A NAME="IDX1103"></A>
<A NAME="IDX1104"></A>
<A NAME="IDX1105"></A>
<A NAME="IDX1106"></A>
<A NAME="IDX1107"></A>
<A NAME="IDX1108"></A>
<A NAME="IDX1109"></A>
<A NAME="IDX1110"></A>
<A NAME="IDX1111"></A>
<A NAME="IDX1112"></A>
<DT><CODE>(le <VAR>arith1</VAR> <VAR>arith2</VAR>)</CODE>
<DD><DT><CODE>(leu <VAR>arith1</VAR> <VAR>arith2</VAR>)</CODE>
<DD><DT><CODE>(lt <VAR>arith1</VAR> <VAR>arith2</VAR>)</CODE>
<DD><DT><CODE>(ltu <VAR>arith1</VAR> <VAR>arith2</VAR>)</CODE>
<DD><DT><CODE>(gt <VAR>arith1</VAR> <VAR>arith2</VAR>)</CODE>
<DD><DT><CODE>(gtu <VAR>arith1</VAR> <VAR>arith2</VAR>)</CODE>
<DD><DT><CODE>(ge <VAR>arith1</VAR> <VAR>arith2</VAR>)</CODE>
<DD><DT><CODE>(geu <VAR>arith1</VAR> <VAR>arith2</VAR>)</CODE>
<DD><DT><CODE>(ne <VAR>arith1</VAR> <VAR>arith2</VAR>)</CODE>
<DD><DT><CODE>(eq <VAR>arith1</VAR> <VAR>arith2</VAR>)</CODE>
<DD>These tests are true if the indicated comparison of the two arithmetic
expressions is true.  Arithmetic expressions are formed with
<CODE>plus</CODE>, <CODE>minus</CODE>, <CODE>mult</CODE>, <CODE>div</CODE>, <CODE>mod</CODE>,
<CODE>abs</CODE>, <CODE>neg</CODE>, <CODE>and</CODE>, <CODE>ior</CODE>, <CODE>xor</CODE>, <CODE>not</CODE>,
<CODE>ashift</CODE>, <CODE>lshiftrt</CODE>, and <CODE>ashiftrt</CODE> expressions.<P>

<A NAME="IDX1113"></A>
<CODE>const_int</CODE> and <CODE>symbol_ref</CODE> are always valid terms (see section <A HREF="gcc_16.html#SEC195" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC195">16.15.5 Computing the Length of an Insn</A>,for additional forms).  <CODE>symbol_ref</CODE> is a string
denoting a C expression that yields an <CODE>int</CODE> when evaluated by the
<SAMP>`get_attr_<small>...</small>'</SAMP> routine.  It should normally be a global
variable.</P><P>

<A NAME="IDX1114"></A>
<DT><CODE>(eq_attr <VAR>name</VAR> <VAR>value</VAR>)</CODE>
<DD><VAR>name</VAR> is a string specifying the name of an attribute.
<P>

<VAR>value</VAR> is a string that is either a valid value for attribute
<VAR>name</VAR>, a comma-separated list of values, or <SAMP>`!'</SAMP> followed by a
value or list.  If <VAR>value</VAR> does not begin with a <SAMP>`!'</SAMP>, this
test is true if the value of the <VAR>name</VAR> attribute of the current
insn is in the list specified by <VAR>value</VAR>.  If <VAR>value</VAR> begins
with a <SAMP>`!'</SAMP>, this test is true if the attribute's value is
<EM>not</EM> in the specified list.
</P><P>

For example,
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(eq_attr "type" "load,store")
</FONT></pre></td></tr></table></P><P>

is equivalent to
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(ior (eq_attr "type" "load") (eq_attr "type" "store"))
</FONT></pre></td></tr></table></P><P>

If <VAR>name</VAR> specifies an attribute of <SAMP>`alternative'</SAMP>, it refers to the
value of the compiler variable <CODE>which_alternative</CODE>
(see section <A HREF="gcc_16.html#SEC174" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC174">16.5 C Statements for Assembler Output</A>) and the values must be small integers.  For
example,</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(eq_attr "alternative" "2,3")
</FONT></pre></td></tr></table></P><P>

is equivalent to
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(ior (eq (symbol_ref "which_alternative") (const_int 2))
     (eq (symbol_ref "which_alternative") (const_int 3)))
</FONT></pre></td></tr></table></P><P>

Note that, for most attributes, an <CODE>eq_attr</CODE> test is simplified in cases
where the value of the attribute being tested is known for all insns matching
a particular pattern.  This is by far the most common case.</P><P>

<A NAME="IDX1115"></A>
<DT><CODE>(attr_flag <VAR>name</VAR>)</CODE>
<DD>The value of an <CODE>attr_flag</CODE> expression is true if the flag
specified by <VAR>name</VAR> is true for the <CODE>insn</CODE> currently being
scheduled.
<P>

<VAR>name</VAR> is a string specifying one of a fixed set of flags to test.
Test the flags <CODE>forward</CODE> and <CODE>backward</CODE> to determine the
direction of a conditional branch.  Test the flags <CODE>very_likely</CODE>,
<CODE>likely</CODE>, <CODE>very_unlikely</CODE>, and <CODE>unlikely</CODE> to determine
if a conditional branch is expected to be taken.
</P><P>

If the <CODE>very_likely</CODE> flag is true, then the <CODE>likely</CODE> flag is also
true.  Likewise for the <CODE>very_unlikely</CODE> and <CODE>unlikely</CODE> flags.
</P><P>

This example describes a conditional branch delay slot which
can be nullified for forward branches that are taken (annul-true) or
for backward branches which are not taken (annul-false).
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_delay (eq_attr "type" "cbranch")
  [(eq_attr "in_branch_delay" "true")
   (and (eq_attr "in_branch_delay" "true")
        (attr_flag "forward"))
   (and (eq_attr "in_branch_delay" "true")
        (attr_flag "backward"))])
</FONT></pre></td></tr></table></P><P>

The <CODE>forward</CODE> and <CODE>backward</CODE> flags are false if the current
<CODE>insn</CODE> being scheduled is not a conditional branch.
</P><P>

The <CODE>very_likely</CODE> and <CODE>likely</CODE> flags are true if the
<CODE>insn</CODE> being scheduled is not a conditional branch.
The <CODE>very_unlikely</CODE> and <CODE>unlikely</CODE> flags are false if the
<CODE>insn</CODE> being scheduled is not a conditional branch.
</P><P>

<CODE>attr_flag</CODE> is only used during delay slot scheduling and has no
meaning to other passes of the compiler.
</P><P>

<A NAME="IDX1116"></A>
<DT><CODE>(attr <VAR>name</VAR>)</CODE>
<DD>The value of another attribute is returned.  This is most useful
for numeric attributes, as <CODE>eq_attr</CODE> and <CODE>attr_flag</CODE>
produce more efficient code for non-numeric attributes.
</DL>
<P>

<A NAME="Tagging Insns"></A>
<HR SIZE="6">
<A NAME="SEC193"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC192" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC192"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC194" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC194"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC194" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC194"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC190" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC190"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.15.3 Assigning Attribute Values to Insns </H3>
<!--docid::SEC193::-->
<P>

The value assigned to an attribute of an insn is primarily determined by
which pattern is matched by that insn (or which <CODE>define_peephole</CODE>
generated it).  Every <CODE>define_insn</CODE> and <CODE>define_peephole</CODE> can
have an optional last argument to specify the values of attributes for
matching insns.  The value of any attribute not specified in a particular
insn is set to the default value for that attribute, as specified in its
<CODE>define_attr</CODE>.  Extensive use of default values for attributes
permits the specification of the values for only one or two attributes
in the definition of most insn patterns, as seen in the example in the
next section.</P><P>

The optional last argument of <CODE>define_insn</CODE> and
<CODE>define_peephole</CODE> is a vector of expressions, each of which defines
the value for a single attribute.  The most general way of assigning an
attribute's value is to use a <CODE>set</CODE> expression whose first operand is an
<CODE>attr</CODE> expression giving the name of the attribute being set.  The
second operand of the <CODE>set</CODE> is an attribute expression
(see section <A HREF="gcc_16.html#SEC192" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC192">16.15.2 Attribute Expressions</A>) giving the value of the attribute.</P><P>

When the attribute value depends on the <SAMP>`alternative'</SAMP> attribute
(i.e., which is the applicable alternative in the constraint of the
insn), the <CODE>set_attr_alternative</CODE> expression can be used.  It
allows the specification of a vector of attribute expressions, one for
each alternative.
</P><P>

<A NAME="IDX1117"></A>
When the generality of arbitrary attribute expressions is not required,
the simpler <CODE>set_attr</CODE> expression can be used, which allows
specifying a string giving either a single attribute value or a list
of attribute values, one for each alternative.
</P><P>

The form of each of the above specifications is shown below.  In each case,
<VAR>name</VAR> is a string specifying the attribute to be set.
</P><P>

<DL COMPACT>
<DT><CODE>(set_attr <VAR>name</VAR> <VAR>value-string</VAR>)</CODE>
<DD><VAR>value-string</VAR> is either a string giving the desired attribute value,
or a string containing a comma-separated list giving the values for
succeeding alternatives.  The number of elements must match the number
of alternatives in the constraint of the insn pattern.
<P>

Note that it may be useful to specify <SAMP>`*'</SAMP> for some alternative, in
which case the attribute will assume its default value for insns matching
that alternative.
</P><P>

<A NAME="IDX1118"></A>
<DT><CODE>(set_attr_alternative <VAR>name</VAR> [<VAR>value1</VAR> <VAR>value2</VAR> <small>...</small>])</CODE>
<DD>Depending on the alternative of the insn, the value will be one of the
specified values.  This is a shorthand for using a <CODE>cond</CODE> with
tests on the <SAMP>`alternative'</SAMP> attribute.
<P>

<A NAME="IDX1119"></A>
<DT><CODE>(set (attr <VAR>name</VAR>) <VAR>value</VAR>)</CODE>
<DD>The first operand of this <CODE>set</CODE> must be the special RTL expression
<CODE>attr</CODE>, whose sole operand is a string giving the name of the
attribute being set.  <VAR>value</VAR> is the value of the attribute.
</DL>
<P>

The following shows three different ways of representing the same
attribute value specification:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(set_attr "type" "load,store,arith")

(set_attr_alternative "type"
                      [(const_string "load") (const_string "store")
                       (const_string "arith")])

(set (attr "type")
     (cond [(eq_attr "alternative" "1") (const_string "load")
            (eq_attr "alternative" "2") (const_string "store")]
           (const_string "arith")))
</FONT></pre></td></tr></table></P><P>

<A NAME="IDX1120"></A>
The <CODE>define_asm_attributes</CODE> expression provides a mechanism to
specify the attributes assigned to insns produced from an <CODE>asm</CODE>
statement.  It has the form:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_asm_attributes [<VAR>attr-sets</VAR>])
</FONT></pre></td></tr></table></P><P>

where <VAR>attr-sets</VAR> is specified the same as for both the
<CODE>define_insn</CODE> and the <CODE>define_peephole</CODE> expressions.
</P><P>

These values will typically be the "worst case" attribute values.  For
example, they might indicate that the condition code will be clobbered.
</P><P>

A specification for a <CODE>length</CODE> attribute is handled specially.  The
way to compute the length of an <CODE>asm</CODE> insn is to multiply the
length specified in the expression <CODE>define_asm_attributes</CODE> by the
number of machine instructions specified in the <CODE>asm</CODE> statement,
determined by counting the number of semicolons and newlines in the
string.  Therefore, the value of the <CODE>length</CODE> attribute specified
in a <CODE>define_asm_attributes</CODE> should be the maximum possible length
of a single machine instruction.
</P><P>

<A NAME="Attr Example"></A>
<HR SIZE="6">
<A NAME="SEC194"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC193" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC193"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC195" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC195"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC195" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC195"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC190" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC190"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.15.4 Example of Attribute Specifications </H3>
<!--docid::SEC194::-->
<P>

The judicious use of defaulting is important in the efficient use of
insn attributes.  Typically, insns are divided into <EM>types</EM> and an
attribute, customarily called <CODE>type</CODE>, is used to represent this
value.  This attribute is normally used only to define the default value
for other attributes.  An example will clarify this usage.
</P><P>

Assume we have a RISC machine with a condition code and in which only
full-word operations are performed in registers.  Let us assume that we
can divide all insns into loads, stores, (integer) arithmetic
operations, floating point operations, and branches.
</P><P>

Here we will concern ourselves with determining the effect of an insn on
the condition code and will limit ourselves to the following possible
effects:  The condition code can be set unpredictably (clobbered), not
be changed, be set to agree with the results of the operation, or only
changed if the item previously set into the condition code has been
modified.
</P><P>

Here is part of a sample <TT>`md'</TT> file for such a machine:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_attr "type" "load,store,arith,fp,branch" (const_string "arith"))

(define_attr "cc" "clobber,unchanged,set,change0"
             (cond [(eq_attr "type" "load")
                        (const_string "change0")
                    (eq_attr "type" "store,branch")
                        (const_string "unchanged")
                    (eq_attr "type" "arith")
                        (if_then_else (match_operand:SI 0 "" "")
                                      (const_string "set")
                                      (const_string "clobber"))]
                   (const_string "clobber")))

(define_insn ""
  [(set (match_operand:SI 0 "general_operand" "=r,r,m")
        (match_operand:SI 1 "general_operand" "r,m,r"))]
  ""
  "@
   move %0,%1
   load %0,%1
   store %0,%1"
  [(set_attr "type" "arith,load,store")])
</FONT></pre></td></tr></table></P><P>

Note that we assume in the above example that arithmetic operations
performed on quantities smaller than a machine word clobber the condition
code since they will set the condition code to a value corresponding to the
full-word result.
</P><P>

<A NAME="Insn Lengths"></A>
<HR SIZE="6">
<A NAME="SEC195"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC194" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC194"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC196" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC196"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC196" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC196"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC190" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC190"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.15.5 Computing the Length of an Insn </H3>
<!--docid::SEC195::-->
<P>

For many machines, multiple types of branch instructions are provided, each
for different length branch displacements.  In most cases, the assembler
will choose the correct instruction to use.  However, when the assembler
cannot do so, GCC can when a special attribute, the <SAMP>`length'</SAMP>
attribute, is defined.  This attribute must be defined to have numeric
values by specifying a null string in its <CODE>define_attr</CODE>.
</P><P>

In the case of the <SAMP>`length'</SAMP> attribute, two additional forms of
arithmetic terms are allowed in test expressions:
</P><P>

<DL COMPACT>
<A NAME="IDX1121"></A>
<DT><CODE>(match_dup <VAR>n</VAR>)</CODE>
<DD>This refers to the address of operand <VAR>n</VAR> of the current insn, which
must be a <CODE>label_ref</CODE>.
<P>

<A NAME="IDX1122"></A>
<DT><CODE>(pc)</CODE>
<DD>This refers to the address of the <EM>current</EM> insn.  It might have
been more consistent with other usage to make this the address of the
<EM>next</EM> insn but this would be confusing because the length of the
current insn is to be computed.
</DL>
<P>

<A NAME="IDX1123"></A>
<A NAME="IDX1124"></A>
For normal insns, the length will be determined by value of the
<SAMP>`length'</SAMP> attribute.  In the case of <CODE>addr_vec</CODE> and
<CODE>addr_diff_vec</CODE> insn patterns, the length is computed as
the number of vectors multiplied by the size of each vector.
</P><P>

Lengths are measured in addressable storage units (bytes).
</P><P>

The following macros can be used to refine the length computation:
</P><P>

<DL COMPACT>
<A NAME="IDX1125"></A>
<DT><CODE>FIRST_INSN_ADDRESS</CODE>
<DD>When the <CODE>length</CODE> insn attribute is used, this macro specifies the
value to be assigned to the address of the first insn in a function.  If
not specified, 0 is used.
<P>

<A NAME="IDX1126"></A>
<DT><CODE>ADJUST_INSN_LENGTH (<VAR>insn</VAR>, <VAR>length</VAR>)</CODE>
<DD>If defined, modifies the length assigned to instruction <VAR>insn</VAR> as a
function of the context in which it is used.  <VAR>length</VAR> is an lvalue
that contains the initially computed length of the insn and should be
updated with the correct length of the insn.
<P>

This macro will normally not be required.  A case in which it is
required is the ROMP.  On this machine, the size of an <CODE>addr_vec</CODE>
insn must be increased by two to compensate for the fact that alignment
may be required.
</DL>
<P>

<A NAME="IDX1127"></A>
The routine that returns <CODE>get_attr_length</CODE> (the value of the
<CODE>length</CODE> attribute) can be used by the output routine to
determine the form of the branch instruction to be written, as the
example below illustrates.
</P><P>

As an example of the specification of variable-length branches, consider
the IBM 360.  If we adopt the convention that a register will be set to
the starting address of a function, we can jump to labels within 4k of
the start using a four-byte instruction.  Otherwise, we need a six-byte
sequence to load the address from memory and then branch to it.
</P><P>

On such a machine, a pattern for a branch instruction might be specified
as follows:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_insn "jump"
  [(set (pc)
        (label_ref (match_operand 0 "" "")))]
  ""
  "*
{
   return (get_attr_length (insn) == 4
           ? \"b %l0\" : \"l r15,=a(%l0); br r15\");
}"
  [(set (attr "length") (if_then_else (lt (match_dup 0) (const_int 4096))
                                      (const_int 4)
                                      (const_int 6)))])
</FONT></pre></td></tr></table></P><P>

<A NAME="Constant Attributes"></A>
<HR SIZE="6">
<A NAME="SEC196"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC195" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC195"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC197" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC197"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC197" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC197"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC190" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC190"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.15.6 Constant Attributes </H3>
<!--docid::SEC196::-->
<P>

A special form of <CODE>define_attr</CODE>, where the expression for the
default value is a <CODE>const</CODE> expression, indicates an attribute that
is constant for a given run of the compiler.  Constant attributes may be
used to specify which variety of processor is used.  For example,
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_attr "cpu" "m88100,m88110,m88000"
 (const
  (cond [(symbol_ref "TARGET_88100") (const_string "m88100")
         (symbol_ref "TARGET_88110") (const_string "m88110")]
        (const_string "m88000"))))

(define_attr "memory" "fast,slow"
 (const
  (if_then_else (symbol_ref "TARGET_FAST_MEM")
                (const_string "fast")
                (const_string "slow"))))
</FONT></pre></td></tr></table></P><P>

The routine generated for constant attributes has no parameters as it
does not depend on any particular insn.  RTL expressions used to define
the value of a constant attribute may use the <CODE>symbol_ref</CODE> form,
but may not use either the <CODE>match_operand</CODE> form or <CODE>eq_attr</CODE>
forms involving insn attributes.
</P><P>

<A NAME="Delay Slots"></A>
<HR SIZE="6">
<A NAME="SEC197"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC196" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC196"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC198" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC198"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC198" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC198"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC190" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC190"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.15.7 Delay Slot Scheduling </H3>
<!--docid::SEC197::-->
<P>

The insn attribute mechanism can be used to specify the requirements for
delay slots, if any, on a target machine.  An instruction is said to
require a <EM>delay slot</EM> if some instructions that are physically
after the instruction are executed as if they were located before it.
Classic examples are branch and call instructions, which often execute
the following instruction before the branch or call is performed.
</P><P>

On some machines, conditional branch instructions can optionally
<EM>annul</EM> instructions in the delay slot.  This means that the
instruction will not be executed for certain branch outcomes.  Both
instructions that annul if the branch is true and instructions that
annul if the branch is false are supported.
</P><P>

Delay slot scheduling differs from instruction scheduling in that
determining whether an instruction needs a delay slot is dependent only
on the type of instruction being generated, not on data flow between the
instructions.  See the next section for a discussion of data-dependent
instruction scheduling.
</P><P>

<A NAME="IDX1128"></A>
The requirement of an insn needing one or more delay slots is indicated
via the <CODE>define_delay</CODE> expression.  It has the following form:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_delay <VAR>test</VAR>
              [<VAR>delay-1</VAR> <VAR>annul-true-1</VAR> <VAR>annul-false-1</VAR>
               <VAR>delay-2</VAR> <VAR>annul-true-2</VAR> <VAR>annul-false-2</VAR>
               <small>...</small>])
</FONT></pre></td></tr></table></P><P>

<VAR>test</VAR> is an attribute test that indicates whether this
<CODE>define_delay</CODE> applies to a particular insn.  If so, the number of
required delay slots is determined by the length of the vector specified
as the second argument.  An insn placed in delay slot <VAR>n</VAR> must
satisfy attribute test <VAR>delay-n</VAR>.  <VAR>annul-true-n</VAR> is an
attribute test that specifies which insns may be annulled if the branch
is true.  Similarly, <VAR>annul-false-n</VAR> specifies which insns in the
delay slot may be annulled if the branch is false.  If annulling is not
supported for that delay slot, <CODE>(nil)</CODE> should be coded.</P><P>

For example, in the common case where branch and call insns require
a single delay slot, which may contain any insn other than a branch or
call, the following would be placed in the <TT>`md'</TT> file:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_delay (eq_attr "type" "branch,call")
              [(eq_attr "type" "!branch,call") (nil) (nil)])
</FONT></pre></td></tr></table></P><P>

Multiple <CODE>define_delay</CODE> expressions may be specified.  In this
case, each such expression specifies different delay slot requirements
and there must be no insn for which tests in two <CODE>define_delay</CODE>
expressions are both true.
</P><P>

For example, if we have a machine that requires one delay slot for branches
but two for calls,  no delay slot can contain a branch or call insn,
and any valid insn in the delay slot for the branch can be annulled if the
branch is true, we might represent this as follows:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_delay (eq_attr "type" "branch")
   [(eq_attr "type" "!branch,call")
    (eq_attr "type" "!branch,call")
    (nil)])

(define_delay (eq_attr "type" "call")
              [(eq_attr "type" "!branch,call") (nil) (nil)
               (eq_attr "type" "!branch,call") (nil) (nil)])
</FONT></pre></td></tr></table></P><P>

<A NAME="Function Units"></A>
<HR SIZE="6">
<A NAME="SEC198"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC197" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC197"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC171" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC171"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC190" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC190"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 16.15.8 Specifying Function Units </H3>
<!--docid::SEC198::-->
<P>

On most RISC machines, there are instructions whose results are not
available for a specific number of cycles.  Common cases are instructions
that load data from memory.  On many machines, a pipeline stall will result
if the data is referenced too soon after the load instruction.
</P><P>

In addition, many newer microprocessors have multiple function units, usually
one for integer and one for floating point, and often will incur pipeline
stalls when a result that is needed is not yet ready.
</P><P>

The descriptions in this section allow the specification of how much
time must elapse between the execution of an instruction and the time
when its result is used.  It also allows specification of when the
execution of an instruction will delay execution of similar instructions
due to function unit conflicts.
</P><P>

For the purposes of the specifications in this section, a machine is
divided into <EM>function units</EM>, each of which execute a specific
class of instructions in first-in-first-out order.  Function units that
accept one instruction each cycle and allow a result to be used in the
succeeding instruction (usually via forwarding) need not be specified.
Classic RISC microprocessors will normally have a single function unit,
which we can call <SAMP>`memory'</SAMP>.  The newer "superscalar" processors
will often have function units for floating point operations, usually at
least a floating point adder and multiplier.
</P><P>

<A NAME="IDX1129"></A>
Each usage of a function units by a class of insns is specified with a
<CODE>define_function_unit</CODE> expression, which looks like this:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_function_unit <VAR>name</VAR> <VAR>multiplicity</VAR> <VAR>simultaneity</VAR>
                      <VAR>test</VAR> <VAR>ready-delay</VAR> <VAR>issue-delay</VAR>
                     [<VAR>conflict-list</VAR>])
</FONT></pre></td></tr></table></P><P>

<VAR>name</VAR> is a string giving the name of the function unit.
</P><P>

<VAR>multiplicity</VAR> is an integer specifying the number of identical
units in the processor.  If more than one unit is specified, they will
be scheduled independently.  Only truly independent units should be
counted; a pipelined unit should be specified as a single unit.  (The
only common example of a machine that has multiple function units for a
single instruction class that are truly independent and not pipelined
are the two multiply and two increment units of the CDC 6600.)
</P><P>

<VAR>simultaneity</VAR> specifies the maximum number of insns that can be
executing in each instance of the function unit simultaneously or zero
if the unit is pipelined and has no limit.
</P><P>

All <CODE>define_function_unit</CODE> definitions referring to function unit
<VAR>name</VAR> must have the same name and values for <VAR>multiplicity</VAR> and
<VAR>simultaneity</VAR>.
</P><P>

<VAR>test</VAR> is an attribute test that selects the insns we are describing
in this definition.  Note that an insn may use more than one function
unit and a function unit may be specified in more than one
<CODE>define_function_unit</CODE>.
</P><P>

<VAR>ready-delay</VAR> is an integer that specifies the number of cycles
after which the result of the instruction can be used without
introducing any stalls.
</P><P>

<VAR>issue-delay</VAR> is an integer that specifies the number of cycles
after the instruction matching the <VAR>test</VAR> expression begins using
this unit until a subsequent instruction can begin.  A cost of <VAR>N</VAR>
indicates an <VAR>N-1</VAR> cycle delay.  A subsequent instruction may also
be delayed if an earlier instruction has a longer <VAR>ready-delay</VAR>
value.  This blocking effect is computed using the <VAR>simultaneity</VAR>,
<VAR>ready-delay</VAR>, <VAR>issue-delay</VAR>, and <VAR>conflict-list</VAR> terms.
For a normal non-pipelined function unit, <VAR>simultaneity</VAR> is one, the
unit is taken to block for the <VAR>ready-delay</VAR> cycles of the executing
insn, and smaller values of <VAR>issue-delay</VAR> are ignored.
</P><P>

<VAR>conflict-list</VAR> is an optional list giving detailed conflict costs
for this unit.  If specified, it is a list of condition test expressions
to be applied to insns chosen to execute in <VAR>name</VAR> following the
particular insn matching <VAR>test</VAR> that is already executing in
<VAR>name</VAR>.  For each insn in the list, <VAR>issue-delay</VAR> specifies the
conflict cost; for insns not in the list, the cost is zero.  If not
specified, <VAR>conflict-list</VAR> defaults to all instructions that use the
function unit.
</P><P>

Typical uses of this vector are where a floating point function unit can
pipeline either single- or double-precision operations, but not both, or
where a memory unit can pipeline loads, but not stores, etc.
</P><P>

As an example, consider a classic RISC machine where the result of a
load instruction is not available for two cycles (a single "delay"
instruction is required) and where only one load instruction can be executed
simultaneously.  This would be specified as:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_function_unit "memory" 1 1 (eq_attr "type" "load") 2 0)
</FONT></pre></td></tr></table></P><P>

For the case of a floating point function unit that can pipeline either
single or double precision, but not both, the following could be specified:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=smallexample><FONT SIZE=-1><pre>(define_function_unit
   "fp" 1 0 (eq_attr "type" "sp_fp") 4 4 [(eq_attr "type" "dp_fp")])
(define_function_unit
   "fp" 1 0 (eq_attr "type" "dp_fp") 4 4 [(eq_attr "type" "sp_fp")])
</FONT></pre></td></tr></table></P><P>

<STRONG>Note:</STRONG> The scheduler attempts to avoid function unit conflicts
and uses all the specifications in the <CODE>define_function_unit</CODE>
expression.  It has recently come to our attention that these
specifications may not allow modeling of some of the newer
"superscalar" processors that have insns using multiple pipelined
units.  These insns will cause a potential conflict for the second unit
used during their execution and there is no way of representing that
conflict.  We welcome any examples of how function unit conflicts work
in such processors and suggestions for their representation.
</P><P>

<A NAME="Target Macros"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_16.html#SEC171" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_16.html#SEC171"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_17.html#SEC199" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_17.html#SEC199"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc.html#SEC_Top" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_toc.html#SEC_Contents" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_24.html#SEC261" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_24.html#SEC261">Index</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="gcc_abt.html#SEC_About" tppabs="http://gcc.gnu.org/onlinedocs/gcc-2.95.3/gcc_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<BR>  
<FONT SIZE="-1">
This document was generated
by <I>GCC Administrator</I> on <I>March, 17  2001</I>
using <A HREF="tppmsgs/msgs0.htm#1" tppabs="http://www.mathematik.uni-kl.de/~obachman/Texi2html"><I>texi2html</I></A>

</BODY>
</HTML>
