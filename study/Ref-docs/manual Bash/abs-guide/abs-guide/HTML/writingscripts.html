<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML
><HEAD
><TITLE
>Writing Scripts</TITLE
><META
NAME="GENERATOR"
CONTENT="Modular DocBook HTML Stylesheet Version 1.64
"><LINK
REL="HOME"
TITLE="Advanced Bash-Scripting Guide"
HREF="index.html"><LINK
REL="UP"
TITLE="Exercises"
HREF="exercises.html"><LINK
REL="PREVIOUS"
TITLE="Exercises"
HREF="exercises.html"><LINK
REL="NEXT"
TITLE="Copyright"
HREF="copyright.html"><META
HTTP-EQUIV="Content-Style-Type"
CONTENT="text/css"><LINK
REL="stylesheet"
HREF="common/kde-common.css"
TYPE="text/css"><META
HTTP-EQUIV="Content-Type"
CONTENT="text/html; charset=iso-8859-1"><META
HTTP-EQUIV="Content-Language"
CONTENT="en"><LINK
REL="stylesheet"
HREF="common/kde-localised.css"
TYPE="text/css"
TITLE="KDE-English"><LINK
REL="stylesheet"
HREF="common/kde-default.css"
TYPE="text/css"
TITLE="KDE-Default"></HEAD
><BODY
CLASS="SECT1"
BGCOLOR="#FFFFFF"
TEXT="#000000"
LINK="#AA0000"
VLINK="#AA0055"
ALINK="#AA0000"
STYLE="font-family: sans-serif;"
><DIV
CLASS="NAVHEADER"
><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TH
COLSPAN="3"
ALIGN="center"
>Advanced Bash-Scripting Guide: An in-depth exploration of the art of shell scripting</TH
></TR
><TR
><TD
WIDTH="10%"
ALIGN="left"
VALIGN="bottom"
><A
HREF="exercises.html"
>Prev</A
></TD
><TD
WIDTH="80%"
ALIGN="center"
VALIGN="bottom"
>Appendix I. Exercises</TD
><TD
WIDTH="10%"
ALIGN="right"
VALIGN="bottom"
><A
HREF="copyright.html"
>Next</A
></TD
></TR
></TABLE
><HR
ALIGN="LEFT"
WIDTH="100%"></DIV
><DIV
CLASS="SECT1"
><H1
CLASS="SECT1"
><A
NAME="WRITINGSCRIPTS"
>I.2. Writing Scripts</A
></H1
><P
><A
NAME="WRITINGSCRIPTS1"
></A
></P
><P
>Write a script to carry out each of the following tasks.</P
><DIV
CLASS="VARIABLELIST"
><P
><B
><A
NAME="EXEASY1"
></A
>Easy</B
></P
><DL
><DT
><B
CLASS="COMMAND"
>Home Directory Listing</B
></DT
><DD
><P
>Perform a recursive directory listing on the user's home
	      directory and save the information to a file. Compress
	      the file, have the script prompt the user to insert
	      a floppy, then press <B
CLASS="KEYCAP"
>ENTER</B
>. Finally,
	      save the file to the floppy.</P
></DD
><DT
><B
CLASS="COMMAND"
>Converting  <A
HREF="loops.html#FORLOOPREF1"
>for</A
>
	    loops to <A
HREF="loops.html#WHILELOOPREF"
>while</A
> and <A
HREF="loops.html#UNTILLOOPREF"
>until</A
> loops</B
></DT
><DD
><P
>Convert the <I
CLASS="EMPHASIS"
>for loops</I
> in <A
HREF="loops.html#EX22"
>Example 10-1</A
> to <I
CLASS="EMPHASIS"
>while
	      loops</I
>. Hint: store the data in an <A
HREF="arrays.html#ARRAYREF"
>array</A
> and step through the array
	      elements.</P
><P
>Having already done the <SPAN
CLASS="QUOTE"
>"heavy lifting"</SPAN
>,
	      now convert the loops in the example to <I
CLASS="EMPHASIS"
> until
	      loops</I
>.</P
></DD
><DT
><B
CLASS="COMMAND"
>Changing the line spacing of a text file</B
></DT
><DD
><P
>Write a script that reads each line of a target file, then
	      writes the line back to <TT
CLASS="FILENAME"
>stdout</TT
>, but with
	      an extra blank line following. This has the effect of
	      <I
CLASS="EMPHASIS"
>double-spacing</I
> the file.</P
><P
>Include all necessary code to check whether the script
	      gets the necessary command line argument (a filename),
	      and whether the specified file exists.</P
><P
>When the script runs correctly, modify it to
	      <I
CLASS="EMPHASIS"
>triple-space</I
> the target file.</P
><P
>Finally, write a script to remove all blank lines from
	      the target file, <I
CLASS="EMPHASIS"
>single-spacing</I
> it.</P
></DD
><DT
><B
CLASS="COMMAND"
>Backwards Listing</B
></DT
><DD
><P
>Write a script that echoes itself to
	      <TT
CLASS="FILENAME"
>stdout</TT
>, but
	      <I
CLASS="EMPHASIS"
>backwards</I
>.</P
></DD
><DT
><B
CLASS="COMMAND"
>Primes</B
></DT
><DD
><P
>Print (to stdout) all prime numbers between 60000 and
	      63000. The output should be nicely formatted in columns
	      (hint: use <A
HREF="internal.html#PRINTFREF"
>printf</A
>).</P
></DD
><DT
><B
CLASS="COMMAND"
>Unique System ID</B
></DT
><DD
><P
>Generate a <SPAN
CLASS="QUOTE"
>"unique"</SPAN
> 6-digit hexadecimal
	      identifier for your computer. Do <I
CLASS="EMPHASIS"
>not</I
>
	      use the flawed <A
HREF="system.html#HOSTIDREF"
>hostid</A
>
	      command. Hint: <B
CLASS="COMMAND"
><A
HREF="filearchiv.html#MD5SUMREF"
>md5sum</A
>
	      <TT
CLASS="FILENAME"
>/etc/passwd</TT
></B
>, then select
	      the first 6 digits of output.</P
></DD
><DT
><B
CLASS="COMMAND"
>Backup</B
></DT
><DD
><P
>Archive as a <SPAN
CLASS="QUOTE"
>"tarball"</SPAN
>
	      (<TT
CLASS="FILENAME"
>*.tar.gz</TT
> file) all the files
	      in your home directory tree
	      (<TT
CLASS="FILENAME"
>/home/your-name</TT
>) that have
	      been modified in the last 24 hours. Hint: use <A
HREF="moreadv.html#FINDREF"
>find</A
>.</P
></DD
><DT
><B
CLASS="COMMAND"
>Safe Delete</B
></DT
><DD
><P
>Write, as a script, a <SPAN
CLASS="QUOTE"
>"safe"</SPAN
> delete
	      command, <TT
CLASS="FILENAME"
>srm.sh</TT
>. Filenames
	      passed as command-line arguments to this
	      script are not deleted, but instead <A
HREF="filearchiv.html#GZIPREF"
>gzipped</A
> and moved to a <TT
CLASS="FILENAME"
>/home/username/trash</TT
>
	      directory. At invocation, the script checks the
	      <SPAN
CLASS="QUOTE"
>"trash"</SPAN
> directory for files older than 48
	      hours and deletes them.</P
></DD
></DL
></DIV
><DIV
CLASS="VARIABLELIST"
><P
><B
><A
NAME="EXMEDIUM1"
></A
>Medium</B
></P
><DL
><DT
><B
CLASS="COMMAND"
>Managing Disk Space</B
></DT
><DD
><P
>List, one at a time, all files larger than 100K in
	      the <TT
CLASS="FILENAME"
>/home/username</TT
>
	      directory tree. Give the user the option to delete or
	      compress the file, then proceed to show the next one. Write
	      to a logfile the names of all deleted files and the
	      deletion times.</P
></DD
><DT
><B
CLASS="COMMAND"
>Making Change</B
></DT
><DD
><P
>What is the most efficient way to make change for $1.68,
	      using only coins in common circulations (up to 25c)? It's
	      6 quarters, 1 dime, a nickel, and three cents.</P
><P
>Given any arbitrary command line input in dollars and
	      cents ($*.??), calculate the change, using the minimum
	      number of coins. If your home country is not the United
	      States, you may use your local currency units instead. The
	      script will need to parse the command line input, then
	      change it to multiples of the smallest monetary unit (cents
	      or whatever). Hint: look at <A
HREF="functions.html#EX61"
>Example 23-4</A
>.</P
></DD
><DT
><B
CLASS="COMMAND"
>Quadratic Equations</B
></DT
><DD
><P
>Solve a <SPAN
CLASS="QUOTE"
>"quadratic"</SPAN
> equation of the form
	      <I
CLASS="EMPHASIS"
>Ax^2 + Bx + C = 0</I
>. Have a script take
	      as arguments the coefficients, <TT
CLASS="USERINPUT"
><B
>A</B
></TT
>,
	      <TT
CLASS="USERINPUT"
><B
>B</B
></TT
>, and <TT
CLASS="USERINPUT"
><B
>C</B
></TT
>,
	      and return the solutions to four decimal places.</P
><P
>Hint: pipe the coefficients to <A
HREF="mathc.html#BCREF"
>bc</A
>, using the well-known formula,
	      <I
CLASS="EMPHASIS"
>x = ( -B +/- sqrt( B^2 - 4AC ) ) / 2A</I
>.</P
></DD
><DT
><B
CLASS="COMMAND"
>Lucky Numbers</B
></DT
><DD
><P
>A "lucky number" is one whose individual digits add
	      up to 7, in successive additions. For example, 62431 is a
	      "lucky number" (6 + 2 + 4 + 3 + 1 = 16, 1 + 6 = 7). Find
	      all the "lucky numbers" between 1000 and 10000.</P
></DD
><DT
><B
CLASS="COMMAND"
>Alphabetizing a String</B
></DT
><DD
><P
>Alphabetize (in ASCII order) an arbitrary string
	      read from the command line.</P
></DD
><DT
><B
CLASS="COMMAND"
>Parsing</B
></DT
><DD
><P
>Parse <TT
CLASS="FILENAME"
>/etc/passwd</TT
>, and output
	      its contents in nice, easy-to-read tabular form.</P
></DD
><DT
><B
CLASS="COMMAND"
>Pretty-Printing a Data File</B
></DT
><DD
><P
>Certain database and spreadsheet packages use save-files
	      with <I
CLASS="EMPHASIS"
>comma-separated values</I
>
	      (CSVs). Other applications often need to parse these
	      files.</P
><P
>Given a data file with comma-separated fields,
	      of the form:
	        <TABLE
BORDER="0"
BGCOLOR="#E0E0E0"
WIDTH="90%"
><TR
><TD
><PRE
CLASS="PROGRAMLISTING"
>   1&nbsp;Jones,Bill,235 S. Williams St.,Denver,CO,80221,(303) 244-7989
   2&nbsp;Smith,Tom,404 Polk Ave.,Los Angeles,CA,90003,(213) 879-5612
   3&nbsp;...</PRE
></TD
></TR
></TABLE
>
	      Reformat the data and print it out to
	      <TT
CLASS="FILENAME"
>stdout</TT
> in labeled, evenly-spaced columns.</P
></DD
></DL
></DIV
><DIV
CLASS="VARIABLELIST"
><P
><B
><A
NAME="EXDIFFICULT1"
></A
>Difficult</B
></P
><DL
><DT
><B
CLASS="COMMAND"
>Logging File Accesses</B
></DT
><DD
><P
>Log all accesses to the files in <TT
CLASS="FILENAME"
>/etc</TT
> during the course of
	      a single day. This information should include the filename,
	      user name, and access time. If any alterations to the
	      files take place, that should be flagged. Write this data
	      as neatly formatted records in a logfile.</P
></DD
><DT
><B
CLASS="COMMAND"
>Strip Comments</B
></DT
><DD
><P
>Strip all comments from a shell script whose name
	      is specified on the command line. Note that the <SPAN
CLASS="QUOTE"
>"#!
	      line"</SPAN
> must not be stripped out.</P
></DD
><DT
><B
CLASS="COMMAND"
>HTML Conversion</B
></DT
><DD
><P
>Convert a given text file to HTML. This non-interactive
	      script automatically inserts all appropriate HTML tags into
	      a file specified as an argument.</P
></DD
><DT
><B
CLASS="COMMAND"
>Strip HTML Tags</B
></DT
><DD
><P
>Strip all HTML tags from a specified HTML file, then
	      reformat it into lines between 60 and 75 characters
	      in length.  Reset paragraph and block spacing, as
	      appropriate, and convert HTML tables to their approximate
	      text equivalent.</P
></DD
><DT
><B
CLASS="COMMAND"
>Hex Dump</B
></DT
><DD
><P
>Do a hex(adecimal) dump on a binary file
	      specified as an argument. The output should be in neat
	      tabular fields, with the first field showing the address,
	      each of the next 8 fields a 4-byte hex number, and the final
	      field the ASCII equivalent of the previous 8 fields.</P
></DD
><DT
><B
CLASS="COMMAND"
>Emulating a Shift Register</B
></DT
><DD
><P
>Using <A
HREF="arrays.html#STACKEX"
>Example 26-6</A
> as an inspiration,
	      write a script that emulates a 64-bit shift register as
	      an <A
HREF="arrays.html#ARRAYREF"
>array</A
>.  Implement
	      functions to <I
CLASS="EMPHASIS"
>load</I
> the register,
	      <I
CLASS="EMPHASIS"
>shift left</I
>, and <I
CLASS="EMPHASIS"
>shift
	      right</I
>. Finally, write a function that
	      interprets the register contents as eight 8-bit ASCII
	      characters.</P
></DD
><DT
><B
CLASS="COMMAND"
>Determinant</B
></DT
><DD
><P
>Solve a 4 x 4 determinant.</P
></DD
><DT
><B
CLASS="COMMAND"
>Hidden Words</B
></DT
><DD
><P
>Write a <SPAN
CLASS="QUOTE"
>"word-find"</SPAN
> puzzle generator,
	      a script that hides 10 input words in a 10 x 10 matrix
	      of random letters. The words may be hidden across, down,
	      or diagonally.</P
></DD
><DT
><B
CLASS="COMMAND"
>Anagramming</B
></DT
><DD
><P
> Anagram 4-letter input. For example, the
	      anagrams of <I
CLASS="EMPHASIS"
>word</I
> are:
	      <I
CLASS="EMPHASIS"
>do or rod row word</I
>. You may use
	      <TT
CLASS="FILENAME"
>/usr/share/dict/linux.words</TT
> as the
	      reference list.</P
></DD
></DL
></DIV
><P
>Please do not send the author your solutions to these
            exercises. There are better ways to impress him with your
            cleverness, such as submitting bugfixes and suggestions for
            improving this book.</P
></DIV
><DIV
CLASS="NAVFOOTER"
><HR
ALIGN="LEFT"
WIDTH="100%"><TABLE
WIDTH="100%"
BORDER="0"
CELLPADDING="0"
CELLSPACING="0"
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
><A
HREF="exercises.html"
>Prev</A
></TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="index.html"
>Home</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
><A
HREF="copyright.html"
>Next</A
></TD
></TR
><TR
><TD
WIDTH="33%"
ALIGN="left"
VALIGN="top"
>Exercises</TD
><TD
WIDTH="34%"
ALIGN="center"
VALIGN="top"
><A
HREF="exercises.html"
>Up</A
></TD
><TD
WIDTH="33%"
ALIGN="right"
VALIGN="top"
>Copyright</TD
></TR
></TABLE
></DIV
></BODY
></HTML
>